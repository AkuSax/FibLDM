nohup: ignoring input
/home/akul/miniconda3/envs/fibldm/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/akul/miniconda3/envs/fibldm/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=AlexNet_Weights.IMAGENET1K_V1`. You can also use `weights=AlexNet_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Loaded latent stats: Mean=-0.0121, Std=1.0261
Debug statistics will be saved to: ../model_runs/sd_run_3/debug_stats.log
--- Using SUBSET HDF5 dataset: /hot/Yi-Kuan/Fibrosis/Akul/sd_data/latents_dataset_subset.h5 ---
Training on 901 latent samples, validating on 101 samples.
Using Stable Diffusion VAE from diffusers for sampling...
VAE loaded.
Setting up [LPIPS] perceptual loss: trunk [alex], v[0.1], spatial [off]
Loading model from: /home/akul/miniconda3/envs/fibldm/lib/python3.9/site-packages/lpips/weights/v0.1/alex.pth
Epoch 1/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]W0728 01:15:29.004316 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d1 is not in var_ranges, defaulting to unknown range.
W0728 01:15:29.004598 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:29.004707 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:29.007622 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:29.007754 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:29.724159 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d1 is not in var_ranges, defaulting to unknown range.
W0728 01:15:29.724382 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:29.724480 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:29.727351 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:29.727503 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:30.183634 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d1 is not in var_ranges, defaulting to unknown range.
W0728 01:15:30.183874 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:30.183994 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:30.186834 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:30.186966 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] d0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:31.120194 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:31.120419 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:31.120514 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q1 is not in var_ranges, defaulting to unknown range.
W0728 01:15:31.126247 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:31.126392 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:31.259611 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] z2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:31.259821 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] z1 is not in var_ranges, defaulting to unknown range.
W0728 01:15:31.259917 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] z0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:32.195853 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:32.196101 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:32.196197 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q1 is not in var_ranges, defaulting to unknown range.
W0728 01:15:32.200093 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:32.200250 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:32.318413 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] z2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:32.318614 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] z1 is not in var_ranges, defaulting to unknown range.
W0728 01:15:32.318699 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] z0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:32.948425 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:32.948662 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:32.948793 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q1 is not in var_ranges, defaulting to unknown range.
W0728 01:15:32.952762 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:32.952906 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] q0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:33.081051 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] z2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:33.081260 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] z1 is not in var_ranges, defaulting to unknown range.
W0728 01:15:33.081347 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] z0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:34.445578 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] x1 is not in var_ranges, defaulting to unknown range.
W0728 01:15:34.445784 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] x0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:34.445872 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] r2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:35.591295 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] x1 is not in var_ranges, defaulting to unknown range.
W0728 01:15:35.591555 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] x0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:35.591662 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] r2 is not in var_ranges, defaulting to unknown range.
W0728 01:15:36.133719 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] x1 is not in var_ranges, defaulting to unknown range.
W0728 01:15:36.133935 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] x0 is not in var_ranges, defaulting to unknown range.
W0728 01:15:36.134027 139937340974848 torch/fx/experimental/symbolic_shapes.py:4449] [0/0] r2 is not in var_ranges, defaulting to unknown range.
Epoch 1/1000 [TRAIN]:   0%|          | 0/10 [00:37<?, ?it/s, loss=1.0161, mse=1.0145, lpips=0.0033]Epoch 1/1000 [TRAIN]:  10%|█         | 1/10 [00:37<05:33, 37.11s/it, loss=1.0161, mse=1.0145, lpips=0.0033]Epoch 1/1000 [TRAIN]:  10%|█         | 1/10 [00:37<05:33, 37.11s/it, loss=1.0169, mse=1.0153, lpips=0.0033]Epoch 1/1000 [TRAIN]:  10%|█         | 1/10 [00:37<05:33, 37.11s/it, loss=1.0190, mse=1.0174, lpips=0.0033]Epoch 1/1000 [TRAIN]:  30%|███       | 3/10 [00:37<01:07,  9.68s/it, loss=1.0190, mse=1.0174, lpips=0.0033]Epoch 1/1000 [TRAIN]:  30%|███       | 3/10 [00:37<01:07,  9.68s/it, loss=1.0111, mse=1.0095, lpips=0.0033]Epoch 1/1000 [TRAIN]:  30%|███       | 3/10 [00:37<01:07,  9.68s/it, loss=1.0107, mse=1.0091, lpips=0.0033]Epoch 1/1000 [TRAIN]:  50%|█████     | 5/10 [00:37<00:23,  4.75s/it, loss=1.0107, mse=1.0091, lpips=0.0033]Epoch 1/1000 [TRAIN]:  50%|█████     | 5/10 [00:37<00:23,  4.75s/it, loss=1.0109, mse=1.0092, lpips=0.0033]Epoch 1/1000 [TRAIN]:  50%|█████     | 5/10 [00:37<00:23,  4.75s/it, loss=1.0097, mse=1.0081, lpips=0.0033]Epoch 1/1000 [TRAIN]:  70%|███████   | 7/10 [00:37<00:08,  2.77s/it, loss=1.0097, mse=1.0081, lpips=0.0033]Epoch 1/1000 [TRAIN]:  70%|███████   | 7/10 [00:37<00:08,  2.77s/it, loss=1.0070, mse=1.0054, lpips=0.0032]Epoch 1/1000 [TRAIN]:  70%|███████   | 7/10 [00:37<00:08,  2.77s/it, loss=1.0086, mse=1.0069, lpips=0.0033]Epoch 1/1000 [TRAIN]:  90%|█████████ | 9/10 [00:37<00:01,  1.76s/it, loss=1.0086, mse=1.0069, lpips=0.0033]Epoch 1/1000 [TRAIN]:  90%|█████████ | 9/10 [00:50<00:01,  1.76s/it, loss=1.0086, mse=1.0069, lpips=0.0033]W0728 01:16:02.152310 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:02.152688 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:02.152802 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:02.160529 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:02.160718 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:02.987470 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:02.987702 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:02.987826 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:02.996188 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:02.996350 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:03.504610 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:03.504836 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:03.504951 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:03.511288 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:03.511439 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] d0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:04.925349 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:04.925577 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:04.925705 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:04.943591 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:04.943747 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:04.943852 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:05.222147 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:05.222349 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:05.222449 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:05.239431 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:05.239644 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:05.239742 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:07.091550 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:07.091751 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:07.091836 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:07.110243 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:07.110444 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:07.110533 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:07.397868 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:07.398065 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:07.398155 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:07.414734 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:07.414905 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:07.414984 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:08.280256 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:08.280499 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:08.280603 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:08.301831 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:08.302028 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:08.302140 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] q1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:08.576890 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:08.577109 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:08.577210 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:08.593357 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:08.593544 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:08.593622 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] z0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:10.319269 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] x1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:10.319480 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] x0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:10.319567 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] r2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:10.339079 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] x1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:10.339285 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] x0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:10.339375 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] r2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:11.680553 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] x1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:11.680785 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] x0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:11.680895 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] r2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:11.702197 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] x1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:11.702379 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] x0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:11.702481 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] r2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:12.859849 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] x1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:12.860099 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] x0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:12.860198 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] r2 is not in var_ranges, defaulting to unknown range.
W0728 01:16:12.878340 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] x1 is not in var_ranges, defaulting to unknown range.
W0728 01:16:12.878524 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] x0 is not in var_ranges, defaulting to unknown range.
W0728 01:16:12.878607 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [0/1] r2 is not in var_ranges, defaulting to unknown range.
Epoch 1/1000 [TRAIN]:  90%|█████████ | 9/10 [01:24<00:01,  1.76s/it, loss=1.0050, mse=1.0034, lpips=0.0033]Epoch 1/1000 [TRAIN]: 100%|██████████| 10/10 [01:24<00:00, 11.34s/it, loss=1.0050, mse=1.0034, lpips=0.0033]Epoch 1/1000 [TRAIN]: 100%|██████████| 10/10 [01:24<00:00,  8.47s/it, loss=1.0050, mse=1.0034, lpips=0.0033]
Epoch 1/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]/home/akul/miniconda3/envs/fibldm/lib/python3.9/site-packages/torch/_inductor/compile_fx.py:150: UserWarning: TensorFloat32 tensor cores for float32 matrix multiplication available but not enabled. Consider setting `torch.set_float32_matmul_precision('high')` for better performance.
  warnings.warn(
W0728 01:16:39.434993 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [3/0] xindex is not in var_ranges, defaulting to unknown range.
W0728 01:16:39.912976 139943385617024 torch/fx/experimental/symbolic_shapes.py:4449] [3/0] xindex is not in var_ranges, defaulting to unknown range.
Epoch 1/1000 [VAL]:   0%|          | 0/2 [00:13<?, ?it/s, loss=1.0083]Epoch 1/1000 [VAL]:   0%|          | 0/2 [00:23<?, ?it/s, loss=1.0167]Epoch 1 | Avg Train Loss: 1.0115 | Avg Val Loss: 1.0125
New best validation loss: 1.0125. Saving best model...

Epoch 2/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 2/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=1.0057, mse=1.0041, lpips=0.0033][A
Epoch 2/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:22,  9.11s/it, loss=1.0057, mse=1.0041, lpips=0.0033][A
Epoch 2/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:22,  9.11s/it, loss=1.0027, mse=1.0011, lpips=0.0032][A
Epoch 2/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.98s/it, loss=1.0027, mse=1.0011, lpips=0.0032][A
Epoch 2/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.98s/it, loss=1.0049, mse=1.0033, lpips=0.0033][A
Epoch 2/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.98s/it, loss=1.0080, mse=1.0063, lpips=0.0033][A
Epoch 2/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.54s/it, loss=1.0080, mse=1.0063, lpips=0.0033][A
Epoch 2/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.54s/it, loss=1.0088, mse=1.0071, lpips=0.0033][A
Epoch 2/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.54s/it, loss=1.0014, mse=0.9998, lpips=0.0033][A
Epoch 2/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.17it/s, loss=1.0014, mse=0.9998, lpips=0.0033][A
Epoch 2/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.17it/s, loss=1.0027, mse=1.0011, lpips=0.0033][A
Epoch 2/1000 [TRAIN]:  60%|██████    | 6/10 [00:10<00:03,  1.17it/s, loss=1.0008, mse=0.9991, lpips=0.0033][A
Epoch 2/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:01,  1.83it/s, loss=1.0008, mse=0.9991, lpips=0.0033][A
Epoch 2/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:01,  1.83it/s, loss=1.0024, mse=1.0008, lpips=0.0033][A
Epoch 2/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:01,  1.83it/s, loss=1.0037, mse=1.0021, lpips=0.0033][A
Epoch 2/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  2.67it/s, loss=1.0037, mse=1.0021, lpips=0.0033][AEpoch 2/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.02s/it, loss=1.0037, mse=1.0021, lpips=0.0033]

Epoch 2/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 1/1000 [VAL]:   0%|          | 0/2 [00:34<?, ?it/s, loss=1.0167]

Epoch 2/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.9976][A
Epoch 2/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.9880][AEpoch 2 | Avg Train Loss: 1.0041 | Avg Val Loss: 0.9928
New best validation loss: 0.9928. Saving best model...
Epoch 3/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 3/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=1.0002, mse=0.9986, lpips=0.0033]Epoch 3/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.18s/it, loss=1.0002, mse=0.9986, lpips=0.0033]Epoch 3/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.18s/it, loss=0.9980, mse=0.9964, lpips=0.0032]Epoch 3/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.84it/s, loss=0.9980, mse=0.9964, lpips=0.0032]Epoch 3/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.84it/s, loss=0.9956, mse=0.9940, lpips=0.0032]Epoch 3/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.84it/s, loss=0.9998, mse=0.9982, lpips=0.0032]Epoch 3/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.87it/s, loss=0.9998, mse=0.9982, lpips=0.0032]Epoch 3/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.87it/s, loss=0.9991, mse=0.9975, lpips=0.0033]Epoch 3/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.87it/s, loss=0.9910, mse=0.9894, lpips=0.0032]Epoch 3/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.02it/s, loss=0.9910, mse=0.9894, lpips=0.0032]Epoch 3/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.02it/s, loss=0.9967, mse=0.9951, lpips=0.0032]Epoch 3/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.02it/s, loss=0.9949, mse=0.9933, lpips=0.0032]Epoch 3/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.45it/s, loss=0.9949, mse=0.9933, lpips=0.0032]Epoch 3/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.45it/s, loss=0.9947, mse=0.9930, lpips=0.0033]Epoch 3/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  6.45it/s, loss=0.9941, mse=0.9925, lpips=0.0032]Epoch 3/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  8.12it/s, loss=0.9941, mse=0.9925, lpips=0.0032]Epoch 3/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.91it/s, loss=0.9941, mse=0.9925, lpips=0.0032]
Epoch 3/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 2/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.9880]
Epoch 3/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.9947]Epoch 3/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=1.0037]Epoch 3 | Avg Train Loss: 0.9964 | Avg Val Loss: 0.9992

Epoch 4/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 4/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.9911, mse=0.9895, lpips=0.0032][A
Epoch 4/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.07s/it, loss=0.9911, mse=0.9895, lpips=0.0032][A
Epoch 4/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.07s/it, loss=0.9928, mse=0.9911, lpips=0.0033][A
Epoch 4/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.90it/s, loss=0.9928, mse=0.9911, lpips=0.0033][A
Epoch 4/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.90it/s, loss=0.9900, mse=0.9883, lpips=0.0032][A
Epoch 4/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.71it/s, loss=0.9900, mse=0.9883, lpips=0.0032][A
Epoch 4/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.71it/s, loss=0.9915, mse=0.9899, lpips=0.0032][A
Epoch 4/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.45it/s, loss=0.9915, mse=0.9899, lpips=0.0032][A
Epoch 4/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.45it/s, loss=0.9960, mse=0.9944, lpips=0.0032][A
Epoch 4/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.26it/s, loss=0.9960, mse=0.9944, lpips=0.0032][A
Epoch 4/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.26it/s, loss=0.9913, mse=0.9897, lpips=0.0032][A
Epoch 4/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.77it/s, loss=0.9913, mse=0.9897, lpips=0.0032][A
Epoch 4/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.77it/s, loss=0.9893, mse=0.9877, lpips=0.0032][A
Epoch 4/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.11it/s, loss=0.9893, mse=0.9877, lpips=0.0032][A
Epoch 4/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.11it/s, loss=0.9945, mse=0.9929, lpips=0.0033][A
Epoch 4/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.34it/s, loss=0.9945, mse=0.9929, lpips=0.0033][A
Epoch 4/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.34it/s, loss=0.9884, mse=0.9868, lpips=0.0032][A
Epoch 4/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.44it/s, loss=0.9884, mse=0.9868, lpips=0.0032][A
Epoch 4/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.44it/s, loss=0.9823, mse=0.9806, lpips=0.0032][A
Epoch 4/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.03it/s, loss=0.9823, mse=0.9806, lpips=0.0032][AEpoch 4/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  3.99it/s, loss=0.9823, mse=0.9806, lpips=0.0032]

Epoch 4/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 3/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=1.0037]

Epoch 4/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9849][A
Epoch 4/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9766][AEpoch 4 | Avg Train Loss: 0.9907 | Avg Val Loss: 0.9808
New best validation loss: 0.9808. Saving best model...
Epoch 5/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 5/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.9874, mse=0.9858, lpips=0.0032]Epoch 5/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.22s/it, loss=0.9874, mse=0.9858, lpips=0.0032]Epoch 5/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.22s/it, loss=0.9903, mse=0.9887, lpips=0.0032]Epoch 5/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.08s/it, loss=0.9903, mse=0.9887, lpips=0.0032]Epoch 5/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.08s/it, loss=0.9848, mse=0.9832, lpips=0.0032]Epoch 5/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.74s/it, loss=0.9848, mse=0.9832, lpips=0.0032]Epoch 5/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.74s/it, loss=0.9881, mse=0.9865, lpips=0.0032]Epoch 5/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.12s/it, loss=0.9881, mse=0.9865, lpips=0.0032]Epoch 5/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.12s/it, loss=0.9858, mse=0.9842, lpips=0.0032]Epoch 5/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.27it/s, loss=0.9858, mse=0.9842, lpips=0.0032]Epoch 5/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.27it/s, loss=0.9873, mse=0.9857, lpips=0.0032]Epoch 5/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.75it/s, loss=0.9873, mse=0.9857, lpips=0.0032]Epoch 5/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.75it/s, loss=0.9867, mse=0.9851, lpips=0.0032]Epoch 5/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.29it/s, loss=0.9867, mse=0.9851, lpips=0.0032]Epoch 5/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.29it/s, loss=0.9880, mse=0.9863, lpips=0.0032]Epoch 5/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.91it/s, loss=0.9880, mse=0.9863, lpips=0.0032]Epoch 5/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.91it/s, loss=0.9813, mse=0.9797, lpips=0.0032]Epoch 5/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.35it/s, loss=0.9813, mse=0.9797, lpips=0.0032]Epoch 5/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.35it/s, loss=0.9762, mse=0.9746, lpips=0.0032]Epoch 5/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.15it/s, loss=0.9762, mse=0.9746, lpips=0.0032]
Epoch 5/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 4/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.9766]
Epoch 5/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9775]Epoch 5/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9776]Epoch 5 | Avg Train Loss: 0.9856 | Avg Val Loss: 0.9776
New best validation loss: 0.9776. Saving best model...
Saving interval checkpoint for epoch 5...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -236.3784, Max: 199.3587
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_5.png

Epoch 6/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 6/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.9801, mse=0.9785, lpips=0.0032][A
Epoch 6/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:21,  9.08s/it, loss=0.9801, mse=0.9785, lpips=0.0032][A
Epoch 6/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:21,  9.08s/it, loss=0.9828, mse=0.9812, lpips=0.0032][A
Epoch 6/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.95s/it, loss=0.9828, mse=0.9812, lpips=0.0032][A
Epoch 6/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.95s/it, loss=0.9819, mse=0.9802, lpips=0.0032][A
Epoch 6/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.95s/it, loss=0.9813, mse=0.9797, lpips=0.0032][A
Epoch 6/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.53s/it, loss=0.9813, mse=0.9797, lpips=0.0032][A
Epoch 6/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.53s/it, loss=0.9795, mse=0.9779, lpips=0.0032][A
Epoch 6/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.53s/it, loss=0.9804, mse=0.9788, lpips=0.0032][A
Epoch 6/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.18it/s, loss=0.9804, mse=0.9788, lpips=0.0032][A
Epoch 6/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.18it/s, loss=0.9752, mse=0.9736, lpips=0.0032][A
Epoch 6/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.18it/s, loss=0.9798, mse=0.9782, lpips=0.0032][A
Epoch 6/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.84it/s, loss=0.9798, mse=0.9782, lpips=0.0032][A
Epoch 6/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:01,  1.84it/s, loss=0.9794, mse=0.9778, lpips=0.0032][A
Epoch 6/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:01,  1.84it/s, loss=0.9785, mse=0.9769, lpips=0.0032][A
Epoch 6/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  2.70it/s, loss=0.9785, mse=0.9769, lpips=0.0032][AEpoch 6/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.01s/it, loss=0.9785, mse=0.9769, lpips=0.0032]

Epoch 6/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 5/1000 [VAL]:   0%|          | 0/2 [00:17<?, ?it/s, loss=0.9776]

Epoch 6/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.9734][A
Epoch 6/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.9754][AEpoch 6 | Avg Train Loss: 0.9799 | Avg Val Loss: 0.9744
New best validation loss: 0.9744. Saving best model...
Epoch 7/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 7/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.9731, mse=0.9715, lpips=0.0032]Epoch 7/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.03s/it, loss=0.9731, mse=0.9715, lpips=0.0032]Epoch 7/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.03s/it, loss=0.9760, mse=0.9744, lpips=0.0032]Epoch 7/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.03s/it, loss=0.9798, mse=0.9782, lpips=0.0032]Epoch 7/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.01it/s, loss=0.9798, mse=0.9782, lpips=0.0032]Epoch 7/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.01it/s, loss=0.9716, mse=0.9700, lpips=0.0032]Epoch 7/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.01it/s, loss=0.9703, mse=0.9687, lpips=0.0032]Epoch 7/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.80it/s, loss=0.9703, mse=0.9687, lpips=0.0032]Epoch 7/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.80it/s, loss=0.9742, mse=0.9726, lpips=0.0032]Epoch 7/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.80it/s, loss=0.9733, mse=0.9717, lpips=0.0032]Epoch 7/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.41it/s, loss=0.9733, mse=0.9717, lpips=0.0032]Epoch 7/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.41it/s, loss=0.9742, mse=0.9726, lpips=0.0032]Epoch 7/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.41it/s, loss=0.9703, mse=0.9687, lpips=0.0032]Epoch 7/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.67it/s, loss=0.9703, mse=0.9687, lpips=0.0032]Epoch 7/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.67it/s, loss=0.9719, mse=0.9703, lpips=0.0032]Epoch 7/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.57it/s, loss=0.9719, mse=0.9703, lpips=0.0032]
Epoch 7/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 6/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.9754]
Epoch 7/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.9687]Epoch 7/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.9693]Epoch 7 | Avg Train Loss: 0.9735 | Avg Val Loss: 0.9690
New best validation loss: 0.9690. Saving best model...

Epoch 8/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 8/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.9743, mse=0.9727, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.00s/it, loss=0.9743, mse=0.9727, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.00s/it, loss=0.9680, mse=0.9664, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.00s/it, loss=0.9758, mse=0.9742, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.96it/s, loss=0.9758, mse=0.9742, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.96it/s, loss=0.9692, mse=0.9676, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.52it/s, loss=0.9692, mse=0.9676, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.52it/s, loss=0.9707, mse=0.9691, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.26it/s, loss=0.9707, mse=0.9691, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.26it/s, loss=0.9709, mse=0.9693, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.90it/s, loss=0.9709, mse=0.9693, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.90it/s, loss=0.9695, mse=0.9679, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.23it/s, loss=0.9695, mse=0.9679, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.23it/s, loss=0.9701, mse=0.9685, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.30it/s, loss=0.9701, mse=0.9685, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.30it/s, loss=0.9645, mse=0.9629, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.53it/s, loss=0.9645, mse=0.9629, lpips=0.0032][A
Epoch 8/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.53it/s, loss=0.9656, mse=0.9640, lpips=0.0032][A
Epoch 8/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.29it/s, loss=0.9656, mse=0.9640, lpips=0.0032][AEpoch 8/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.37it/s, loss=0.9656, mse=0.9640, lpips=0.0032]

Epoch 8/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 7/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.9693]

Epoch 8/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9692][A
Epoch 8/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9710][AEpoch 8 | Avg Train Loss: 0.9699 | Avg Val Loss: 0.9701
Epoch 9/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 9/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.9637, mse=0.9621, lpips=0.0032]Epoch 9/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.68s/it, loss=0.9637, mse=0.9621, lpips=0.0032]Epoch 9/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.68s/it, loss=0.9666, mse=0.9650, lpips=0.0032]Epoch 9/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:26,  3.27s/it, loss=0.9666, mse=0.9650, lpips=0.0032]Epoch 9/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:26,  3.27s/it, loss=0.9657, mse=0.9641, lpips=0.0032]Epoch 9/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.84s/it, loss=0.9657, mse=0.9641, lpips=0.0032]Epoch 9/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.84s/it, loss=0.9654, mse=0.9638, lpips=0.0032]Epoch 9/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.18s/it, loss=0.9654, mse=0.9638, lpips=0.0032]Epoch 9/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.18s/it, loss=0.9635, mse=0.9619, lpips=0.0032]Epoch 9/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.23it/s, loss=0.9635, mse=0.9619, lpips=0.0032]Epoch 9/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.23it/s, loss=0.9675, mse=0.9659, lpips=0.0032]Epoch 9/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.67it/s, loss=0.9675, mse=0.9659, lpips=0.0032]Epoch 9/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.67it/s, loss=0.9535, mse=0.9519, lpips=0.0032]Epoch 9/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.19it/s, loss=0.9535, mse=0.9519, lpips=0.0032]Epoch 9/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.19it/s, loss=0.9614, mse=0.9598, lpips=0.0032]Epoch 9/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.83it/s, loss=0.9614, mse=0.9598, lpips=0.0032]Epoch 9/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.83it/s, loss=0.9592, mse=0.9577, lpips=0.0032]Epoch 9/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.42it/s, loss=0.9592, mse=0.9577, lpips=0.0032]Epoch 9/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  3.42it/s, loss=0.9607, mse=0.9591, lpips=0.0032]Epoch 9/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  4.16it/s, loss=0.9607, mse=0.9591, lpips=0.0032]Epoch 9/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.10it/s, loss=0.9607, mse=0.9591, lpips=0.0032]
Epoch 9/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 8/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.9710]
Epoch 9/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9530]Epoch 9/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9759]Epoch 9 | Avg Train Loss: 0.9627 | Avg Val Loss: 0.9645
New best validation loss: 0.9645. Saving best model...

Epoch 10/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 10/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.9611, mse=0.9595, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.67s/it, loss=0.9611, mse=0.9595, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.67s/it, loss=0.9642, mse=0.9626, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.25s/it, loss=0.9642, mse=0.9626, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.25s/it, loss=0.9570, mse=0.9554, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.84s/it, loss=0.9570, mse=0.9554, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.84s/it, loss=0.9594, mse=0.9579, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.17s/it, loss=0.9594, mse=0.9579, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.17s/it, loss=0.9581, mse=0.9565, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.9581, mse=0.9565, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.9586, mse=0.9570, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.70it/s, loss=0.9586, mse=0.9570, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.70it/s, loss=0.9539, mse=0.9523, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.33it/s, loss=0.9539, mse=0.9523, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.33it/s, loss=0.9491, mse=0.9475, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.33it/s, loss=0.9587, mse=0.9571, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.75it/s, loss=0.9587, mse=0.9571, lpips=0.0032][A
Epoch 10/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.75it/s, loss=0.9498, mse=0.9482, lpips=0.0032][AEpoch 10/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.13it/s, loss=0.9498, mse=0.9482, lpips=0.0032]

Epoch 10/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 9/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.9759]

Epoch 10/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9520][A
Epoch 10/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9793][AEpoch 10 | Avg Train Loss: 0.9570 | Avg Val Loss: 0.9657
Saving interval checkpoint for epoch 10...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -199.6308, Max: 207.5130
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_10.png
Epoch 11/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 11/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.9553, mse=0.9537, lpips=0.0032]Epoch 11/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:29,  9.95s/it, loss=0.9553, mse=0.9537, lpips=0.0032]Epoch 11/1000 [TRAIN]:  10%|█         | 1/10 [00:10<01:29,  9.95s/it, loss=0.9552, mse=0.9536, lpips=0.0032]Epoch 11/1000 [TRAIN]:  20%|██        | 2/10 [00:10<00:33,  4.19s/it, loss=0.9552, mse=0.9536, lpips=0.0032]Epoch 11/1000 [TRAIN]:  20%|██        | 2/10 [00:10<00:33,  4.19s/it, loss=0.9537, mse=0.9521, lpips=0.0032]Epoch 11/1000 [TRAIN]:  30%|███       | 3/10 [00:10<00:16,  2.35s/it, loss=0.9537, mse=0.9521, lpips=0.0032]Epoch 11/1000 [TRAIN]:  30%|███       | 3/10 [00:10<00:16,  2.35s/it, loss=0.9525, mse=0.9509, lpips=0.0032]Epoch 11/1000 [TRAIN]:  40%|████      | 4/10 [00:10<00:08,  1.49s/it, loss=0.9525, mse=0.9509, lpips=0.0032]Epoch 11/1000 [TRAIN]:  40%|████      | 4/10 [00:10<00:08,  1.49s/it, loss=0.9525, mse=0.9509, lpips=0.0032]Epoch 11/1000 [TRAIN]:  50%|█████     | 5/10 [00:10<00:05,  1.02s/it, loss=0.9525, mse=0.9509, lpips=0.0032]Epoch 11/1000 [TRAIN]:  50%|█████     | 5/10 [00:10<00:05,  1.02s/it, loss=0.9507, mse=0.9491, lpips=0.0032]Epoch 11/1000 [TRAIN]:  60%|██████    | 6/10 [00:10<00:02,  1.39it/s, loss=0.9507, mse=0.9491, lpips=0.0032]Epoch 11/1000 [TRAIN]:  60%|██████    | 6/10 [00:10<00:02,  1.39it/s, loss=0.9489, mse=0.9473, lpips=0.0032]Epoch 11/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:01,  1.86it/s, loss=0.9489, mse=0.9473, lpips=0.0032]Epoch 11/1000 [TRAIN]:  70%|███████   | 7/10 [00:11<00:01,  1.86it/s, loss=0.9560, mse=0.9544, lpips=0.0032]Epoch 11/1000 [TRAIN]:  80%|████████  | 8/10 [00:11<00:00,  2.35it/s, loss=0.9560, mse=0.9544, lpips=0.0032]Epoch 11/1000 [TRAIN]:  80%|████████  | 8/10 [00:11<00:00,  2.35it/s, loss=0.9476, mse=0.9460, lpips=0.0032]Epoch 11/1000 [TRAIN]:  90%|█████████ | 9/10 [00:11<00:00,  2.90it/s, loss=0.9476, mse=0.9460, lpips=0.0032]Epoch 11/1000 [TRAIN]:  90%|█████████ | 9/10 [00:11<00:00,  2.90it/s, loss=0.9528, mse=0.9512, lpips=0.0032]Epoch 11/1000 [TRAIN]: 100%|██████████| 10/10 [00:11<00:00,  3.68it/s, loss=0.9528, mse=0.9512, lpips=0.0032]Epoch 11/1000 [TRAIN]: 100%|██████████| 10/10 [00:11<00:00,  1.14s/it, loss=0.9528, mse=0.9512, lpips=0.0032]
Epoch 11/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 10/1000 [VAL]:   0%|          | 0/2 [00:17<?, ?it/s, loss=0.9793]
Epoch 11/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9465]Epoch 11/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9303]Epoch 11 | Avg Train Loss: 0.9525 | Avg Val Loss: 0.9384
New best validation loss: 0.9384. Saving best model...

Epoch 12/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 12/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.9449, mse=0.9434, lpips=0.0032][A
Epoch 12/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.77s/it, loss=0.9449, mse=0.9434, lpips=0.0032][A
Epoch 12/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.77s/it, loss=0.9469, mse=0.9453, lpips=0.0031][A
Epoch 12/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:26,  3.29s/it, loss=0.9469, mse=0.9453, lpips=0.0031][A
Epoch 12/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:26,  3.29s/it, loss=0.9524, mse=0.9508, lpips=0.0032][A
Epoch 12/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:13,  1.87s/it, loss=0.9524, mse=0.9508, lpips=0.0032][A
Epoch 12/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:13,  1.87s/it, loss=0.9406, mse=0.9390, lpips=0.0031][A
Epoch 12/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.19s/it, loss=0.9406, mse=0.9390, lpips=0.0031][A
Epoch 12/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.19s/it, loss=0.9494, mse=0.9478, lpips=0.0032][A
Epoch 12/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.9494, mse=0.9478, lpips=0.0032][A
Epoch 12/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.9488, mse=0.9472, lpips=0.0032][A
Epoch 12/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.66it/s, loss=0.9488, mse=0.9472, lpips=0.0032][A
Epoch 12/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.66it/s, loss=0.9430, mse=0.9414, lpips=0.0032][A
Epoch 12/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.19it/s, loss=0.9430, mse=0.9414, lpips=0.0032][A
Epoch 12/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.19it/s, loss=0.9410, mse=0.9395, lpips=0.0031][A
Epoch 12/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.75it/s, loss=0.9410, mse=0.9395, lpips=0.0031][A
Epoch 12/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:00,  2.75it/s, loss=0.9477, mse=0.9461, lpips=0.0032][A
Epoch 12/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  3.37it/s, loss=0.9477, mse=0.9461, lpips=0.0032][A
Epoch 12/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  3.37it/s, loss=0.9416, mse=0.9401, lpips=0.0031][A
Epoch 12/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  4.08it/s, loss=0.9416, mse=0.9401, lpips=0.0031][AEpoch 12/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.09it/s, loss=0.9416, mse=0.9401, lpips=0.0031]

Epoch 12/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 11/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.9303]

Epoch 12/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9391][A
Epoch 12/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9407][AEpoch 12 | Avg Train Loss: 0.9456 | Avg Val Loss: 0.9399
Epoch 13/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 13/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.9424, mse=0.9409, lpips=0.0031]Epoch 13/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.45s/it, loss=0.9424, mse=0.9409, lpips=0.0031]Epoch 13/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.45s/it, loss=0.9414, mse=0.9398, lpips=0.0032]Epoch 13/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.14s/it, loss=0.9414, mse=0.9398, lpips=0.0032]Epoch 13/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.14s/it, loss=0.9416, mse=0.9400, lpips=0.0031]Epoch 13/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.78s/it, loss=0.9416, mse=0.9400, lpips=0.0031]Epoch 13/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.78s/it, loss=0.9414, mse=0.9398, lpips=0.0031]Epoch 13/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.78s/it, loss=0.9437, mse=0.9421, lpips=0.0031]Epoch 13/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:04,  1.22it/s, loss=0.9437, mse=0.9421, lpips=0.0031]Epoch 13/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:04,  1.22it/s, loss=0.9387, mse=0.9371, lpips=0.0031]Epoch 13/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.9368, mse=0.9352, lpips=0.0031]Epoch 13/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.03it/s, loss=0.9368, mse=0.9352, lpips=0.0031]Epoch 13/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.03it/s, loss=0.9358, mse=0.9343, lpips=0.0031]Epoch 13/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.03it/s, loss=0.9345, mse=0.9329, lpips=0.0031]Epoch 13/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.00it/s, loss=0.9345, mse=0.9329, lpips=0.0031]Epoch 13/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.00it/s, loss=0.9290, mse=0.9274, lpips=0.0031]Epoch 13/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.20it/s, loss=0.9290, mse=0.9274, lpips=0.0031]
Epoch 13/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 12/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.9407]
Epoch 13/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9362]Epoch 13/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9248]Epoch 13 | Avg Train Loss: 0.9385 | Avg Val Loss: 0.9305
New best validation loss: 0.9305. Saving best model...

Epoch 14/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 14/1000 [TRAIN]:   0%|          | 0/10 [00:06<?, ?it/s, loss=0.9350, mse=0.9334, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  10%|█         | 1/10 [00:06<01:02,  6.94s/it, loss=0.9350, mse=0.9334, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:02,  6.94s/it, loss=0.9342, mse=0.9326, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:23,  2.94s/it, loss=0.9342, mse=0.9326, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:23,  2.94s/it, loss=0.9330, mse=0.9314, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:11,  1.65s/it, loss=0.9330, mse=0.9314, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:11,  1.65s/it, loss=0.9366, mse=0.9350, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:11,  1.65s/it, loss=0.9353, mse=0.9338, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.31it/s, loss=0.9353, mse=0.9338, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.31it/s, loss=0.9290, mse=0.9274, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.31it/s, loss=0.9332, mse=0.9317, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  70%|███████   | 7/10 [00:07<00:01,  2.16it/s, loss=0.9332, mse=0.9317, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  70%|███████   | 7/10 [00:07<00:01,  2.16it/s, loss=0.9364, mse=0.9349, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  70%|███████   | 7/10 [00:07<00:01,  2.16it/s, loss=0.9335, mse=0.9319, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  90%|█████████ | 9/10 [00:07<00:00,  3.15it/s, loss=0.9335, mse=0.9319, lpips=0.0031][A
Epoch 14/1000 [TRAIN]:  90%|█████████ | 9/10 [00:07<00:00,  3.15it/s, loss=0.9349, mse=0.9333, lpips=0.0031][AEpoch 14/1000 [TRAIN]: 100%|██████████| 10/10 [00:07<00:00,  1.28it/s, loss=0.9349, mse=0.9333, lpips=0.0031]

Epoch 14/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 13/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.9248]

Epoch 14/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.9250][A
Epoch 14/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.9063][AEpoch 14 | Avg Train Loss: 0.9341 | Avg Val Loss: 0.9157
New best validation loss: 0.9157. Saving best model...
Epoch 15/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 15/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.9291, mse=0.9275, lpips=0.0031]Epoch 15/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.13s/it, loss=0.9291, mse=0.9275, lpips=0.0031]Epoch 15/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.13s/it, loss=0.9257, mse=0.9241, lpips=0.0031]Epoch 15/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.13s/it, loss=0.9296, mse=0.9280, lpips=0.0031]Epoch 15/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.78it/s, loss=0.9296, mse=0.9280, lpips=0.0031]Epoch 15/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.78it/s, loss=0.9296, mse=0.9280, lpips=0.0031]Epoch 15/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.78it/s, loss=0.9276, mse=0.9261, lpips=0.0031]Epoch 15/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.52it/s, loss=0.9276, mse=0.9261, lpips=0.0031]Epoch 15/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.52it/s, loss=0.9224, mse=0.9209, lpips=0.0031]Epoch 15/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.52it/s, loss=0.9276, mse=0.9260, lpips=0.0031]Epoch 15/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.53it/s, loss=0.9276, mse=0.9260, lpips=0.0031]Epoch 15/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.53it/s, loss=0.9252, mse=0.9236, lpips=0.0031]Epoch 15/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.53it/s, loss=0.9234, mse=0.9218, lpips=0.0031]Epoch 15/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  6.24it/s, loss=0.9234, mse=0.9218, lpips=0.0031]Epoch 15/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  6.24it/s, loss=0.9215, mse=0.9200, lpips=0.0031]Epoch 15/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.86it/s, loss=0.9215, mse=0.9200, lpips=0.0031]
Epoch 15/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 14/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.9063]
Epoch 15/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.9275]Epoch 15/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.9217]Epoch 15 | Avg Train Loss: 0.9262 | Avg Val Loss: 0.9246
Saving interval checkpoint for epoch 15...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -195.1387, Max: 192.2329
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_15.png

Epoch 16/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 16/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.9151, mse=0.9135, lpips=0.0031][A
Epoch 16/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:25,  9.46s/it, loss=0.9151, mse=0.9135, lpips=0.0031][A
Epoch 16/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:25,  9.46s/it, loss=0.9281, mse=0.9266, lpips=0.0031][A
Epoch 16/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:25,  9.46s/it, loss=0.9186, mse=0.9171, lpips=0.0031][A
Epoch 16/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.52s/it, loss=0.9186, mse=0.9171, lpips=0.0031][A
Epoch 16/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.52s/it, loss=0.9259, mse=0.9243, lpips=0.0031][A
Epoch 16/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.52s/it, loss=0.9206, mse=0.9191, lpips=0.0031][A
Epoch 16/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.27s/it, loss=0.9206, mse=0.9191, lpips=0.0031][A
Epoch 16/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.27s/it, loss=0.9148, mse=0.9132, lpips=0.0031][A
Epoch 16/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.05it/s, loss=0.9148, mse=0.9132, lpips=0.0031][A
Epoch 16/1000 [TRAIN]:  60%|██████    | 6/10 [00:10<00:03,  1.05it/s, loss=0.9184, mse=0.9169, lpips=0.0031][A
Epoch 16/1000 [TRAIN]:  60%|██████    | 6/10 [00:10<00:03,  1.05it/s, loss=0.9172, mse=0.9156, lpips=0.0031][A
Epoch 16/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:01,  1.72it/s, loss=0.9172, mse=0.9156, lpips=0.0031][A
Epoch 16/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:01,  1.72it/s, loss=0.9217, mse=0.9202, lpips=0.0031][A
Epoch 16/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:01,  1.72it/s, loss=0.9312, mse=0.9296, lpips=0.0031][A
Epoch 16/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  2.57it/s, loss=0.9312, mse=0.9296, lpips=0.0031][AEpoch 16/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.03s/it, loss=0.9312, mse=0.9296, lpips=0.0031]

Epoch 16/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 15/1000 [VAL]:   0%|          | 0/2 [00:14<?, ?it/s, loss=0.9217]

Epoch 16/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.9118][A
Epoch 16/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.9179][AEpoch 16 | Avg Train Loss: 0.9212 | Avg Val Loss: 0.9148
New best validation loss: 0.9148. Saving best model...
Epoch 17/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 17/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.9195, mse=0.9179, lpips=0.0031]Epoch 17/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.24s/it, loss=0.9195, mse=0.9179, lpips=0.0031]Epoch 17/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.24s/it, loss=0.9149, mse=0.9134, lpips=0.0031]Epoch 17/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:05,  1.38it/s, loss=0.9149, mse=0.9134, lpips=0.0031]Epoch 17/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:05,  1.38it/s, loss=0.9142, mse=0.9127, lpips=0.0031]Epoch 17/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:03,  2.03it/s, loss=0.9142, mse=0.9127, lpips=0.0031]Epoch 17/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:03,  2.03it/s, loss=0.9158, mse=0.9143, lpips=0.0031]Epoch 17/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:03,  2.03it/s, loss=0.9159, mse=0.9144, lpips=0.0031]Epoch 17/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  3.81it/s, loss=0.9159, mse=0.9144, lpips=0.0031]Epoch 17/1000 [TRAIN]:  50%|█████     | 5/10 [00:02<00:01,  3.81it/s, loss=0.9065, mse=0.9049, lpips=0.0031]Epoch 17/1000 [TRAIN]:  50%|█████     | 5/10 [00:02<00:01,  3.81it/s, loss=0.9051, mse=0.9036, lpips=0.0031]Epoch 17/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.39it/s, loss=0.9051, mse=0.9036, lpips=0.0031]Epoch 17/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.39it/s, loss=0.9108, mse=0.9093, lpips=0.0031]Epoch 17/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.39it/s, loss=0.9144, mse=0.9128, lpips=0.0031]Epoch 17/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  6.83it/s, loss=0.9144, mse=0.9128, lpips=0.0031]Epoch 17/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  6.83it/s, loss=0.8997, mse=0.8982, lpips=0.0030]Epoch 17/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.16it/s, loss=0.8997, mse=0.8982, lpips=0.0030]
Epoch 17/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 16/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.9179]
Epoch 17/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9076]Epoch 17/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9201]Epoch 17 | Avg Train Loss: 0.9117 | Avg Val Loss: 0.9138
New best validation loss: 0.9138. Saving best model...

Epoch 18/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 18/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.9073, mse=0.9058, lpips=0.0031][A
Epoch 18/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:10,  7.80s/it, loss=0.9073, mse=0.9058, lpips=0.0031][A
Epoch 18/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:10,  7.80s/it, loss=0.9169, mse=0.9154, lpips=0.0031][A
Epoch 18/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:10,  7.80s/it, loss=0.9145, mse=0.9130, lpips=0.0031][A
Epoch 18/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:14,  2.09s/it, loss=0.9145, mse=0.9130, lpips=0.0031][A
Epoch 18/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:14,  2.09s/it, loss=0.9131, mse=0.9116, lpips=0.0031][A
Epoch 18/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:14,  2.09s/it, loss=0.9135, mse=0.9120, lpips=0.0031][A
Epoch 18/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.06s/it, loss=0.9135, mse=0.9120, lpips=0.0031][A
Epoch 18/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.06s/it, loss=0.9169, mse=0.9154, lpips=0.0031][A
Epoch 18/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.06s/it, loss=0.9091, mse=0.9076, lpips=0.0031][A
Epoch 18/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.54it/s, loss=0.9091, mse=0.9076, lpips=0.0031][A
Epoch 18/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.54it/s, loss=0.9027, mse=0.9012, lpips=0.0031][A
Epoch 18/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.54it/s, loss=0.9047, mse=0.9031, lpips=0.0031][A
Epoch 18/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.29it/s, loss=0.9047, mse=0.9031, lpips=0.0031][A
Epoch 18/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.29it/s, loss=0.9115, mse=0.9100, lpips=0.0031][AEpoch 18/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.17it/s, loss=0.9115, mse=0.9100, lpips=0.0031]

Epoch 18/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 17/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.9201]

Epoch 18/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.9078][A
Epoch 18/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.8772][AEpoch 18 | Avg Train Loss: 0.9110 | Avg Val Loss: 0.8925
New best validation loss: 0.8925. Saving best model...
Epoch 19/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 19/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.9082, mse=0.9066, lpips=0.0030]Epoch 19/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.24s/it, loss=0.9082, mse=0.9066, lpips=0.0030]Epoch 19/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.24s/it, loss=0.9036, mse=0.9021, lpips=0.0030]Epoch 19/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.68it/s, loss=0.9036, mse=0.9021, lpips=0.0030]Epoch 19/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.68it/s, loss=0.9062, mse=0.9047, lpips=0.0031]Epoch 19/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.68it/s, loss=0.9007, mse=0.8992, lpips=0.0030]Epoch 19/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.66it/s, loss=0.9007, mse=0.8992, lpips=0.0030]Epoch 19/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.66it/s, loss=0.8989, mse=0.8974, lpips=0.0030]Epoch 19/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.27it/s, loss=0.8989, mse=0.8974, lpips=0.0030]Epoch 19/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.27it/s, loss=0.8968, mse=0.8953, lpips=0.0030]Epoch 19/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.69it/s, loss=0.8968, mse=0.8953, lpips=0.0030]Epoch 19/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.69it/s, loss=0.8972, mse=0.8957, lpips=0.0030]Epoch 19/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.06it/s, loss=0.8972, mse=0.8957, lpips=0.0030]Epoch 19/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.06it/s, loss=0.8931, mse=0.8916, lpips=0.0030]Epoch 19/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.16it/s, loss=0.8931, mse=0.8916, lpips=0.0030]Epoch 19/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.16it/s, loss=0.9059, mse=0.9044, lpips=0.0030]Epoch 19/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.63it/s, loss=0.9059, mse=0.9044, lpips=0.0030]Epoch 19/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.63it/s, loss=0.9033, mse=0.9017, lpips=0.0030]Epoch 19/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.20it/s, loss=0.9033, mse=0.9017, lpips=0.0030]Epoch 19/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.04it/s, loss=0.9033, mse=0.9017, lpips=0.0030]
Epoch 19/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 18/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.8772]
Epoch 19/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.9034]Epoch 19/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8996]Epoch 19 | Avg Train Loss: 0.9014 | Avg Val Loss: 0.9015

Epoch 20/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 20/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.8954, mse=0.8939, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:04,  7.14s/it, loss=0.8954, mse=0.8939, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:04,  7.14s/it, loss=0.8897, mse=0.8882, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:04,  7.14s/it, loss=0.9003, mse=0.8987, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:13,  1.93s/it, loss=0.9003, mse=0.8987, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:13,  1.93s/it, loss=0.8994, mse=0.8979, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:07,  1.32s/it, loss=0.8994, mse=0.8979, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:07,  1.32s/it, loss=0.8951, mse=0.8936, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:04,  1.08it/s, loss=0.8951, mse=0.8936, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:04,  1.08it/s, loss=0.8890, mse=0.8875, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  60%|██████    | 6/10 [00:07<00:02,  1.47it/s, loss=0.8890, mse=0.8875, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  60%|██████    | 6/10 [00:07<00:02,  1.47it/s, loss=0.8989, mse=0.8974, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.89it/s, loss=0.8989, mse=0.8974, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.89it/s, loss=0.8882, mse=0.8867, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.46it/s, loss=0.8882, mse=0.8867, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.46it/s, loss=0.8920, mse=0.8905, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.01it/s, loss=0.8920, mse=0.8905, lpips=0.0030][A
Epoch 20/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.01it/s, loss=0.8899, mse=0.8884, lpips=0.0030][A
Epoch 20/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  3.71it/s, loss=0.8899, mse=0.8884, lpips=0.0030][AEpoch 20/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.19it/s, loss=0.8899, mse=0.8884, lpips=0.0030]

Epoch 20/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 19/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.8996]

Epoch 20/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8792][A
Epoch 20/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8666][AEpoch 20 | Avg Train Loss: 0.8938 | Avg Val Loss: 0.8729
New best validation loss: 0.8729. Saving best model...
Saving interval checkpoint for epoch 20...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -201.9824, Max: 199.8931
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_20.png
Epoch 21/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 21/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.8962, mse=0.8947, lpips=0.0030]Epoch 21/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:21,  9.10s/it, loss=0.8962, mse=0.8947, lpips=0.0030]Epoch 21/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:21,  9.10s/it, loss=0.8889, mse=0.8874, lpips=0.0030]Epoch 21/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:21,  9.10s/it, loss=0.8901, mse=0.8886, lpips=0.0030]Epoch 21/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.43s/it, loss=0.8901, mse=0.8886, lpips=0.0030]Epoch 21/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.43s/it, loss=0.8930, mse=0.8915, lpips=0.0030]Epoch 21/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.43s/it, loss=0.8895, mse=0.8880, lpips=0.0030]Epoch 21/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.22s/it, loss=0.8895, mse=0.8880, lpips=0.0030]Epoch 21/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.22s/it, loss=0.8880, mse=0.8865, lpips=0.0030]Epoch 21/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.22s/it, loss=0.8873, mse=0.8858, lpips=0.0030]Epoch 21/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.35it/s, loss=0.8873, mse=0.8858, lpips=0.0030]Epoch 21/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.35it/s, loss=0.8808, mse=0.8793, lpips=0.0030]Epoch 21/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.35it/s, loss=0.8846, mse=0.8831, lpips=0.0030]Epoch 21/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.02it/s, loss=0.8846, mse=0.8831, lpips=0.0030]Epoch 21/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.02it/s, loss=0.8866, mse=0.8851, lpips=0.0030]Epoch 21/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.01it/s, loss=0.8866, mse=0.8851, lpips=0.0030]
Epoch 21/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 20/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.8666]
Epoch 21/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.8855]Epoch 21/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.9503]Epoch 21 | Avg Train Loss: 0.8885 | Avg Val Loss: 0.9179

Epoch 22/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 22/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.8719, mse=0.8704, lpips=0.0030][A
Epoch 22/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.20s/it, loss=0.8719, mse=0.8704, lpips=0.0030][A
Epoch 22/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.20s/it, loss=0.8787, mse=0.8772, lpips=0.0030][A
Epoch 22/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.20s/it, loss=0.8824, mse=0.8810, lpips=0.0030][A
Epoch 22/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.64it/s, loss=0.8824, mse=0.8810, lpips=0.0030][A
Epoch 22/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.64it/s, loss=0.8811, mse=0.8797, lpips=0.0030][A
Epoch 22/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.64it/s, loss=0.8822, mse=0.8807, lpips=0.0030][A
Epoch 22/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.36it/s, loss=0.8822, mse=0.8807, lpips=0.0030][A
Epoch 22/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.36it/s, loss=0.8800, mse=0.8785, lpips=0.0030][A
Epoch 22/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.36it/s, loss=0.8789, mse=0.8774, lpips=0.0030][A
Epoch 22/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.92it/s, loss=0.8789, mse=0.8774, lpips=0.0030][A
Epoch 22/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.92it/s, loss=0.8843, mse=0.8828, lpips=0.0030][A
Epoch 22/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.92it/s, loss=0.8746, mse=0.8731, lpips=0.0030][A
Epoch 22/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.35it/s, loss=0.8746, mse=0.8731, lpips=0.0030][A
Epoch 22/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.35it/s, loss=0.8817, mse=0.8802, lpips=0.0030][AEpoch 22/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.12it/s, loss=0.8817, mse=0.8802, lpips=0.0030]

Epoch 22/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 21/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.9503]

Epoch 22/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.8652][A
Epoch 22/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.8910][AEpoch 22 | Avg Train Loss: 0.8796 | Avg Val Loss: 0.8781
Epoch 23/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 23/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.8681, mse=0.8666, lpips=0.0029]Epoch 23/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.17s/it, loss=0.8681, mse=0.8666, lpips=0.0029]Epoch 23/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.17s/it, loss=0.8822, mse=0.8807, lpips=0.0030]Epoch 23/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:05,  1.57it/s, loss=0.8822, mse=0.8807, lpips=0.0030]Epoch 23/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:05,  1.57it/s, loss=0.8759, mse=0.8744, lpips=0.0030]Epoch 23/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:05,  1.57it/s, loss=0.8672, mse=0.8657, lpips=0.0029]Epoch 23/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.45it/s, loss=0.8672, mse=0.8657, lpips=0.0029]Epoch 23/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.45it/s, loss=0.8863, mse=0.8848, lpips=0.0030]Epoch 23/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.45it/s, loss=0.8750, mse=0.8735, lpips=0.0030]Epoch 23/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.12it/s, loss=0.8750, mse=0.8735, lpips=0.0030]Epoch 23/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.12it/s, loss=0.8793, mse=0.8778, lpips=0.0030]Epoch 23/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.12it/s, loss=0.8689, mse=0.8674, lpips=0.0030]Epoch 23/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.50it/s, loss=0.8689, mse=0.8674, lpips=0.0030]Epoch 23/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  6.50it/s, loss=0.8765, mse=0.8750, lpips=0.0030]Epoch 23/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  6.50it/s, loss=0.8673, mse=0.8658, lpips=0.0029]Epoch 23/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  8.03it/s, loss=0.8673, mse=0.8658, lpips=0.0029]Epoch 23/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.74it/s, loss=0.8673, mse=0.8658, lpips=0.0029]
Epoch 23/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 22/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.8910]
Epoch 23/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8657]Epoch 23/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8322]Epoch 23 | Avg Train Loss: 0.8747 | Avg Val Loss: 0.8490
New best validation loss: 0.8490. Saving best model...

Epoch 24/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 24/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.8727, mse=0.8713, lpips=0.0030][A
Epoch 24/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:08,  7.57s/it, loss=0.8727, mse=0.8713, lpips=0.0030][A
Epoch 24/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:08,  7.57s/it, loss=0.8835, mse=0.8820, lpips=0.0030][A
Epoch 24/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:08,  7.57s/it, loss=0.8634, mse=0.8619, lpips=0.0029][A
Epoch 24/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:14,  2.03s/it, loss=0.8634, mse=0.8619, lpips=0.0029][A
Epoch 24/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:14,  2.03s/it, loss=0.8575, mse=0.8560, lpips=0.0029][A
Epoch 24/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:14,  2.03s/it, loss=0.8693, mse=0.8678, lpips=0.0029][A
Epoch 24/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:05,  1.03s/it, loss=0.8693, mse=0.8678, lpips=0.0029][A
Epoch 24/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.03s/it, loss=0.8702, mse=0.8688, lpips=0.0030][A
Epoch 24/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.03s/it, loss=0.8680, mse=0.8665, lpips=0.0029][A
Epoch 24/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.58it/s, loss=0.8680, mse=0.8665, lpips=0.0029][A
Epoch 24/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.58it/s, loss=0.8570, mse=0.8555, lpips=0.0029][A
Epoch 24/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.58it/s, loss=0.8647, mse=0.8633, lpips=0.0029][A
Epoch 24/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.36it/s, loss=0.8647, mse=0.8633, lpips=0.0029][A
Epoch 24/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.36it/s, loss=0.8593, mse=0.8579, lpips=0.0029][AEpoch 24/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.20it/s, loss=0.8593, mse=0.8579, lpips=0.0029]

Epoch 24/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 23/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.8322]

Epoch 24/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.8690][A
Epoch 24/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.8415][AEpoch 24 | Avg Train Loss: 0.8666 | Avg Val Loss: 0.8552
Epoch 25/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 25/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.8688, mse=0.8673, lpips=0.0029]Epoch 25/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:08,  1.07it/s, loss=0.8688, mse=0.8673, lpips=0.0029]Epoch 25/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.07it/s, loss=0.8585, mse=0.8571, lpips=0.0029]Epoch 25/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.85it/s, loss=0.8585, mse=0.8571, lpips=0.0029]Epoch 25/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.85it/s, loss=0.8627, mse=0.8612, lpips=0.0029]Epoch 25/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.92it/s, loss=0.8627, mse=0.8612, lpips=0.0029]Epoch 25/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.92it/s, loss=0.8613, mse=0.8598, lpips=0.0029]Epoch 25/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.92it/s, loss=0.8677, mse=0.8663, lpips=0.0029]Epoch 25/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:00,  5.06it/s, loss=0.8677, mse=0.8663, lpips=0.0029]Epoch 25/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:00,  5.06it/s, loss=0.8630, mse=0.8615, lpips=0.0029]Epoch 25/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:00,  5.06it/s, loss=0.8565, mse=0.8550, lpips=0.0029]Epoch 25/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.76it/s, loss=0.8565, mse=0.8550, lpips=0.0029]Epoch 25/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.76it/s, loss=0.8638, mse=0.8623, lpips=0.0029]Epoch 25/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.76it/s, loss=0.8685, mse=0.8671, lpips=0.0029]Epoch 25/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  8.01it/s, loss=0.8685, mse=0.8671, lpips=0.0029]Epoch 25/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  8.01it/s, loss=0.8553, mse=0.8538, lpips=0.0029]Epoch 25/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.28it/s, loss=0.8553, mse=0.8538, lpips=0.0029]
Epoch 25/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 24/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.8415]
Epoch 25/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.8533]Epoch 25/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.8308]Epoch 25 | Avg Train Loss: 0.8626 | Avg Val Loss: 0.8421
New best validation loss: 0.8421. Saving best model...
Saving interval checkpoint for epoch 25...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -235.1911, Max: 221.5546
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_25.png

Epoch 26/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 26/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.8592, mse=0.8578, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:21,  9.09s/it, loss=0.8592, mse=0.8578, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:21,  9.09s/it, loss=0.8722, mse=0.8707, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:21,  9.09s/it, loss=0.8582, mse=0.8567, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:16,  2.42s/it, loss=0.8582, mse=0.8567, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:16,  2.42s/it, loss=0.8590, mse=0.8575, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.64s/it, loss=0.8590, mse=0.8575, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.64s/it, loss=0.8485, mse=0.8471, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:05,  1.15s/it, loss=0.8485, mse=0.8471, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:05,  1.15s/it, loss=0.8499, mse=0.8484, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.20it/s, loss=0.8499, mse=0.8484, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.20it/s, loss=0.8507, mse=0.8492, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:01,  1.60it/s, loss=0.8507, mse=0.8492, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:01,  1.60it/s, loss=0.8453, mse=0.8438, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:00,  2.09it/s, loss=0.8453, mse=0.8438, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:00,  2.09it/s, loss=0.8416, mse=0.8402, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  2.61it/s, loss=0.8416, mse=0.8402, lpips=0.0029][A
Epoch 26/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  2.61it/s, loss=0.8307, mse=0.8293, lpips=0.0028][A
Epoch 26/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  3.27it/s, loss=0.8307, mse=0.8293, lpips=0.0028][AEpoch 26/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.04s/it, loss=0.8307, mse=0.8293, lpips=0.0028]

Epoch 26/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 25/1000 [VAL]:   0%|          | 0/2 [00:13<?, ?it/s, loss=0.8308]

Epoch 26/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.8482][A
Epoch 26/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.8309][AEpoch 26 | Avg Train Loss: 0.8515 | Avg Val Loss: 0.8395
New best validation loss: 0.8395. Saving best model...
Epoch 27/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 27/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.8557, mse=0.8542, lpips=0.0029]Epoch 27/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:06,  7.39s/it, loss=0.8557, mse=0.8542, lpips=0.0029]Epoch 27/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:06,  7.39s/it, loss=0.8578, mse=0.8563, lpips=0.0029]Epoch 27/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.14s/it, loss=0.8578, mse=0.8563, lpips=0.0029]Epoch 27/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.14s/it, loss=0.8612, mse=0.8598, lpips=0.0029]Epoch 27/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.79s/it, loss=0.8612, mse=0.8598, lpips=0.0029]Epoch 27/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.79s/it, loss=0.8503, mse=0.8488, lpips=0.0029]Epoch 27/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.14s/it, loss=0.8503, mse=0.8488, lpips=0.0029]Epoch 27/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:06,  1.14s/it, loss=0.8518, mse=0.8503, lpips=0.0029]Epoch 27/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.25it/s, loss=0.8518, mse=0.8503, lpips=0.0029]Epoch 27/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.25it/s, loss=0.8389, mse=0.8375, lpips=0.0029]Epoch 27/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.74it/s, loss=0.8389, mse=0.8375, lpips=0.0029]Epoch 27/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.74it/s, loss=0.8517, mse=0.8503, lpips=0.0029]Epoch 27/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.25it/s, loss=0.8517, mse=0.8503, lpips=0.0029]Epoch 27/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.25it/s, loss=0.8401, mse=0.8387, lpips=0.0029]Epoch 27/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.86it/s, loss=0.8401, mse=0.8387, lpips=0.0029]Epoch 27/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.86it/s, loss=0.8322, mse=0.8308, lpips=0.0028]Epoch 27/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.44it/s, loss=0.8322, mse=0.8308, lpips=0.0028]Epoch 27/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.44it/s, loss=0.8375, mse=0.8361, lpips=0.0029]Epoch 27/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  4.07it/s, loss=0.8375, mse=0.8361, lpips=0.0029]Epoch 27/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.13it/s, loss=0.8375, mse=0.8361, lpips=0.0029]
Epoch 27/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 26/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.8309]
Epoch 27/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8428]Epoch 27/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8520]Epoch 27 | Avg Train Loss: 0.8477 | Avg Val Loss: 0.8474

Epoch 28/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 28/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.8501, mse=0.8487, lpips=0.0029][A
Epoch 28/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:03,  7.03s/it, loss=0.8501, mse=0.8487, lpips=0.0029][A
Epoch 28/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:03,  7.03s/it, loss=0.8314, mse=0.8300, lpips=0.0028][A
Epoch 28/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:23,  2.99s/it, loss=0.8314, mse=0.8300, lpips=0.0028][A
Epoch 28/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:23,  2.99s/it, loss=0.8461, mse=0.8447, lpips=0.0029][A
Epoch 28/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:11,  1.71s/it, loss=0.8461, mse=0.8447, lpips=0.0029][A
Epoch 28/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:11,  1.71s/it, loss=0.8454, mse=0.8439, lpips=0.0029][A
Epoch 28/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.09s/it, loss=0.8454, mse=0.8439, lpips=0.0029][A
Epoch 28/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.09s/it, loss=0.8541, mse=0.8527, lpips=0.0029][A
Epoch 28/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.31it/s, loss=0.8541, mse=0.8527, lpips=0.0029][A
Epoch 28/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.31it/s, loss=0.8466, mse=0.8452, lpips=0.0029][A
Epoch 28/1000 [TRAIN]:  60%|██████    | 6/10 [00:07<00:02,  1.79it/s, loss=0.8466, mse=0.8452, lpips=0.0029][A
Epoch 28/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.79it/s, loss=0.8430, mse=0.8416, lpips=0.0029][A
Epoch 28/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.35it/s, loss=0.8430, mse=0.8416, lpips=0.0029][A
Epoch 28/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.35it/s, loss=0.8411, mse=0.8397, lpips=0.0029][A
Epoch 28/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.86it/s, loss=0.8411, mse=0.8397, lpips=0.0029][A
Epoch 28/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.86it/s, loss=0.8316, mse=0.8302, lpips=0.0028][A
Epoch 28/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.54it/s, loss=0.8316, mse=0.8302, lpips=0.0028][A
Epoch 28/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.54it/s, loss=0.8358, mse=0.8344, lpips=0.0029][A
Epoch 28/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  4.16it/s, loss=0.8358, mse=0.8344, lpips=0.0029][AEpoch 28/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.18it/s, loss=0.8358, mse=0.8344, lpips=0.0029]

Epoch 28/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 27/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.8520]

Epoch 28/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8433][A
Epoch 28/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8581][AEpoch 28 | Avg Train Loss: 0.8425 | Avg Val Loss: 0.8507
Epoch 29/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 29/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.8484, mse=0.8470, lpips=0.0029]Epoch 29/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.67s/it, loss=0.8484, mse=0.8470, lpips=0.0029]Epoch 29/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.67s/it, loss=0.8369, mse=0.8355, lpips=0.0028]Epoch 29/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.24s/it, loss=0.8369, mse=0.8355, lpips=0.0028]Epoch 29/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.24s/it, loss=0.8471, mse=0.8456, lpips=0.0029]Epoch 29/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.84s/it, loss=0.8471, mse=0.8456, lpips=0.0029]Epoch 29/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.84s/it, loss=0.8355, mse=0.8341, lpips=0.0028]Epoch 29/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.84s/it, loss=0.8331, mse=0.8316, lpips=0.0028]Epoch 29/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.18it/s, loss=0.8331, mse=0.8316, lpips=0.0028]Epoch 29/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.18it/s, loss=0.8274, mse=0.8260, lpips=0.0028]Epoch 29/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.18it/s, loss=0.8366, mse=0.8352, lpips=0.0029]Epoch 29/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.97it/s, loss=0.8366, mse=0.8352, lpips=0.0029]Epoch 29/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.97it/s, loss=0.8414, mse=0.8400, lpips=0.0028]Epoch 29/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.97it/s, loss=0.8244, mse=0.8229, lpips=0.0028]Epoch 29/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.91it/s, loss=0.8244, mse=0.8229, lpips=0.0028]Epoch 29/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.91it/s, loss=0.8393, mse=0.8379, lpips=0.0029]Epoch 29/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.17it/s, loss=0.8393, mse=0.8379, lpips=0.0029]
Epoch 29/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 28/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.8581]
Epoch 29/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8371]Epoch 29/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8486]Epoch 29 | Avg Train Loss: 0.8370 | Avg Val Loss: 0.8428

Epoch 30/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 30/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.8309, mse=0.8294, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.71s/it, loss=0.8309, mse=0.8294, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.71s/it, loss=0.8332, mse=0.8318, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:26,  3.26s/it, loss=0.8332, mse=0.8318, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:26,  3.26s/it, loss=0.8098, mse=0.8084, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.84s/it, loss=0.8098, mse=0.8084, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.84s/it, loss=0.8252, mse=0.8238, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.18s/it, loss=0.8252, mse=0.8238, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.18s/it, loss=0.8356, mse=0.8342, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.18s/it, loss=0.8351, mse=0.8337, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.66it/s, loss=0.8351, mse=0.8337, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.66it/s, loss=0.8110, mse=0.8096, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.66it/s, loss=0.8372, mse=0.8358, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.62it/s, loss=0.8372, mse=0.8358, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.62it/s, loss=0.8173, mse=0.8159, lpips=0.0028][A
Epoch 30/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.62it/s, loss=0.8200, mse=0.8187, lpips=0.0028][A
Epoch 30/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  3.76it/s, loss=0.8200, mse=0.8187, lpips=0.0028][AEpoch 30/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.15it/s, loss=0.8200, mse=0.8187, lpips=0.0028]

Epoch 30/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 29/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.8486]

Epoch 30/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8118][A
Epoch 30/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8955][AEpoch 30 | Avg Train Loss: 0.8255 | Avg Val Loss: 0.8537
Saving interval checkpoint for epoch 30...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -202.5558, Max: 192.7645
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_30.png
Epoch 31/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 31/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.8207, mse=0.8193, lpips=0.0028]Epoch 31/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:21,  9.04s/it, loss=0.8207, mse=0.8193, lpips=0.0028]Epoch 31/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:21,  9.04s/it, loss=0.8206, mse=0.8192, lpips=0.0028]Epoch 31/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:21,  9.04s/it, loss=0.8250, mse=0.8236, lpips=0.0028]Epoch 31/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:16,  2.41s/it, loss=0.8250, mse=0.8236, lpips=0.0028]Epoch 31/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:16,  2.41s/it, loss=0.8184, mse=0.8170, lpips=0.0028]Epoch 31/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:16,  2.41s/it, loss=0.8251, mse=0.8237, lpips=0.0028]Epoch 31/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.22s/it, loss=0.8251, mse=0.8237, lpips=0.0028]Epoch 31/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.22s/it, loss=0.8250, mse=0.8236, lpips=0.0028]Epoch 31/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.22s/it, loss=0.8214, mse=0.8200, lpips=0.0028]Epoch 31/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.35it/s, loss=0.8214, mse=0.8200, lpips=0.0028]Epoch 31/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.35it/s, loss=0.8167, mse=0.8153, lpips=0.0028]Epoch 31/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.35it/s, loss=0.8289, mse=0.8275, lpips=0.0028]Epoch 31/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.01it/s, loss=0.8289, mse=0.8275, lpips=0.0028]Epoch 31/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.01it/s, loss=0.8138, mse=0.8124, lpips=0.0028]Epoch 31/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.02it/s, loss=0.8138, mse=0.8124, lpips=0.0028]
Epoch 31/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 30/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.8955]
Epoch 31/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.8094]Epoch 31/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.8661]Epoch 31 | Avg Train Loss: 0.8215 | Avg Val Loss: 0.8378
New best validation loss: 0.8378. Saving best model...

Epoch 32/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 32/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.8179, mse=0.8165, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.31s/it, loss=0.8179, mse=0.8165, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.31s/it, loss=0.8226, mse=0.8212, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:06,  1.31it/s, loss=0.8226, mse=0.8212, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  20%|██        | 2/10 [00:02<00:06,  1.31it/s, loss=0.8166, mse=0.8152, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  30%|███       | 3/10 [00:02<00:03,  1.78it/s, loss=0.8166, mse=0.8152, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  30%|███       | 3/10 [00:02<00:03,  1.78it/s, loss=0.8070, mse=0.8056, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  40%|████      | 4/10 [00:02<00:02,  2.56it/s, loss=0.8070, mse=0.8056, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  40%|████      | 4/10 [00:02<00:02,  2.56it/s, loss=0.8148, mse=0.8134, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  40%|████      | 4/10 [00:02<00:02,  2.56it/s, loss=0.8213, mse=0.8199, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.36it/s, loss=0.8213, mse=0.8199, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.36it/s, loss=0.8145, mse=0.8132, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.36it/s, loss=0.8112, mse=0.8098, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.85it/s, loss=0.8112, mse=0.8098, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.85it/s, loss=0.8073, mse=0.8059, lpips=0.0028][A
Epoch 32/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.85it/s, loss=0.8083, mse=0.8069, lpips=0.0028][A
Epoch 32/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  7.59it/s, loss=0.8083, mse=0.8069, lpips=0.0028][AEpoch 32/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  3.79it/s, loss=0.8083, mse=0.8069, lpips=0.0028]

Epoch 32/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 31/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8661]

Epoch 32/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8295][A
Epoch 32/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8770][AEpoch 32 | Avg Train Loss: 0.8141 | Avg Val Loss: 0.8533
Epoch 33/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 33/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.8022, mse=0.8008, lpips=0.0027]Epoch 33/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:10,  7.82s/it, loss=0.8022, mse=0.8008, lpips=0.0027]Epoch 33/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:10,  7.82s/it, loss=0.8123, mse=0.8110, lpips=0.0028]Epoch 33/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:10,  7.82s/it, loss=0.8025, mse=0.8012, lpips=0.0027]Epoch 33/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:14,  2.09s/it, loss=0.8025, mse=0.8012, lpips=0.0027]Epoch 33/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:14,  2.09s/it, loss=0.8169, mse=0.8155, lpips=0.0028]Epoch 33/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:14,  2.09s/it, loss=0.8038, mse=0.8024, lpips=0.0027]Epoch 33/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.06s/it, loss=0.8038, mse=0.8024, lpips=0.0027]Epoch 33/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.06s/it, loss=0.8171, mse=0.8157, lpips=0.0028]Epoch 33/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.06s/it, loss=0.8052, mse=0.8039, lpips=0.0027]Epoch 33/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.54it/s, loss=0.8052, mse=0.8039, lpips=0.0027]Epoch 33/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.54it/s, loss=0.7999, mse=0.7985, lpips=0.0027]Epoch 33/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.54it/s, loss=0.8290, mse=0.8277, lpips=0.0028]Epoch 33/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.27it/s, loss=0.8290, mse=0.8277, lpips=0.0028]Epoch 33/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.27it/s, loss=0.8225, mse=0.8211, lpips=0.0028]Epoch 33/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.16it/s, loss=0.8225, mse=0.8211, lpips=0.0028]
Epoch 33/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 32/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.8770]
Epoch 33/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.8151]Epoch 33/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.8104]Epoch 33 | Avg Train Loss: 0.8111 | Avg Val Loss: 0.8128
New best validation loss: 0.8128. Saving best model...

Epoch 34/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 34/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.8104, mse=0.8091, lpips=0.0028][A
Epoch 34/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.02s/it, loss=0.8104, mse=0.8091, lpips=0.0028][A
Epoch 34/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.02s/it, loss=0.7973, mse=0.7960, lpips=0.0027][A
Epoch 34/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.02s/it, loss=0.7992, mse=0.7979, lpips=0.0027][A
Epoch 34/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.04it/s, loss=0.7992, mse=0.7979, lpips=0.0027][A
Epoch 34/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.04it/s, loss=0.8041, mse=0.8028, lpips=0.0027][A
Epoch 34/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.04it/s, loss=0.7994, mse=0.7980, lpips=0.0027][A
Epoch 34/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.85it/s, loss=0.7994, mse=0.7980, lpips=0.0027][A
Epoch 34/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.85it/s, loss=0.7999, mse=0.7985, lpips=0.0027][A
Epoch 34/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.85it/s, loss=0.8183, mse=0.8169, lpips=0.0028][A
Epoch 34/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.66it/s, loss=0.8183, mse=0.8169, lpips=0.0028][A
Epoch 34/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.66it/s, loss=0.8142, mse=0.8129, lpips=0.0028][A
Epoch 34/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  5.81it/s, loss=0.8142, mse=0.8129, lpips=0.0028][A
Epoch 34/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  5.81it/s, loss=0.8114, mse=0.8100, lpips=0.0027][A
Epoch 34/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  6.10it/s, loss=0.8114, mse=0.8100, lpips=0.0027][A
Epoch 34/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  6.10it/s, loss=0.8306, mse=0.8292, lpips=0.0028][A
Epoch 34/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.25it/s, loss=0.8306, mse=0.8292, lpips=0.0028][AEpoch 34/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.78it/s, loss=0.8306, mse=0.8292, lpips=0.0028]

Epoch 34/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 33/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.8104]

Epoch 34/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7882][A
Epoch 34/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7288][AEpoch 34 | Avg Train Loss: 0.8085 | Avg Val Loss: 0.7585
New best validation loss: 0.7585. Saving best model...
Epoch 35/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 35/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.7835, mse=0.7821, lpips=0.0027]Epoch 35/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.49s/it, loss=0.7835, mse=0.7821, lpips=0.0027]Epoch 35/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.49s/it, loss=0.7863, mse=0.7850, lpips=0.0027]Epoch 35/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.49s/it, loss=0.7996, mse=0.7982, lpips=0.0027]Epoch 35/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:14,  2.01s/it, loss=0.7996, mse=0.7982, lpips=0.0027]Epoch 35/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:14,  2.01s/it, loss=0.8075, mse=0.8061, lpips=0.0027]Epoch 35/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:08,  1.38s/it, loss=0.8075, mse=0.8061, lpips=0.0027]Epoch 35/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:08,  1.38s/it, loss=0.7829, mse=0.7816, lpips=0.0027]Epoch 35/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.02it/s, loss=0.7829, mse=0.7816, lpips=0.0027]Epoch 35/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.02it/s, loss=0.8089, mse=0.8075, lpips=0.0027]Epoch 35/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.42it/s, loss=0.8089, mse=0.8075, lpips=0.0027]Epoch 35/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.42it/s, loss=0.7874, mse=0.7860, lpips=0.0027]Epoch 35/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.93it/s, loss=0.7874, mse=0.7860, lpips=0.0027]Epoch 35/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.93it/s, loss=0.7846, mse=0.7833, lpips=0.0027]Epoch 35/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.40it/s, loss=0.7846, mse=0.7833, lpips=0.0027]Epoch 35/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.40it/s, loss=0.7979, mse=0.7965, lpips=0.0027]Epoch 35/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.97it/s, loss=0.7979, mse=0.7965, lpips=0.0027]Epoch 35/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.97it/s, loss=0.7781, mse=0.7768, lpips=0.0027]Epoch 35/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  3.56it/s, loss=0.7781, mse=0.7768, lpips=0.0027]Epoch 35/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.14it/s, loss=0.7781, mse=0.7768, lpips=0.0027]
Epoch 35/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 34/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.7288]
Epoch 35/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7793]Epoch 35/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8545]Epoch 35 | Avg Train Loss: 0.7917 | Avg Val Loss: 0.8169
Saving interval checkpoint for epoch 35...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -209.2918, Max: 194.2468
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_35.png

Epoch 36/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 36/1000 [TRAIN]:   0%|          | 0/10 [00:08<?, ?it/s, loss=0.7965, mse=0.7951, lpips=0.0027][A
Epoch 36/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:16,  8.53s/it, loss=0.7965, mse=0.7951, lpips=0.0027][A
Epoch 36/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:16,  8.53s/it, loss=0.7898, mse=0.7885, lpips=0.0027][A
Epoch 36/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:16,  8.53s/it, loss=0.7868, mse=0.7855, lpips=0.0027][A
Epoch 36/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:15,  2.28s/it, loss=0.7868, mse=0.7855, lpips=0.0027][A
Epoch 36/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:15,  2.28s/it, loss=0.7914, mse=0.7901, lpips=0.0027][A
Epoch 36/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:15,  2.28s/it, loss=0.7739, mse=0.7726, lpips=0.0027][A
Epoch 36/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.15s/it, loss=0.7739, mse=0.7726, lpips=0.0027][A
Epoch 36/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.15s/it, loss=0.7876, mse=0.7863, lpips=0.0027][A
Epoch 36/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:05,  1.15s/it, loss=0.7930, mse=0.7916, lpips=0.0027][A
Epoch 36/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.42it/s, loss=0.7930, mse=0.7916, lpips=0.0027][A
Epoch 36/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.42it/s, loss=0.7862, mse=0.7848, lpips=0.0027][A
Epoch 36/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.42it/s, loss=0.7990, mse=0.7976, lpips=0.0027][A
Epoch 36/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.11it/s, loss=0.7990, mse=0.7976, lpips=0.0027][A
Epoch 36/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.11it/s, loss=0.7823, mse=0.7810, lpips=0.0027][AEpoch 36/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.07it/s, loss=0.7823, mse=0.7810, lpips=0.0027]

Epoch 36/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 35/1000 [VAL]:   0%|          | 0/2 [00:14<?, ?it/s, loss=0.8545]

Epoch 36/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7837][A
Epoch 36/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7975][AEpoch 36 | Avg Train Loss: 0.7886 | Avg Val Loss: 0.7906
Epoch 37/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 37/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.7917, mse=0.7903, lpips=0.0027]Epoch 37/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.17s/it, loss=0.7917, mse=0.7903, lpips=0.0027]Epoch 37/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.17s/it, loss=0.8077, mse=0.8063, lpips=0.0027]Epoch 37/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.17s/it, loss=0.7651, mse=0.7638, lpips=0.0026]Epoch 37/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.71it/s, loss=0.7651, mse=0.7638, lpips=0.0026]Epoch 37/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.71it/s, loss=0.7830, mse=0.7817, lpips=0.0027]Epoch 37/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.71it/s, loss=0.7860, mse=0.7847, lpips=0.0027]Epoch 37/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.43it/s, loss=0.7860, mse=0.7847, lpips=0.0027]Epoch 37/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.43it/s, loss=0.7830, mse=0.7816, lpips=0.0027]Epoch 37/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.43it/s, loss=0.7926, mse=0.7913, lpips=0.0027]Epoch 37/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.95it/s, loss=0.7926, mse=0.7913, lpips=0.0027]Epoch 37/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.95it/s, loss=0.7726, mse=0.7713, lpips=0.0026]Epoch 37/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.95it/s, loss=0.7880, mse=0.7867, lpips=0.0027]Epoch 37/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.36it/s, loss=0.7880, mse=0.7867, lpips=0.0027]Epoch 37/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.36it/s, loss=0.7842, mse=0.7829, lpips=0.0027]Epoch 37/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.17it/s, loss=0.7842, mse=0.7829, lpips=0.0027]
Epoch 37/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 36/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.7975]
Epoch 37/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7740]Epoch 37/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.8049]Epoch 37 | Avg Train Loss: 0.7854 | Avg Val Loss: 0.7895

Epoch 38/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 38/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.7991, mse=0.7978, lpips=0.0027][A
Epoch 38/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:07,  1.19it/s, loss=0.7991, mse=0.7978, lpips=0.0027][A
Epoch 38/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:07,  1.19it/s, loss=0.7806, mse=0.7793, lpips=0.0026][A
Epoch 38/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:07,  1.19it/s, loss=0.7902, mse=0.7889, lpips=0.0027][A
Epoch 38/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:01,  3.53it/s, loss=0.7902, mse=0.7889, lpips=0.0027][A
Epoch 38/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:01,  3.53it/s, loss=0.7927, mse=0.7914, lpips=0.0027][A
Epoch 38/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:01,  3.53it/s, loss=0.7719, mse=0.7705, lpips=0.0026][A
Epoch 38/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:00,  5.49it/s, loss=0.7719, mse=0.7705, lpips=0.0026][A
Epoch 38/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:00,  5.49it/s, loss=0.7629, mse=0.7616, lpips=0.0026][A
Epoch 38/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:00,  5.49it/s, loss=0.7982, mse=0.7968, lpips=0.0027][A
Epoch 38/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.85it/s, loss=0.7982, mse=0.7968, lpips=0.0027][A
Epoch 38/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.85it/s, loss=0.8030, mse=0.8017, lpips=0.0027][A
Epoch 38/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.85it/s, loss=0.7794, mse=0.7781, lpips=0.0027][A
Epoch 38/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.94it/s, loss=0.7794, mse=0.7781, lpips=0.0027][A
Epoch 38/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.94it/s, loss=0.7806, mse=0.7793, lpips=0.0026][AEpoch 38/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  6.14it/s, loss=0.7806, mse=0.7793, lpips=0.0026]

Epoch 38/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 37/1000 [VAL]:   0%|          | 0/2 [00:01<?, ?it/s, loss=0.8049]

Epoch 38/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7874][A
Epoch 38/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7158][AEpoch 38 | Avg Train Loss: 0.7859 | Avg Val Loss: 0.7516
New best validation loss: 0.7516. Saving best model...
Epoch 39/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 39/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.7753, mse=0.7740, lpips=0.0026]Epoch 39/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:08,  1.06it/s, loss=0.7753, mse=0.7740, lpips=0.0026]Epoch 39/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.06it/s, loss=0.7540, mse=0.7527, lpips=0.0026]Epoch 39/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.90it/s, loss=0.7540, mse=0.7527, lpips=0.0026]Epoch 39/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.90it/s, loss=0.7818, mse=0.7804, lpips=0.0027]Epoch 39/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.90it/s, loss=0.7846, mse=0.7833, lpips=0.0027]Epoch 39/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.96it/s, loss=0.7846, mse=0.7833, lpips=0.0027]Epoch 39/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.96it/s, loss=0.7708, mse=0.7695, lpips=0.0026]Epoch 39/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.47it/s, loss=0.7708, mse=0.7695, lpips=0.0026]Epoch 39/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.47it/s, loss=0.7865, mse=0.7852, lpips=0.0027]Epoch 39/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.78it/s, loss=0.7865, mse=0.7852, lpips=0.0027]Epoch 39/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.78it/s, loss=0.7894, mse=0.7881, lpips=0.0027]Epoch 39/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  4.98it/s, loss=0.7894, mse=0.7881, lpips=0.0027]Epoch 39/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.98it/s, loss=0.7590, mse=0.7577, lpips=0.0026]Epoch 39/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.12it/s, loss=0.7590, mse=0.7577, lpips=0.0026]Epoch 39/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.12it/s, loss=0.7598, mse=0.7585, lpips=0.0026]Epoch 39/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.62it/s, loss=0.7598, mse=0.7585, lpips=0.0026]Epoch 39/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.62it/s, loss=0.7636, mse=0.7623, lpips=0.0026]Epoch 39/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.15it/s, loss=0.7636, mse=0.7623, lpips=0.0026]Epoch 39/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.31it/s, loss=0.7636, mse=0.7623, lpips=0.0026]
Epoch 39/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 38/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.7158]
Epoch 39/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7709]Epoch 39/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8470]Epoch 39 | Avg Train Loss: 0.7725 | Avg Val Loss: 0.8090

Epoch 40/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 40/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.7699, mse=0.7686, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.74s/it, loss=0.7699, mse=0.7686, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.74s/it, loss=0.7782, mse=0.7769, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:26,  3.25s/it, loss=0.7782, mse=0.7769, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:26,  3.25s/it, loss=0.7805, mse=0.7791, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.84s/it, loss=0.7805, mse=0.7791, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.84s/it, loss=0.7555, mse=0.7542, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.18s/it, loss=0.7555, mse=0.7542, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.18s/it, loss=0.7697, mse=0.7684, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.24it/s, loss=0.7697, mse=0.7684, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.24it/s, loss=0.7553, mse=0.7540, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.70it/s, loss=0.7553, mse=0.7540, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.70it/s, loss=0.7583, mse=0.7570, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.19it/s, loss=0.7583, mse=0.7570, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.19it/s, loss=0.7567, mse=0.7554, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.81it/s, loss=0.7567, mse=0.7554, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.81it/s, loss=0.7699, mse=0.7686, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.39it/s, loss=0.7699, mse=0.7686, lpips=0.0026][A
Epoch 40/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  3.39it/s, loss=0.7749, mse=0.7736, lpips=0.0026][A
Epoch 40/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  4.10it/s, loss=0.7749, mse=0.7736, lpips=0.0026][AEpoch 40/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.10it/s, loss=0.7749, mse=0.7736, lpips=0.0026]

Epoch 40/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 39/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.8470]

Epoch 40/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7825][A
Epoch 40/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7199][AEpoch 40 | Avg Train Loss: 0.7669 | Avg Val Loss: 0.7512
New best validation loss: 0.7512. Saving best model...
Saving interval checkpoint for epoch 40...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -202.1239, Max: 211.5484
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_40.png
Epoch 41/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 41/1000 [TRAIN]:   0%|          | 0/10 [00:08<?, ?it/s, loss=0.7675, mse=0.7662, lpips=0.0026]Epoch 41/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:19,  8.89s/it, loss=0.7675, mse=0.7662, lpips=0.0026]Epoch 41/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:19,  8.89s/it, loss=0.7974, mse=0.7961, lpips=0.0027]Epoch 41/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:30,  3.87s/it, loss=0.7974, mse=0.7961, lpips=0.0027]Epoch 41/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:30,  3.87s/it, loss=0.7628, mse=0.7615, lpips=0.0026]Epoch 41/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:30,  3.87s/it, loss=0.7646, mse=0.7633, lpips=0.0026]Epoch 41/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.50s/it, loss=0.7646, mse=0.7633, lpips=0.0026]Epoch 41/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.50s/it, loss=0.7623, mse=0.7611, lpips=0.0026]Epoch 41/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.50s/it, loss=0.7469, mse=0.7456, lpips=0.0026]Epoch 41/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.20it/s, loss=0.7469, mse=0.7456, lpips=0.0026]Epoch 41/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.20it/s, loss=0.7452, mse=0.7439, lpips=0.0026]Epoch 41/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.20it/s, loss=0.7573, mse=0.7560, lpips=0.0026]Epoch 41/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.88it/s, loss=0.7573, mse=0.7560, lpips=0.0026]Epoch 41/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.88it/s, loss=0.7602, mse=0.7589, lpips=0.0026]Epoch 41/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.88it/s, loss=0.7797, mse=0.7784, lpips=0.0026]Epoch 41/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  2.74it/s, loss=0.7797, mse=0.7784, lpips=0.0026]Epoch 41/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.01it/s, loss=0.7797, mse=0.7784, lpips=0.0026]
Epoch 41/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 40/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.7199]
Epoch 41/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7781]Epoch 41/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7839]Epoch 41 | Avg Train Loss: 0.7644 | Avg Val Loss: 0.7810

Epoch 42/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 42/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.7651, mse=0.7638, lpips=0.0026][A
Epoch 42/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.25s/it, loss=0.7651, mse=0.7638, lpips=0.0026][A
Epoch 42/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.25s/it, loss=0.7329, mse=0.7316, lpips=0.0025][A
Epoch 42/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.65it/s, loss=0.7329, mse=0.7316, lpips=0.0025][A
Epoch 42/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.65it/s, loss=0.7515, mse=0.7502, lpips=0.0026][A
Epoch 42/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.65it/s, loss=0.7553, mse=0.7540, lpips=0.0026][A
Epoch 42/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.52it/s, loss=0.7553, mse=0.7540, lpips=0.0026][A
Epoch 42/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.52it/s, loss=0.7553, mse=0.7540, lpips=0.0026][A
Epoch 42/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.52it/s, loss=0.7585, mse=0.7572, lpips=0.0026][A
Epoch 42/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.27it/s, loss=0.7585, mse=0.7572, lpips=0.0026][A
Epoch 42/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.27it/s, loss=0.7554, mse=0.7541, lpips=0.0026][A
Epoch 42/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.27it/s, loss=0.7844, mse=0.7831, lpips=0.0026][A
Epoch 42/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.59it/s, loss=0.7844, mse=0.7831, lpips=0.0026][A
Epoch 42/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  6.59it/s, loss=0.7378, mse=0.7365, lpips=0.0025][A
Epoch 42/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  6.59it/s, loss=0.7419, mse=0.7406, lpips=0.0025][A
Epoch 42/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  7.96it/s, loss=0.7419, mse=0.7406, lpips=0.0025][AEpoch 42/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.74it/s, loss=0.7419, mse=0.7406, lpips=0.0025]

Epoch 42/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 41/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.7839]

Epoch 42/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7725][A
Epoch 42/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7450][AEpoch 42 | Avg Train Loss: 0.7538 | Avg Val Loss: 0.7588
Epoch 43/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 43/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.7450, mse=0.7437, lpips=0.0025]Epoch 43/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.09s/it, loss=0.7450, mse=0.7437, lpips=0.0025]Epoch 43/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.09s/it, loss=0.7563, mse=0.7550, lpips=0.0026]Epoch 43/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.09s/it, loss=0.7499, mse=0.7486, lpips=0.0026]Epoch 43/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.89it/s, loss=0.7499, mse=0.7486, lpips=0.0026]Epoch 43/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.89it/s, loss=0.7490, mse=0.7477, lpips=0.0026]Epoch 43/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.89it/s, loss=0.7545, mse=0.7532, lpips=0.0026]Epoch 43/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.72it/s, loss=0.7545, mse=0.7532, lpips=0.0026]Epoch 43/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.72it/s, loss=0.7469, mse=0.7456, lpips=0.0025]Epoch 43/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.48it/s, loss=0.7469, mse=0.7456, lpips=0.0025]Epoch 43/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.48it/s, loss=0.7532, mse=0.7519, lpips=0.0026]Epoch 43/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.89it/s, loss=0.7532, mse=0.7519, lpips=0.0026]Epoch 43/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.89it/s, loss=0.7398, mse=0.7385, lpips=0.0025]Epoch 43/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  5.94it/s, loss=0.7398, mse=0.7385, lpips=0.0025]Epoch 43/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.94it/s, loss=0.7483, mse=0.7470, lpips=0.0025]Epoch 43/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.87it/s, loss=0.7483, mse=0.7470, lpips=0.0025]Epoch 43/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.87it/s, loss=0.7893, mse=0.7879, lpips=0.0026]Epoch 43/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  5.80it/s, loss=0.7893, mse=0.7879, lpips=0.0026]Epoch 43/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.57it/s, loss=0.7893, mse=0.7879, lpips=0.0026]
Epoch 43/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 42/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.7450]
Epoch 43/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7347]Epoch 43/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7527]Epoch 43 | Avg Train Loss: 0.7532 | Avg Val Loss: 0.7437
New best validation loss: 0.7437. Saving best model...

Epoch 44/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 44/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.7351, mse=0.7339, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.52s/it, loss=0.7351, mse=0.7339, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.52s/it, loss=0.7497, mse=0.7485, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.18s/it, loss=0.7497, mse=0.7485, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.18s/it, loss=0.7391, mse=0.7379, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.80s/it, loss=0.7391, mse=0.7379, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.80s/it, loss=0.7485, mse=0.7472, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.21s/it, loss=0.7485, mse=0.7472, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.21s/it, loss=0.7140, mse=0.7127, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.7140, mse=0.7127, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.7381, mse=0.7368, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.71it/s, loss=0.7381, mse=0.7368, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.71it/s, loss=0.7197, mse=0.7184, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.26it/s, loss=0.7197, mse=0.7184, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.26it/s, loss=0.7395, mse=0.7383, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.83it/s, loss=0.7395, mse=0.7383, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.83it/s, loss=0.7327, mse=0.7315, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.31it/s, loss=0.7327, mse=0.7315, lpips=0.0025][A
Epoch 44/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.31it/s, loss=0.7481, mse=0.7469, lpips=0.0025][A
Epoch 44/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  4.14it/s, loss=0.7481, mse=0.7469, lpips=0.0025][AEpoch 44/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.11it/s, loss=0.7481, mse=0.7469, lpips=0.0025]

Epoch 44/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 43/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.7527]

Epoch 44/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7338][A
Epoch 44/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7474][AEpoch 44 | Avg Train Loss: 0.7365 | Avg Val Loss: 0.7406
New best validation loss: 0.7406. Saving best model...
Epoch 45/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 45/1000 [TRAIN]:   0%|          | 0/10 [00:06<?, ?it/s, loss=0.7412, mse=0.7399, lpips=0.0025]Epoch 45/1000 [TRAIN]:  10%|█         | 1/10 [00:06<01:01,  6.82s/it, loss=0.7412, mse=0.7399, lpips=0.0025]Epoch 45/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:01,  6.82s/it, loss=0.7508, mse=0.7496, lpips=0.0025]Epoch 45/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.03s/it, loss=0.7508, mse=0.7496, lpips=0.0025]Epoch 45/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.03s/it, loss=0.7386, mse=0.7374, lpips=0.0025]Epoch 45/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.74s/it, loss=0.7386, mse=0.7374, lpips=0.0025]Epoch 45/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.74s/it, loss=0.7542, mse=0.7530, lpips=0.0025]Epoch 45/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.11s/it, loss=0.7542, mse=0.7530, lpips=0.0025]Epoch 45/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.11s/it, loss=0.7273, mse=0.7260, lpips=0.0025]Epoch 45/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.29it/s, loss=0.7273, mse=0.7260, lpips=0.0025]Epoch 45/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.29it/s, loss=0.7538, mse=0.7525, lpips=0.0025]Epoch 45/1000 [TRAIN]:  60%|██████    | 6/10 [00:07<00:02,  1.77it/s, loss=0.7538, mse=0.7525, lpips=0.0025]Epoch 45/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.77it/s, loss=0.7366, mse=0.7353, lpips=0.0025]Epoch 45/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.27it/s, loss=0.7366, mse=0.7353, lpips=0.0025]Epoch 45/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.27it/s, loss=0.7429, mse=0.7416, lpips=0.0025]Epoch 45/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.89it/s, loss=0.7429, mse=0.7416, lpips=0.0025]Epoch 45/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.89it/s, loss=0.7435, mse=0.7422, lpips=0.0025]Epoch 45/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.46it/s, loss=0.7435, mse=0.7422, lpips=0.0025]Epoch 45/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.46it/s, loss=0.7430, mse=0.7417, lpips=0.0025]Epoch 45/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  4.18it/s, loss=0.7430, mse=0.7417, lpips=0.0025]Epoch 45/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.18it/s, loss=0.7430, mse=0.7417, lpips=0.0025]
Epoch 45/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 44/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.7474]
Epoch 45/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7441]Epoch 45/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6465]Epoch 45 | Avg Train Loss: 0.7432 | Avg Val Loss: 0.6953
New best validation loss: 0.6953. Saving best model...
Saving interval checkpoint for epoch 45...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -221.3161, Max: 226.9565
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_45.png

Epoch 46/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 46/1000 [TRAIN]:   0%|          | 0/10 [00:08<?, ?it/s, loss=0.7486, mse=0.7474, lpips=0.0025][A
Epoch 46/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:20,  8.92s/it, loss=0.7486, mse=0.7474, lpips=0.0025][A
Epoch 46/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:20,  8.92s/it, loss=0.7482, mse=0.7469, lpips=0.0025][A
Epoch 46/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:29,  3.74s/it, loss=0.7482, mse=0.7469, lpips=0.0025][A
Epoch 46/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:29,  3.74s/it, loss=0.7316, mse=0.7304, lpips=0.0025][A
Epoch 46/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:29,  3.74s/it, loss=0.7286, mse=0.7273, lpips=0.0025][A
Epoch 46/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.46s/it, loss=0.7286, mse=0.7273, lpips=0.0025][A
Epoch 46/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.46s/it, loss=0.7450, mse=0.7438, lpips=0.0025][A
Epoch 46/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.46s/it, loss=0.7360, mse=0.7348, lpips=0.0025][A
Epoch 46/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.24it/s, loss=0.7360, mse=0.7348, lpips=0.0025][A
Epoch 46/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.24it/s, loss=0.7597, mse=0.7584, lpips=0.0025][A
Epoch 46/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.24it/s, loss=0.7252, mse=0.7240, lpips=0.0025][A
Epoch 46/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.93it/s, loss=0.7252, mse=0.7240, lpips=0.0025][A
Epoch 46/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.93it/s, loss=0.7189, mse=0.7177, lpips=0.0025][A
Epoch 46/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.93it/s, loss=0.7296, mse=0.7284, lpips=0.0025][A
Epoch 46/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  2.80it/s, loss=0.7296, mse=0.7284, lpips=0.0025][AEpoch 46/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.03it/s, loss=0.7296, mse=0.7284, lpips=0.0025]

Epoch 46/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 45/1000 [VAL]:   0%|          | 0/2 [00:14<?, ?it/s, loss=0.6465]

Epoch 46/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7166][A
Epoch 46/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7025][AEpoch 46 | Avg Train Loss: 0.7371 | Avg Val Loss: 0.7096
Epoch 47/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 47/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.7110, mse=0.7097, lpips=0.0024]Epoch 47/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.09s/it, loss=0.7110, mse=0.7097, lpips=0.0024]Epoch 47/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.09s/it, loss=0.7390, mse=0.7378, lpips=0.0025]Epoch 47/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.97it/s, loss=0.7390, mse=0.7378, lpips=0.0025]Epoch 47/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.97it/s, loss=0.7198, mse=0.7186, lpips=0.0024]Epoch 47/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.97it/s, loss=0.7127, mse=0.7115, lpips=0.0024]Epoch 47/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.03it/s, loss=0.7127, mse=0.7115, lpips=0.0024]Epoch 47/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.03it/s, loss=0.7297, mse=0.7285, lpips=0.0025]Epoch 47/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.03it/s, loss=0.7477, mse=0.7465, lpips=0.0025]Epoch 47/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.82it/s, loss=0.7477, mse=0.7465, lpips=0.0025]Epoch 47/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.82it/s, loss=0.7099, mse=0.7087, lpips=0.0024]Epoch 47/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.82it/s, loss=0.6983, mse=0.6971, lpips=0.0024]Epoch 47/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.15it/s, loss=0.6983, mse=0.6971, lpips=0.0024]Epoch 47/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.15it/s, loss=0.7231, mse=0.7218, lpips=0.0025]Epoch 47/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.15it/s, loss=0.6849, mse=0.6838, lpips=0.0024]Epoch 47/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  8.67it/s, loss=0.6849, mse=0.6838, lpips=0.0024]Epoch 47/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.32it/s, loss=0.6849, mse=0.6838, lpips=0.0024]
Epoch 47/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 46/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.7025]
Epoch 47/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7451]Epoch 47/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6489]Epoch 47 | Avg Train Loss: 0.7176 | Avg Val Loss: 0.6970

Epoch 48/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 48/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.7298, mse=0.7286, lpips=0.0025][A
Epoch 48/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.02s/it, loss=0.7298, mse=0.7286, lpips=0.0025][A
Epoch 48/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.02s/it, loss=0.7064, mse=0.7052, lpips=0.0024][A
Epoch 48/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.02s/it, loss=0.7269, mse=0.7257, lpips=0.0025][A
Epoch 48/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.06it/s, loss=0.7269, mse=0.7257, lpips=0.0025][A
Epoch 48/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.06it/s, loss=0.7218, mse=0.7206, lpips=0.0024][A
Epoch 48/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.06it/s, loss=0.7150, mse=0.7138, lpips=0.0024][A
Epoch 48/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.87it/s, loss=0.7150, mse=0.7138, lpips=0.0024][A
Epoch 48/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.87it/s, loss=0.7159, mse=0.7147, lpips=0.0024][A
Epoch 48/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.87it/s, loss=0.7302, mse=0.7290, lpips=0.0025][A
Epoch 48/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.40it/s, loss=0.7302, mse=0.7290, lpips=0.0025][A
Epoch 48/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.40it/s, loss=0.7258, mse=0.7246, lpips=0.0024][A
Epoch 48/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.40it/s, loss=0.7248, mse=0.7236, lpips=0.0024][A
Epoch 48/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.61it/s, loss=0.7248, mse=0.7236, lpips=0.0024][A
Epoch 48/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.61it/s, loss=0.7490, mse=0.7478, lpips=0.0025][AEpoch 48/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.55it/s, loss=0.7490, mse=0.7478, lpips=0.0025]

Epoch 48/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 47/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6489]

Epoch 48/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7084][A
Epoch 48/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6884][AEpoch 48 | Avg Train Loss: 0.7246 | Avg Val Loss: 0.6984
Epoch 49/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 49/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.7172, mse=0.7160, lpips=0.0024]Epoch 49/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:06,  1.35it/s, loss=0.7172, mse=0.7160, lpips=0.0024]Epoch 49/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:06,  1.35it/s, loss=0.7170, mse=0.7158, lpips=0.0024]Epoch 49/1000 [TRAIN]:  20%|██        | 2/10 [00:00<00:03,  2.26it/s, loss=0.7170, mse=0.7158, lpips=0.0024]Epoch 49/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.26it/s, loss=0.7015, mse=0.7003, lpips=0.0024]Epoch 49/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.26it/s, loss=0.7251, mse=0.7239, lpips=0.0024]Epoch 49/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.58it/s, loss=0.7251, mse=0.7239, lpips=0.0024]Epoch 49/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.58it/s, loss=0.7194, mse=0.7182, lpips=0.0024]Epoch 49/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.58it/s, loss=0.7199, mse=0.7187, lpips=0.0024]Epoch 49/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  6.39it/s, loss=0.7199, mse=0.7187, lpips=0.0024]Epoch 49/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  6.39it/s, loss=0.7022, mse=0.7010, lpips=0.0024]Epoch 49/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  6.39it/s, loss=0.7159, mse=0.7147, lpips=0.0024]Epoch 49/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.70it/s, loss=0.7159, mse=0.7147, lpips=0.0024]Epoch 49/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.70it/s, loss=0.7149, mse=0.7137, lpips=0.0024]Epoch 49/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.70it/s, loss=0.7173, mse=0.7161, lpips=0.0024]Epoch 49/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  8.26it/s, loss=0.7173, mse=0.7161, lpips=0.0024]Epoch 49/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.84it/s, loss=0.7173, mse=0.7161, lpips=0.0024]
Epoch 49/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 48/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6884]
Epoch 49/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7036]Epoch 49/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6669]Epoch 49 | Avg Train Loss: 0.7150 | Avg Val Loss: 0.6852
New best validation loss: 0.6852. Saving best model...

Epoch 50/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 50/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.6864, mse=0.6852, lpips=0.0024][A
Epoch 50/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.15s/it, loss=0.6864, mse=0.6852, lpips=0.0024][A
Epoch 50/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.15s/it, loss=0.6886, mse=0.6874, lpips=0.0024][A
Epoch 50/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.15s/it, loss=0.7085, mse=0.7073, lpips=0.0024][A
Epoch 50/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.76it/s, loss=0.7085, mse=0.7073, lpips=0.0024][A
Epoch 50/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.76it/s, loss=0.7109, mse=0.7097, lpips=0.0024][A
Epoch 50/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.76it/s, loss=0.7182, mse=0.7170, lpips=0.0024][A
Epoch 50/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.45it/s, loss=0.7182, mse=0.7170, lpips=0.0024][A
Epoch 50/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.45it/s, loss=0.7105, mse=0.7093, lpips=0.0024][A
Epoch 50/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.45it/s, loss=0.7012, mse=0.7000, lpips=0.0024][A
Epoch 50/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.01it/s, loss=0.7012, mse=0.7000, lpips=0.0024][A
Epoch 50/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.01it/s, loss=0.6952, mse=0.6940, lpips=0.0024][A
Epoch 50/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.01it/s, loss=0.7006, mse=0.6994, lpips=0.0024][A
Epoch 50/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.29it/s, loss=0.7006, mse=0.6994, lpips=0.0024][A
Epoch 50/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.29it/s, loss=0.7291, mse=0.7279, lpips=0.0024][AEpoch 50/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.20it/s, loss=0.7291, mse=0.7279, lpips=0.0024]

Epoch 50/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 49/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6669]

Epoch 50/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7021][A
Epoch 50/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7628][AEpoch 50 | Avg Train Loss: 0.7049 | Avg Val Loss: 0.7325
Saving interval checkpoint for epoch 50...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -212.9792, Max: 194.6255
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_50.png
Epoch 51/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 51/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.6854, mse=0.6842, lpips=0.0023]Epoch 51/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:24,  9.40s/it, loss=0.6854, mse=0.6842, lpips=0.0023]Epoch 51/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:24,  9.40s/it, loss=0.6992, mse=0.6980, lpips=0.0024]Epoch 51/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:33,  4.20s/it, loss=0.6992, mse=0.6980, lpips=0.0024]Epoch 51/1000 [TRAIN]:  20%|██        | 2/10 [00:10<00:33,  4.20s/it, loss=0.6949, mse=0.6938, lpips=0.0024]Epoch 51/1000 [TRAIN]:  30%|███       | 3/10 [00:10<00:16,  2.35s/it, loss=0.6949, mse=0.6938, lpips=0.0024]Epoch 51/1000 [TRAIN]:  30%|███       | 3/10 [00:10<00:16,  2.35s/it, loss=0.7156, mse=0.7144, lpips=0.0024]Epoch 51/1000 [TRAIN]:  40%|████      | 4/10 [00:10<00:08,  1.49s/it, loss=0.7156, mse=0.7144, lpips=0.0024]Epoch 51/1000 [TRAIN]:  40%|████      | 4/10 [00:10<00:08,  1.49s/it, loss=0.6968, mse=0.6956, lpips=0.0024]Epoch 51/1000 [TRAIN]:  50%|█████     | 5/10 [00:10<00:05,  1.01s/it, loss=0.6968, mse=0.6956, lpips=0.0024]Epoch 51/1000 [TRAIN]:  50%|█████     | 5/10 [00:10<00:05,  1.01s/it, loss=0.6921, mse=0.6909, lpips=0.0024]Epoch 51/1000 [TRAIN]:  60%|██████    | 6/10 [00:10<00:02,  1.38it/s, loss=0.6921, mse=0.6909, lpips=0.0024]Epoch 51/1000 [TRAIN]:  60%|██████    | 6/10 [00:10<00:02,  1.38it/s, loss=0.7008, mse=0.6996, lpips=0.0024]Epoch 51/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:01,  1.85it/s, loss=0.7008, mse=0.6996, lpips=0.0024]Epoch 51/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:01,  1.85it/s, loss=0.7040, mse=0.7028, lpips=0.0024]Epoch 51/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:00,  2.38it/s, loss=0.7040, mse=0.7028, lpips=0.0024]Epoch 51/1000 [TRAIN]:  80%|████████  | 8/10 [00:11<00:00,  2.38it/s, loss=0.6818, mse=0.6807, lpips=0.0023]Epoch 51/1000 [TRAIN]:  90%|█████████ | 9/10 [00:11<00:00,  2.94it/s, loss=0.6818, mse=0.6807, lpips=0.0023]Epoch 51/1000 [TRAIN]:  90%|█████████ | 9/10 [00:11<00:00,  2.94it/s, loss=0.7135, mse=0.7123, lpips=0.0024]Epoch 51/1000 [TRAIN]: 100%|██████████| 10/10 [00:11<00:00,  3.55it/s, loss=0.7135, mse=0.7123, lpips=0.0024]Epoch 51/1000 [TRAIN]: 100%|██████████| 10/10 [00:11<00:00,  1.12s/it, loss=0.7135, mse=0.7123, lpips=0.0024]
Epoch 51/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 50/1000 [VAL]:   0%|          | 0/2 [00:13<?, ?it/s, loss=0.7628]
Epoch 51/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6997]Epoch 51/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6689]Epoch 51 | Avg Train Loss: 0.6984 | Avg Val Loss: 0.6843
New best validation loss: 0.6843. Saving best model...

Epoch 52/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 52/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.6829, mse=0.6817, lpips=0.0023][A
Epoch 52/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.71s/it, loss=0.6829, mse=0.6817, lpips=0.0023][A
Epoch 52/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.71s/it, loss=0.6823, mse=0.6811, lpips=0.0023][A
Epoch 52/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:26,  3.31s/it, loss=0.6823, mse=0.6811, lpips=0.0023][A
Epoch 52/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:26,  3.31s/it, loss=0.7032, mse=0.7021, lpips=0.0024][A
Epoch 52/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:26,  3.31s/it, loss=0.6939, mse=0.6927, lpips=0.0024][A
Epoch 52/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.29s/it, loss=0.6939, mse=0.6927, lpips=0.0024][A
Epoch 52/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.29s/it, loss=0.6806, mse=0.6794, lpips=0.0023][A
Epoch 52/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.29s/it, loss=0.6931, mse=0.6919, lpips=0.0023][A
Epoch 52/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.38it/s, loss=0.6931, mse=0.6919, lpips=0.0023][A
Epoch 52/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.38it/s, loss=0.6892, mse=0.6880, lpips=0.0023][A
Epoch 52/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.38it/s, loss=0.7099, mse=0.7087, lpips=0.0024][A
Epoch 52/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.12it/s, loss=0.7099, mse=0.7087, lpips=0.0024][A
Epoch 52/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.12it/s, loss=0.6896, mse=0.6884, lpips=0.0023][A
Epoch 52/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.12it/s, loss=0.7009, mse=0.6997, lpips=0.0024][A
Epoch 52/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  3.06it/s, loss=0.7009, mse=0.6997, lpips=0.0024][AEpoch 52/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.16it/s, loss=0.7009, mse=0.6997, lpips=0.0024]

Epoch 52/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 51/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.6689]

Epoch 52/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6814][A
Epoch 52/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6301][AEpoch 52 | Avg Train Loss: 0.6925 | Avg Val Loss: 0.6557
New best validation loss: 0.6557. Saving best model...
Epoch 53/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 53/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.6963, mse=0.6951, lpips=0.0024]Epoch 53/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.19s/it, loss=0.6963, mse=0.6951, lpips=0.0024]Epoch 53/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.19s/it, loss=0.6872, mse=0.6860, lpips=0.0023]Epoch 53/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.19s/it, loss=0.7109, mse=0.7097, lpips=0.0024]Epoch 53/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.69it/s, loss=0.7109, mse=0.7097, lpips=0.0024]Epoch 53/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.69it/s, loss=0.6664, mse=0.6653, lpips=0.0023]Epoch 53/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.69it/s, loss=0.7230, mse=0.7218, lpips=0.0024]Epoch 53/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.40it/s, loss=0.7230, mse=0.7218, lpips=0.0024]Epoch 53/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.40it/s, loss=0.6637, mse=0.6626, lpips=0.0023]Epoch 53/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.40it/s, loss=0.6912, mse=0.6901, lpips=0.0023]Epoch 53/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.92it/s, loss=0.6912, mse=0.6901, lpips=0.0023]Epoch 53/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.92it/s, loss=0.7023, mse=0.7011, lpips=0.0024]Epoch 53/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.92it/s, loss=0.6840, mse=0.6829, lpips=0.0023]Epoch 53/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.20it/s, loss=0.6840, mse=0.6829, lpips=0.0023]Epoch 53/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.20it/s, loss=0.7185, mse=0.7173, lpips=0.0024]Epoch 53/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.10it/s, loss=0.7185, mse=0.7173, lpips=0.0024]
Epoch 53/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 52/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6301]
Epoch 53/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7051]Epoch 53/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7278]Epoch 53 | Avg Train Loss: 0.6944 | Avg Val Loss: 0.7164

Epoch 54/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 54/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.7201, mse=0.7189, lpips=0.0024][A
Epoch 54/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.7201, mse=0.7189, lpips=0.0024][A
Epoch 54/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.6759, mse=0.6747, lpips=0.0023][A
Epoch 54/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.6851, mse=0.6839, lpips=0.0023][A
Epoch 54/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.6851, mse=0.6839, lpips=0.0023][A
Epoch 54/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.6993, mse=0.6981, lpips=0.0023][A
Epoch 54/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.6792, mse=0.6780, lpips=0.0023][A
Epoch 54/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.59it/s, loss=0.6792, mse=0.6780, lpips=0.0023][A
Epoch 54/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.59it/s, loss=0.6795, mse=0.6784, lpips=0.0023][A
Epoch 54/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.59it/s, loss=0.6835, mse=0.6823, lpips=0.0023][A
Epoch 54/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.11it/s, loss=0.6835, mse=0.6823, lpips=0.0023][A
Epoch 54/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.11it/s, loss=0.6888, mse=0.6877, lpips=0.0023][A
Epoch 54/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.11it/s, loss=0.6807, mse=0.6795, lpips=0.0023][A
Epoch 54/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.36it/s, loss=0.6807, mse=0.6795, lpips=0.0023][A
Epoch 54/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.36it/s, loss=0.6784, mse=0.6772, lpips=0.0023][AEpoch 54/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.31it/s, loss=0.6784, mse=0.6772, lpips=0.0023]

Epoch 54/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 53/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.7278]

Epoch 54/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7056][A
Epoch 54/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7049][AEpoch 54 | Avg Train Loss: 0.6870 | Avg Val Loss: 0.7052
Epoch 55/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 55/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.6739, mse=0.6727, lpips=0.0023]Epoch 55/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.13s/it, loss=0.6739, mse=0.6727, lpips=0.0023]Epoch 55/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.13s/it, loss=0.6684, mse=0.6672, lpips=0.0023]Epoch 55/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.13s/it, loss=0.6926, mse=0.6915, lpips=0.0023]Epoch 55/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.81it/s, loss=0.6926, mse=0.6915, lpips=0.0023]Epoch 55/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.81it/s, loss=0.6742, mse=0.6731, lpips=0.0023]Epoch 55/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.68it/s, loss=0.6742, mse=0.6731, lpips=0.0023]Epoch 55/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.68it/s, loss=0.7000, mse=0.6989, lpips=0.0023]Epoch 55/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.68it/s, loss=0.6933, mse=0.6922, lpips=0.0023]Epoch 55/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.58it/s, loss=0.6933, mse=0.6922, lpips=0.0023]Epoch 55/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.58it/s, loss=0.7078, mse=0.7066, lpips=0.0024]Epoch 55/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.58it/s, loss=0.6664, mse=0.6652, lpips=0.0023]Epoch 55/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.39it/s, loss=0.6664, mse=0.6652, lpips=0.0023]Epoch 55/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.39it/s, loss=0.6922, mse=0.6910, lpips=0.0023]Epoch 55/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  6.29it/s, loss=0.6922, mse=0.6910, lpips=0.0023]Epoch 55/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  6.29it/s, loss=0.6897, mse=0.6886, lpips=0.0023]Epoch 55/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.59it/s, loss=0.6897, mse=0.6886, lpips=0.0023]Epoch 55/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.70it/s, loss=0.6897, mse=0.6886, lpips=0.0023]
Epoch 55/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 54/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.7049]
Epoch 55/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6748]Epoch 55/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5378]Epoch 55 | Avg Train Loss: 0.6858 | Avg Val Loss: 0.6063
New best validation loss: 0.6063. Saving best model...
Saving interval checkpoint for epoch 55...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -213.4323, Max: 196.7965
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_55.png

Epoch 56/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 56/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.6832, mse=0.6821, lpips=0.0023][A
Epoch 56/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:22,  9.21s/it, loss=0.6832, mse=0.6821, lpips=0.0023][A
Epoch 56/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:22,  9.21s/it, loss=0.6580, mse=0.6569, lpips=0.0022][A
Epoch 56/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.89s/it, loss=0.6580, mse=0.6569, lpips=0.0022][A
Epoch 56/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.89s/it, loss=0.6404, mse=0.6394, lpips=0.0022][A
Epoch 56/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:15,  2.19s/it, loss=0.6404, mse=0.6394, lpips=0.0022][A
Epoch 56/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:15,  2.19s/it, loss=0.6640, mse=0.6629, lpips=0.0023][A
Epoch 56/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.38s/it, loss=0.6640, mse=0.6629, lpips=0.0023][A
Epoch 56/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.38s/it, loss=0.6987, mse=0.6976, lpips=0.0023][A
Epoch 56/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:04,  1.05it/s, loss=0.6987, mse=0.6976, lpips=0.0023][A
Epoch 56/1000 [TRAIN]:  50%|█████     | 5/10 [00:10<00:04,  1.05it/s, loss=0.6815, mse=0.6804, lpips=0.0023][A
Epoch 56/1000 [TRAIN]:  60%|██████    | 6/10 [00:10<00:02,  1.47it/s, loss=0.6815, mse=0.6804, lpips=0.0023][A
Epoch 56/1000 [TRAIN]:  60%|██████    | 6/10 [00:10<00:02,  1.47it/s, loss=0.6869, mse=0.6858, lpips=0.0023][A
Epoch 56/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:01,  1.94it/s, loss=0.6869, mse=0.6858, lpips=0.0023][A
Epoch 56/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:01,  1.94it/s, loss=0.6940, mse=0.6929, lpips=0.0023][A
Epoch 56/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:00,  2.53it/s, loss=0.6940, mse=0.6929, lpips=0.0023][A
Epoch 56/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:00,  2.53it/s, loss=0.7018, mse=0.7006, lpips=0.0023][A
Epoch 56/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  3.10it/s, loss=0.7018, mse=0.7006, lpips=0.0023][A
Epoch 56/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  3.10it/s, loss=0.7052, mse=0.7040, lpips=0.0023][A
Epoch 56/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  3.81it/s, loss=0.7052, mse=0.7040, lpips=0.0023][AEpoch 56/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.06s/it, loss=0.7052, mse=0.7040, lpips=0.0023]

Epoch 56/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 55/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.5378]

Epoch 56/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6608][A
Epoch 56/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6641][AEpoch 56 | Avg Train Loss: 0.6814 | Avg Val Loss: 0.6625
Epoch 57/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 57/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.6677, mse=0.6666, lpips=0.0022]Epoch 57/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.74s/it, loss=0.6677, mse=0.6666, lpips=0.0022]Epoch 57/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.74s/it, loss=0.6480, mse=0.6469, lpips=0.0022]Epoch 57/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:26,  3.27s/it, loss=0.6480, mse=0.6469, lpips=0.0022]Epoch 57/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:26,  3.27s/it, loss=0.6672, mse=0.6660, lpips=0.0022]Epoch 57/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:13,  1.87s/it, loss=0.6672, mse=0.6660, lpips=0.0022]Epoch 57/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:13,  1.87s/it, loss=0.6506, mse=0.6495, lpips=0.0022]Epoch 57/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.18s/it, loss=0.6506, mse=0.6495, lpips=0.0022]Epoch 57/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.18s/it, loss=0.6866, mse=0.6855, lpips=0.0023]Epoch 57/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.24it/s, loss=0.6866, mse=0.6855, lpips=0.0023]Epoch 57/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.24it/s, loss=0.6444, mse=0.6433, lpips=0.0022]Epoch 57/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.69it/s, loss=0.6444, mse=0.6433, lpips=0.0022]Epoch 57/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.69it/s, loss=0.6622, mse=0.6611, lpips=0.0022]Epoch 57/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.20it/s, loss=0.6622, mse=0.6611, lpips=0.0022]Epoch 57/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.20it/s, loss=0.7015, mse=0.7003, lpips=0.0023]Epoch 57/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.68it/s, loss=0.7015, mse=0.7003, lpips=0.0023]Epoch 57/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:00,  2.68it/s, loss=0.6289, mse=0.6278, lpips=0.0022]Epoch 57/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  3.44it/s, loss=0.6289, mse=0.6278, lpips=0.0022]Epoch 57/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  3.44it/s, loss=0.6989, mse=0.6978, lpips=0.0023]Epoch 57/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  4.07it/s, loss=0.6989, mse=0.6978, lpips=0.0023]Epoch 57/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.09it/s, loss=0.6989, mse=0.6978, lpips=0.0023]
Epoch 57/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 56/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.6641]
Epoch 57/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6674]Epoch 57/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6152]Epoch 57 | Avg Train Loss: 0.6656 | Avg Val Loss: 0.6413

Epoch 58/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 58/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.7087, mse=0.7075, lpips=0.0023][A
Epoch 58/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:06,  7.34s/it, loss=0.7087, mse=0.7075, lpips=0.0023][A
Epoch 58/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:06,  7.34s/it, loss=0.6665, mse=0.6654, lpips=0.0022][A
Epoch 58/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.14s/it, loss=0.6665, mse=0.6654, lpips=0.0022][A
Epoch 58/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.14s/it, loss=0.6884, mse=0.6873, lpips=0.0023][A
Epoch 58/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.77s/it, loss=0.6884, mse=0.6873, lpips=0.0023][A
Epoch 58/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.77s/it, loss=0.6727, mse=0.6715, lpips=0.0023][A
Epoch 58/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.14s/it, loss=0.6727, mse=0.6715, lpips=0.0023][A
Epoch 58/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:06,  1.14s/it, loss=0.6672, mse=0.6661, lpips=0.0022][A
Epoch 58/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.26it/s, loss=0.6672, mse=0.6661, lpips=0.0022][A
Epoch 58/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.26it/s, loss=0.7059, mse=0.7048, lpips=0.0023][A
Epoch 58/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.73it/s, loss=0.7059, mse=0.7048, lpips=0.0023][A
Epoch 58/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.73it/s, loss=0.6409, mse=0.6398, lpips=0.0022][A
Epoch 58/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.31it/s, loss=0.6409, mse=0.6398, lpips=0.0022][A
Epoch 58/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.31it/s, loss=0.6661, mse=0.6650, lpips=0.0022][A
Epoch 58/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.88it/s, loss=0.6661, mse=0.6650, lpips=0.0022][A
Epoch 58/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.88it/s, loss=0.6513, mse=0.6502, lpips=0.0022][A
Epoch 58/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.43it/s, loss=0.6513, mse=0.6502, lpips=0.0022][A
Epoch 58/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.43it/s, loss=0.6337, mse=0.6326, lpips=0.0022][AEpoch 58/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.15it/s, loss=0.6337, mse=0.6326, lpips=0.0022]

Epoch 58/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 57/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.6152]

Epoch 58/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6431][A
Epoch 58/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7933][AEpoch 58 | Avg Train Loss: 0.6701 | Avg Val Loss: 0.7182
Epoch 59/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 59/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.6544, mse=0.6533, lpips=0.0022]Epoch 59/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:04,  7.13s/it, loss=0.6544, mse=0.6533, lpips=0.0022]Epoch 59/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:04,  7.13s/it, loss=0.6890, mse=0.6878, lpips=0.0023]Epoch 59/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.02s/it, loss=0.6890, mse=0.6878, lpips=0.0023]Epoch 59/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.02s/it, loss=0.6708, mse=0.6697, lpips=0.0022]Epoch 59/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.73s/it, loss=0.6708, mse=0.6697, lpips=0.0022]Epoch 59/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.73s/it, loss=0.6326, mse=0.6315, lpips=0.0022]Epoch 59/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.10s/it, loss=0.6326, mse=0.6315, lpips=0.0022]Epoch 59/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.10s/it, loss=0.6837, mse=0.6826, lpips=0.0023]Epoch 59/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.31it/s, loss=0.6837, mse=0.6826, lpips=0.0023]Epoch 59/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.31it/s, loss=0.6488, mse=0.6477, lpips=0.0022]Epoch 59/1000 [TRAIN]:  60%|██████    | 6/10 [00:07<00:02,  1.79it/s, loss=0.6488, mse=0.6477, lpips=0.0022]Epoch 59/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.79it/s, loss=0.6465, mse=0.6454, lpips=0.0022]Epoch 59/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.29it/s, loss=0.6465, mse=0.6454, lpips=0.0022]Epoch 59/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.29it/s, loss=0.6663, mse=0.6652, lpips=0.0022]Epoch 59/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.93it/s, loss=0.6663, mse=0.6652, lpips=0.0022]Epoch 59/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.93it/s, loss=0.6634, mse=0.6623, lpips=0.0022]Epoch 59/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.48it/s, loss=0.6634, mse=0.6623, lpips=0.0022]Epoch 59/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.48it/s, loss=0.7004, mse=0.6993, lpips=0.0023]Epoch 59/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  4.17it/s, loss=0.7004, mse=0.6993, lpips=0.0023]Epoch 59/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.17it/s, loss=0.7004, mse=0.6993, lpips=0.0023]
Epoch 59/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 58/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.7933]
Epoch 59/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6198]Epoch 59/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7176]Epoch 59 | Avg Train Loss: 0.6656 | Avg Val Loss: 0.6687

Epoch 60/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 60/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.7034, mse=0.7022, lpips=0.0023][A
Epoch 60/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.46s/it, loss=0.7034, mse=0.7022, lpips=0.0023][A
Epoch 60/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.46s/it, loss=0.6625, mse=0.6614, lpips=0.0022][A
Epoch 60/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.17s/it, loss=0.6625, mse=0.6614, lpips=0.0022][A
Epoch 60/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.17s/it, loss=0.6607, mse=0.6596, lpips=0.0022][A
Epoch 60/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.81s/it, loss=0.6607, mse=0.6596, lpips=0.0022][A
Epoch 60/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.81s/it, loss=0.6810, mse=0.6799, lpips=0.0023][A
Epoch 60/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.16s/it, loss=0.6810, mse=0.6799, lpips=0.0023][A
Epoch 60/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:06,  1.16s/it, loss=0.6393, mse=0.6382, lpips=0.0021][A
Epoch 60/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.27it/s, loss=0.6393, mse=0.6382, lpips=0.0021][A
Epoch 60/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.27it/s, loss=0.6511, mse=0.6500, lpips=0.0022][A
Epoch 60/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.27it/s, loss=0.6573, mse=0.6562, lpips=0.0022][A
Epoch 60/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.31it/s, loss=0.6573, mse=0.6562, lpips=0.0022][A
Epoch 60/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.31it/s, loss=0.6549, mse=0.6538, lpips=0.0022][A
Epoch 60/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.31it/s, loss=0.6423, mse=0.6412, lpips=0.0022][A
Epoch 60/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.44it/s, loss=0.6423, mse=0.6412, lpips=0.0022][A
Epoch 60/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.44it/s, loss=0.6788, mse=0.6776, lpips=0.0022][AEpoch 60/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.17it/s, loss=0.6788, mse=0.6776, lpips=0.0022]

Epoch 60/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 59/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.7176]

Epoch 60/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6450][A
Epoch 60/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7145][AEpoch 60 | Avg Train Loss: 0.6631 | Avg Val Loss: 0.6797
Saving interval checkpoint for epoch 60...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -197.0410, Max: 207.2292
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_60.png
Epoch 61/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 61/1000 [TRAIN]:   0%|          | 0/10 [00:08<?, ?it/s, loss=0.6254, mse=0.6244, lpips=0.0021]Epoch 61/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:16,  8.51s/it, loss=0.6254, mse=0.6244, lpips=0.0021]Epoch 61/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:16,  8.51s/it, loss=0.6345, mse=0.6334, lpips=0.0021]Epoch 61/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:29,  3.67s/it, loss=0.6345, mse=0.6334, lpips=0.0021]Epoch 61/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:29,  3.67s/it, loss=0.6502, mse=0.6491, lpips=0.0022]Epoch 61/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:29,  3.67s/it, loss=0.6365, mse=0.6355, lpips=0.0021]Epoch 61/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:08,  1.42s/it, loss=0.6365, mse=0.6355, lpips=0.0021]Epoch 61/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.42s/it, loss=0.6453, mse=0.6442, lpips=0.0022]Epoch 61/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.42s/it, loss=0.6316, mse=0.6306, lpips=0.0021]Epoch 61/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.26it/s, loss=0.6316, mse=0.6306, lpips=0.0021]Epoch 61/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.26it/s, loss=0.6463, mse=0.6452, lpips=0.0022]Epoch 61/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.26it/s, loss=0.6296, mse=0.6285, lpips=0.0021]Epoch 61/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.96it/s, loss=0.6296, mse=0.6285, lpips=0.0021]Epoch 61/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.96it/s, loss=0.6530, mse=0.6519, lpips=0.0022]Epoch 61/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.96it/s, loss=0.6505, mse=0.6494, lpips=0.0022]Epoch 61/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  2.84it/s, loss=0.6505, mse=0.6494, lpips=0.0022]Epoch 61/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.05it/s, loss=0.6505, mse=0.6494, lpips=0.0022]
Epoch 61/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 60/1000 [VAL]:   0%|          | 0/2 [00:14<?, ?it/s, loss=0.7145]
Epoch 61/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6664]Epoch 61/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6710]Epoch 61 | Avg Train Loss: 0.6403 | Avg Val Loss: 0.6687

Epoch 62/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 62/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.6701, mse=0.6690, lpips=0.0022][A
Epoch 62/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.11s/it, loss=0.6701, mse=0.6690, lpips=0.0022][A
Epoch 62/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.11s/it, loss=0.6129, mse=0.6119, lpips=0.0021][A
Epoch 62/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.11s/it, loss=0.6377, mse=0.6367, lpips=0.0021][A
Epoch 62/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.6377, mse=0.6367, lpips=0.0021][A
Epoch 62/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.6420, mse=0.6409, lpips=0.0022][A
Epoch 62/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.6719, mse=0.6708, lpips=0.0022][A
Epoch 62/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.61it/s, loss=0.6719, mse=0.6708, lpips=0.0022][A
Epoch 62/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.61it/s, loss=0.6271, mse=0.6260, lpips=0.0021][A
Epoch 62/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.61it/s, loss=0.6422, mse=0.6412, lpips=0.0021][A
Epoch 62/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.13it/s, loss=0.6422, mse=0.6412, lpips=0.0021][A
Epoch 62/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.13it/s, loss=0.6351, mse=0.6340, lpips=0.0021][A
Epoch 62/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.13it/s, loss=0.6555, mse=0.6544, lpips=0.0022][A
Epoch 62/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.44it/s, loss=0.6555, mse=0.6544, lpips=0.0022][A
Epoch 62/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.44it/s, loss=0.6625, mse=0.6614, lpips=0.0022][AEpoch 62/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.33it/s, loss=0.6625, mse=0.6614, lpips=0.0022]

Epoch 62/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 61/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6710]

Epoch 62/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6626][A
Epoch 62/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6277][AEpoch 62 | Avg Train Loss: 0.6457 | Avg Val Loss: 0.6451
Epoch 63/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 63/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.6572, mse=0.6561, lpips=0.0022]Epoch 63/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.00s/it, loss=0.6572, mse=0.6561, lpips=0.0022]Epoch 63/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.00s/it, loss=0.6735, mse=0.6724, lpips=0.0022]Epoch 63/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.96it/s, loss=0.6735, mse=0.6724, lpips=0.0022]Epoch 63/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.96it/s, loss=0.6471, mse=0.6460, lpips=0.0022]Epoch 63/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.63it/s, loss=0.6471, mse=0.6460, lpips=0.0022]Epoch 63/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.63it/s, loss=0.6527, mse=0.6516, lpips=0.0022]Epoch 63/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.36it/s, loss=0.6527, mse=0.6516, lpips=0.0022]Epoch 63/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.36it/s, loss=0.6409, mse=0.6399, lpips=0.0021]Epoch 63/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.01it/s, loss=0.6409, mse=0.6399, lpips=0.0021]Epoch 63/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.01it/s, loss=0.6518, mse=0.6507, lpips=0.0022]Epoch 63/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.56it/s, loss=0.6518, mse=0.6507, lpips=0.0022]Epoch 63/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.56it/s, loss=0.6409, mse=0.6398, lpips=0.0021]Epoch 63/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.93it/s, loss=0.6409, mse=0.6398, lpips=0.0021]Epoch 63/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.93it/s, loss=0.6324, mse=0.6313, lpips=0.0021]Epoch 63/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.25it/s, loss=0.6324, mse=0.6313, lpips=0.0021]Epoch 63/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.25it/s, loss=0.6647, mse=0.6636, lpips=0.0022]Epoch 63/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.23it/s, loss=0.6647, mse=0.6636, lpips=0.0022]Epoch 63/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.23it/s, loss=0.6959, mse=0.6948, lpips=0.0023]Epoch 63/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  5.84it/s, loss=0.6959, mse=0.6948, lpips=0.0023]Epoch 63/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  3.93it/s, loss=0.6959, mse=0.6948, lpips=0.0023]
Epoch 63/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 62/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6277]
Epoch 63/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6331]Epoch 63/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5902]Epoch 63 | Avg Train Loss: 0.6557 | Avg Val Loss: 0.6116

Epoch 64/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 64/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.6086, mse=0.6076, lpips=0.0021][A
Epoch 64/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.73s/it, loss=0.6086, mse=0.6076, lpips=0.0021][A
Epoch 64/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.73s/it, loss=0.6285, mse=0.6275, lpips=0.0021][A
Epoch 64/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:26,  3.29s/it, loss=0.6285, mse=0.6275, lpips=0.0021][A
Epoch 64/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:26,  3.29s/it, loss=0.6141, mse=0.6130, lpips=0.0021][A
Epoch 64/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.85s/it, loss=0.6141, mse=0.6130, lpips=0.0021][A
Epoch 64/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.85s/it, loss=0.6395, mse=0.6384, lpips=0.0021][A
Epoch 64/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.19s/it, loss=0.6395, mse=0.6384, lpips=0.0021][A
Epoch 64/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.19s/it, loss=0.6574, mse=0.6563, lpips=0.0022][A
Epoch 64/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.6574, mse=0.6563, lpips=0.0022][A
Epoch 64/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.6554, mse=0.6543, lpips=0.0022][A
Epoch 64/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.67it/s, loss=0.6554, mse=0.6543, lpips=0.0022][A
Epoch 64/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.67it/s, loss=0.6391, mse=0.6380, lpips=0.0021][A
Epoch 64/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.67it/s, loss=0.6250, mse=0.6239, lpips=0.0021][A
Epoch 64/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.88it/s, loss=0.6250, mse=0.6239, lpips=0.0021][A
Epoch 64/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.88it/s, loss=0.6230, mse=0.6219, lpips=0.0021][A
Epoch 64/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.88it/s, loss=0.6429, mse=0.6418, lpips=0.0021][A
Epoch 64/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  4.24it/s, loss=0.6429, mse=0.6418, lpips=0.0021][AEpoch 64/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.13it/s, loss=0.6429, mse=0.6418, lpips=0.0021]

Epoch 64/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 63/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.5902]

Epoch 64/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6565][A
Epoch 64/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5962][AEpoch 64 | Avg Train Loss: 0.6333 | Avg Val Loss: 0.6263
Epoch 65/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 65/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.6514, mse=0.6503, lpips=0.0021]Epoch 65/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.48s/it, loss=0.6514, mse=0.6503, lpips=0.0021]Epoch 65/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.48s/it, loss=0.6049, mse=0.6039, lpips=0.0020]Epoch 65/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.14s/it, loss=0.6049, mse=0.6039, lpips=0.0020]Epoch 65/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.14s/it, loss=0.6099, mse=0.6089, lpips=0.0020]Epoch 65/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.14s/it, loss=0.6464, mse=0.6454, lpips=0.0021]Epoch 65/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:07,  1.22s/it, loss=0.6464, mse=0.6454, lpips=0.0021]Epoch 65/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:07,  1.22s/it, loss=0.6398, mse=0.6387, lpips=0.0021]Epoch 65/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:07,  1.22s/it, loss=0.6644, mse=0.6633, lpips=0.0022]Epoch 65/1000 [TRAIN]:  60%|██████    | 6/10 [00:07<00:02,  1.45it/s, loss=0.6644, mse=0.6633, lpips=0.0022]Epoch 65/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.45it/s, loss=0.6172, mse=0.6162, lpips=0.0021]Epoch 65/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.45it/s, loss=0.6628, mse=0.6617, lpips=0.0022]Epoch 65/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.24it/s, loss=0.6628, mse=0.6617, lpips=0.0022]Epoch 65/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.24it/s, loss=0.6484, mse=0.6473, lpips=0.0021]Epoch 65/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.24it/s, loss=0.5974, mse=0.5964, lpips=0.0020]Epoch 65/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  3.22it/s, loss=0.5974, mse=0.5964, lpips=0.0020]Epoch 65/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.21it/s, loss=0.5974, mse=0.5964, lpips=0.0020]
Epoch 65/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 64/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.5962]
Epoch 65/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6458]Epoch 65/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6645]Epoch 65 | Avg Train Loss: 0.6343 | Avg Val Loss: 0.6551
Saving interval checkpoint for epoch 65...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -228.3128, Max: 216.6773
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_65.png

Epoch 66/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 66/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.6246, mse=0.6235, lpips=0.0021][A
Epoch 66/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.23s/it, loss=0.6246, mse=0.6235, lpips=0.0021][A
Epoch 66/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.23s/it, loss=0.6271, mse=0.6260, lpips=0.0021][A
Epoch 66/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.23s/it, loss=0.6501, mse=0.6491, lpips=0.0021][A
Epoch 66/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.46s/it, loss=0.6501, mse=0.6491, lpips=0.0021][A
Epoch 66/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.46s/it, loss=0.6263, mse=0.6253, lpips=0.0021][A
Epoch 66/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.46s/it, loss=0.6018, mse=0.6008, lpips=0.0020][A
Epoch 66/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.6018, mse=0.6008, lpips=0.0020][A
Epoch 66/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.6210, mse=0.6200, lpips=0.0021][A
Epoch 66/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.6242, mse=0.6232, lpips=0.0021][A
Epoch 66/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.33it/s, loss=0.6242, mse=0.6232, lpips=0.0021][A
Epoch 66/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.33it/s, loss=0.6253, mse=0.6243, lpips=0.0021][A
Epoch 66/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.33it/s, loss=0.6046, mse=0.6035, lpips=0.0020][A
Epoch 66/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  1.99it/s, loss=0.6046, mse=0.6035, lpips=0.0020][A
Epoch 66/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  1.99it/s, loss=0.6332, mse=0.6322, lpips=0.0021][AEpoch 66/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.00s/it, loss=0.6332, mse=0.6322, lpips=0.0021]

Epoch 66/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 65/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.6645]

Epoch 66/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6494][A
Epoch 66/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5074][AEpoch 66 | Avg Train Loss: 0.6238 | Avg Val Loss: 0.5784
New best validation loss: 0.5784. Saving best model...
Epoch 67/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 67/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.6266, mse=0.6255, lpips=0.0021]Epoch 67/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.07s/it, loss=0.6266, mse=0.6255, lpips=0.0021]Epoch 67/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.07s/it, loss=0.6056, mse=0.6045, lpips=0.0020]Epoch 67/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.86it/s, loss=0.6056, mse=0.6045, lpips=0.0020]Epoch 67/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.86it/s, loss=0.6178, mse=0.6168, lpips=0.0021]Epoch 67/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.86it/s, loss=0.6274, mse=0.6264, lpips=0.0021]Epoch 67/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.92it/s, loss=0.6274, mse=0.6264, lpips=0.0021]Epoch 67/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.92it/s, loss=0.5996, mse=0.5986, lpips=0.0020]Epoch 67/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.92it/s, loss=0.6291, mse=0.6281, lpips=0.0021]Epoch 67/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.73it/s, loss=0.6291, mse=0.6281, lpips=0.0021]Epoch 67/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.73it/s, loss=0.6131, mse=0.6121, lpips=0.0020]Epoch 67/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.73it/s, loss=0.6521, mse=0.6510, lpips=0.0021]Epoch 67/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.27it/s, loss=0.6521, mse=0.6510, lpips=0.0021]Epoch 67/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.27it/s, loss=0.6412, mse=0.6401, lpips=0.0021]Epoch 67/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.27it/s, loss=0.6776, mse=0.6765, lpips=0.0022]Epoch 67/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  8.60it/s, loss=0.6776, mse=0.6765, lpips=0.0022]Epoch 67/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.25it/s, loss=0.6776, mse=0.6765, lpips=0.0022]
Epoch 67/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 66/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5074]
Epoch 67/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5954]Epoch 67/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6184]Epoch 67 | Avg Train Loss: 0.6290 | Avg Val Loss: 0.6069

Epoch 68/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 68/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.5941, mse=0.5931, lpips=0.0020][A
Epoch 68/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.09s/it, loss=0.5941, mse=0.5931, lpips=0.0020][A
Epoch 68/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.09s/it, loss=0.5969, mse=0.5959, lpips=0.0020][A
Epoch 68/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.09s/it, loss=0.6083, mse=0.6073, lpips=0.0020][A
Epoch 68/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.83it/s, loss=0.6083, mse=0.6073, lpips=0.0020][A
Epoch 68/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.83it/s, loss=0.6335, mse=0.6325, lpips=0.0021][A
Epoch 68/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.83it/s, loss=0.5998, mse=0.5988, lpips=0.0020][A
Epoch 68/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.67it/s, loss=0.5998, mse=0.5988, lpips=0.0020][A
Epoch 68/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.67it/s, loss=0.6305, mse=0.6295, lpips=0.0021][A
Epoch 68/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.67it/s, loss=0.6260, mse=0.6249, lpips=0.0021][A
Epoch 68/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.11it/s, loss=0.6260, mse=0.6249, lpips=0.0021][A
Epoch 68/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.11it/s, loss=0.6141, mse=0.6131, lpips=0.0020][A
Epoch 68/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.11it/s, loss=0.6094, mse=0.6084, lpips=0.0020][A
Epoch 68/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.41it/s, loss=0.6094, mse=0.6084, lpips=0.0020][A
Epoch 68/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.41it/s, loss=0.6262, mse=0.6252, lpips=0.0021][AEpoch 68/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.33it/s, loss=0.6262, mse=0.6252, lpips=0.0021]

Epoch 68/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 67/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6184]

Epoch 68/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6330][A
Epoch 68/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6306][AEpoch 68 | Avg Train Loss: 0.6139 | Avg Val Loss: 0.6318
Epoch 69/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 69/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.6055, mse=0.6045, lpips=0.0020]Epoch 69/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.11s/it, loss=0.6055, mse=0.6045, lpips=0.0020]Epoch 69/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.11s/it, loss=0.5896, mse=0.5886, lpips=0.0020]Epoch 69/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.11s/it, loss=0.6193, mse=0.6182, lpips=0.0020]Epoch 69/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.82it/s, loss=0.6193, mse=0.6182, lpips=0.0020]Epoch 69/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.82it/s, loss=0.6269, mse=0.6259, lpips=0.0021]Epoch 69/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.82it/s, loss=0.6424, mse=0.6413, lpips=0.0021]Epoch 69/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.56it/s, loss=0.6424, mse=0.6413, lpips=0.0021]Epoch 69/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.56it/s, loss=0.6119, mse=0.6109, lpips=0.0020]Epoch 69/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.56it/s, loss=0.6237, mse=0.6227, lpips=0.0020]Epoch 69/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.19it/s, loss=0.6237, mse=0.6227, lpips=0.0020]Epoch 69/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.19it/s, loss=0.6037, mse=0.6027, lpips=0.0020]Epoch 69/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.19it/s, loss=0.6204, mse=0.6194, lpips=0.0020]Epoch 69/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.46it/s, loss=0.6204, mse=0.6194, lpips=0.0020]Epoch 69/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.46it/s, loss=0.5516, mse=0.5506, lpips=0.0019]Epoch 69/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.32it/s, loss=0.5516, mse=0.5506, lpips=0.0019]
Epoch 69/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 68/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6306]
Epoch 69/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5995]Epoch 69/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7586]Epoch 69 | Avg Train Loss: 0.6095 | Avg Val Loss: 0.6791

Epoch 70/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 70/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.6528, mse=0.6518, lpips=0.0021][A
Epoch 70/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.6528, mse=0.6518, lpips=0.0021][A
Epoch 70/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.5963, mse=0.5953, lpips=0.0020][A
Epoch 70/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.6385, mse=0.6375, lpips=0.0021][A
Epoch 70/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.6385, mse=0.6375, lpips=0.0021][A
Epoch 70/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.5906, mse=0.5896, lpips=0.0020][A
Epoch 70/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.5889, mse=0.5880, lpips=0.0020][A
Epoch 70/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.59it/s, loss=0.5889, mse=0.5880, lpips=0.0020][A
Epoch 70/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.59it/s, loss=0.5910, mse=0.5900, lpips=0.0020][A
Epoch 70/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.59it/s, loss=0.6159, mse=0.6149, lpips=0.0020][A
Epoch 70/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.03it/s, loss=0.6159, mse=0.6149, lpips=0.0020][A
Epoch 70/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.03it/s, loss=0.5926, mse=0.5916, lpips=0.0020][A
Epoch 70/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.06it/s, loss=0.5926, mse=0.5916, lpips=0.0020][A
Epoch 70/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.06it/s, loss=0.6027, mse=0.6017, lpips=0.0020][A
Epoch 70/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  6.12it/s, loss=0.6027, mse=0.6017, lpips=0.0020][A
Epoch 70/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  6.12it/s, loss=0.6584, mse=0.6574, lpips=0.0021][A
Epoch 70/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.56it/s, loss=0.6584, mse=0.6574, lpips=0.0021][AEpoch 70/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.77it/s, loss=0.6584, mse=0.6574, lpips=0.0021]

Epoch 70/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 69/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.7586]

Epoch 70/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6002][A
Epoch 70/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.8277][AEpoch 70 | Avg Train Loss: 0.6128 | Avg Val Loss: 0.7139
Saving interval checkpoint for epoch 70...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -203.9324, Max: 180.4125
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_70.png
Epoch 71/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 71/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.6016, mse=0.6006, lpips=0.0020]Epoch 71/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:21,  9.03s/it, loss=0.6016, mse=0.6006, lpips=0.0020]Epoch 71/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:21,  9.03s/it, loss=0.6315, mse=0.6305, lpips=0.0021]Epoch 71/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:21,  9.03s/it, loss=0.6036, mse=0.6026, lpips=0.0020]Epoch 71/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.44s/it, loss=0.6036, mse=0.6026, lpips=0.0020]Epoch 71/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.44s/it, loss=0.5827, mse=0.5817, lpips=0.0019]Epoch 71/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.66s/it, loss=0.5827, mse=0.5817, lpips=0.0019]Epoch 71/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.66s/it, loss=0.6133, mse=0.6123, lpips=0.0020]Epoch 71/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:05,  1.16s/it, loss=0.6133, mse=0.6123, lpips=0.0020]Epoch 71/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:05,  1.16s/it, loss=0.6367, mse=0.6357, lpips=0.0021]Epoch 71/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.19it/s, loss=0.6367, mse=0.6357, lpips=0.0021]Epoch 71/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.19it/s, loss=0.6128, mse=0.6118, lpips=0.0020]Epoch 71/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:01,  1.60it/s, loss=0.6128, mse=0.6118, lpips=0.0020]Epoch 71/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:01,  1.60it/s, loss=0.6538, mse=0.6527, lpips=0.0021]Epoch 71/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:00,  2.03it/s, loss=0.6538, mse=0.6527, lpips=0.0021]Epoch 71/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:00,  2.03it/s, loss=0.5921, mse=0.5911, lpips=0.0020]Epoch 71/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  2.59it/s, loss=0.5921, mse=0.5911, lpips=0.0020]Epoch 71/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  2.59it/s, loss=0.5991, mse=0.5981, lpips=0.0020]Epoch 71/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  3.34it/s, loss=0.5991, mse=0.5981, lpips=0.0020]Epoch 71/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.04s/it, loss=0.5991, mse=0.5981, lpips=0.0020]
Epoch 71/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 70/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.8277]
Epoch 71/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6323]Epoch 71/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4975]Epoch 71 | Avg Train Loss: 0.6127 | Avg Val Loss: 0.5649
New best validation loss: 0.5649. Saving best model...

Epoch 72/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 72/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.6053, mse=0.6044, lpips=0.0020][A
Epoch 72/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:06,  7.35s/it, loss=0.6053, mse=0.6044, lpips=0.0020][A
Epoch 72/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:06,  7.35s/it, loss=0.6050, mse=0.6040, lpips=0.0020][A
Epoch 72/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.12s/it, loss=0.6050, mse=0.6040, lpips=0.0020][A
Epoch 72/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.12s/it, loss=0.5844, mse=0.5834, lpips=0.0019][A
Epoch 72/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.78s/it, loss=0.5844, mse=0.5834, lpips=0.0019][A
Epoch 72/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.78s/it, loss=0.6035, mse=0.6025, lpips=0.0020][A
Epoch 72/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.15s/it, loss=0.6035, mse=0.6025, lpips=0.0020][A
Epoch 72/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:06,  1.15s/it, loss=0.5857, mse=0.5847, lpips=0.0019][A
Epoch 72/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.28it/s, loss=0.5857, mse=0.5847, lpips=0.0019][A
Epoch 72/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.28it/s, loss=0.5963, mse=0.5953, lpips=0.0020][A
Epoch 72/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.75it/s, loss=0.5963, mse=0.5953, lpips=0.0020][A
Epoch 72/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.75it/s, loss=0.5903, mse=0.5893, lpips=0.0020][A
Epoch 72/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.27it/s, loss=0.5903, mse=0.5893, lpips=0.0020][A
Epoch 72/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.27it/s, loss=0.5842, mse=0.5832, lpips=0.0019][A
Epoch 72/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.84it/s, loss=0.5842, mse=0.5832, lpips=0.0019][A
Epoch 72/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.84it/s, loss=0.5787, mse=0.5777, lpips=0.0019][A
Epoch 72/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.35it/s, loss=0.5787, mse=0.5777, lpips=0.0019][A
Epoch 72/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.35it/s, loss=0.6174, mse=0.6164, lpips=0.0020][A
Epoch 72/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  4.19it/s, loss=0.6174, mse=0.6164, lpips=0.0020][AEpoch 72/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.14it/s, loss=0.6174, mse=0.6164, lpips=0.0020]

Epoch 72/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 71/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.4975]

Epoch 72/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6039][A
Epoch 72/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4948][AEpoch 72 | Avg Train Loss: 0.5951 | Avg Val Loss: 0.5493
New best validation loss: 0.5493. Saving best model...
Epoch 73/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 73/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.5777, mse=0.5767, lpips=0.0019]Epoch 73/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.29s/it, loss=0.5777, mse=0.5767, lpips=0.0019]Epoch 73/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.29s/it, loss=0.5169, mse=0.5160, lpips=0.0018]Epoch 73/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.08s/it, loss=0.5169, mse=0.5160, lpips=0.0018]Epoch 73/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.08s/it, loss=0.6005, mse=0.5995, lpips=0.0020]Epoch 73/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.74s/it, loss=0.6005, mse=0.5995, lpips=0.0020]Epoch 73/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.74s/it, loss=0.5743, mse=0.5734, lpips=0.0019]Epoch 73/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.11s/it, loss=0.5743, mse=0.5734, lpips=0.0019]Epoch 73/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.11s/it, loss=0.5877, mse=0.5867, lpips=0.0019]Epoch 73/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.30it/s, loss=0.5877, mse=0.5867, lpips=0.0019]Epoch 73/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.30it/s, loss=0.6217, mse=0.6207, lpips=0.0020]Epoch 73/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.75it/s, loss=0.6217, mse=0.6207, lpips=0.0020]Epoch 73/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.75it/s, loss=0.5639, mse=0.5630, lpips=0.0019]Epoch 73/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.32it/s, loss=0.5639, mse=0.5630, lpips=0.0019]Epoch 73/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.32it/s, loss=0.6186, mse=0.6176, lpips=0.0020]Epoch 73/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.85it/s, loss=0.6186, mse=0.6176, lpips=0.0020]Epoch 73/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.85it/s, loss=0.6060, mse=0.6050, lpips=0.0020]Epoch 73/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.31it/s, loss=0.6060, mse=0.6050, lpips=0.0020]Epoch 73/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.31it/s, loss=0.5863, mse=0.5853, lpips=0.0019]Epoch 73/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  4.07it/s, loss=0.5863, mse=0.5853, lpips=0.0019]Epoch 73/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.15it/s, loss=0.5863, mse=0.5853, lpips=0.0019]
Epoch 73/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 72/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.4948]
Epoch 73/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6263]Epoch 73/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5840]Epoch 73 | Avg Train Loss: 0.5854 | Avg Val Loss: 0.6051

Epoch 74/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 74/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.5636, mse=0.5626, lpips=0.0019][A
Epoch 74/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:06,  7.36s/it, loss=0.5636, mse=0.5626, lpips=0.0019][A
Epoch 74/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:06,  7.36s/it, loss=0.6099, mse=0.6090, lpips=0.0020][A
Epoch 74/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.16s/it, loss=0.6099, mse=0.6090, lpips=0.0020][A
Epoch 74/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.16s/it, loss=0.6002, mse=0.5992, lpips=0.0020][A
Epoch 74/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.79s/it, loss=0.6002, mse=0.5992, lpips=0.0020][A
Epoch 74/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.79s/it, loss=0.6311, mse=0.6301, lpips=0.0020][A
Epoch 74/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.15s/it, loss=0.6311, mse=0.6301, lpips=0.0020][A
Epoch 74/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:06,  1.15s/it, loss=0.5902, mse=0.5892, lpips=0.0019][A
Epoch 74/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.26it/s, loss=0.5902, mse=0.5892, lpips=0.0019][A
Epoch 74/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.26it/s, loss=0.6128, mse=0.6118, lpips=0.0020][A
Epoch 74/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.70it/s, loss=0.6128, mse=0.6118, lpips=0.0020][A
Epoch 74/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.70it/s, loss=0.6040, mse=0.6031, lpips=0.0020][A
Epoch 74/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.27it/s, loss=0.6040, mse=0.6031, lpips=0.0020][A
Epoch 74/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.27it/s, loss=0.6007, mse=0.5997, lpips=0.0019][A
Epoch 74/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.27it/s, loss=0.5945, mse=0.5935, lpips=0.0019][A
Epoch 74/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.72it/s, loss=0.5945, mse=0.5935, lpips=0.0019][A
Epoch 74/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.72it/s, loss=0.6553, mse=0.6543, lpips=0.0021][AEpoch 74/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.16it/s, loss=0.6553, mse=0.6543, lpips=0.0021]

Epoch 74/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 73/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.5840]

Epoch 74/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6230][A
Epoch 74/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6826][AEpoch 74 | Avg Train Loss: 0.6062 | Avg Val Loss: 0.6528
Epoch 75/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 75/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.5996, mse=0.5987, lpips=0.0020]Epoch 75/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.70s/it, loss=0.5996, mse=0.5987, lpips=0.0020]Epoch 75/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.70s/it, loss=0.5861, mse=0.5851, lpips=0.0019]Epoch 75/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.70s/it, loss=0.6129, mse=0.6119, lpips=0.0020]Epoch 75/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:14,  2.06s/it, loss=0.6129, mse=0.6119, lpips=0.0020]Epoch 75/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:14,  2.06s/it, loss=0.5575, mse=0.5566, lpips=0.0019]Epoch 75/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:14,  2.06s/it, loss=0.6287, mse=0.6277, lpips=0.0020]Epoch 75/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.05s/it, loss=0.6287, mse=0.6277, lpips=0.0020]Epoch 75/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.05s/it, loss=0.5868, mse=0.5859, lpips=0.0019]Epoch 75/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.05s/it, loss=0.6055, mse=0.6045, lpips=0.0020]Epoch 75/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.56it/s, loss=0.6055, mse=0.6045, lpips=0.0020]Epoch 75/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.56it/s, loss=0.5652, mse=0.5643, lpips=0.0019]Epoch 75/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.56it/s, loss=0.5954, mse=0.5944, lpips=0.0019]Epoch 75/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.30it/s, loss=0.5954, mse=0.5944, lpips=0.0019]Epoch 75/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.30it/s, loss=0.5193, mse=0.5184, lpips=0.0018]Epoch 75/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.18it/s, loss=0.5193, mse=0.5184, lpips=0.0018]
Epoch 75/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 74/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.6826]
Epoch 75/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5797]Epoch 75/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5207]Epoch 75 | Avg Train Loss: 0.5857 | Avg Val Loss: 0.5502
Saving interval checkpoint for epoch 75...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -193.7347, Max: 192.6554
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_75.png

Epoch 76/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 76/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.5863, mse=0.5853, lpips=0.0019][A
Epoch 76/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:28,  9.84s/it, loss=0.5863, mse=0.5853, lpips=0.0019][A
Epoch 76/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:28,  9.84s/it, loss=0.5793, mse=0.5783, lpips=0.0019][A
Epoch 76/1000 [TRAIN]:  10%|█         | 1/10 [00:10<01:28,  9.84s/it, loss=0.5896, mse=0.5887, lpips=0.0019][A
Epoch 76/1000 [TRAIN]:  30%|███       | 3/10 [00:10<00:18,  2.61s/it, loss=0.5896, mse=0.5887, lpips=0.0019][A
Epoch 76/1000 [TRAIN]:  30%|███       | 3/10 [00:10<00:18,  2.61s/it, loss=0.5677, mse=0.5668, lpips=0.0019][A
Epoch 76/1000 [TRAIN]:  30%|███       | 3/10 [00:10<00:18,  2.61s/it, loss=0.5787, mse=0.5778, lpips=0.0019][A
Epoch 76/1000 [TRAIN]:  50%|█████     | 5/10 [00:10<00:06,  1.32s/it, loss=0.5787, mse=0.5778, lpips=0.0019][A
Epoch 76/1000 [TRAIN]:  50%|█████     | 5/10 [00:10<00:06,  1.32s/it, loss=0.5875, mse=0.5865, lpips=0.0019][A
Epoch 76/1000 [TRAIN]:  50%|█████     | 5/10 [00:10<00:06,  1.32s/it, loss=0.5734, mse=0.5724, lpips=0.0019][A
Epoch 76/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:02,  1.25it/s, loss=0.5734, mse=0.5724, lpips=0.0019][A
Epoch 76/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:02,  1.25it/s, loss=0.5727, mse=0.5718, lpips=0.0019][A
Epoch 76/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:02,  1.25it/s, loss=0.5648, mse=0.5638, lpips=0.0019][A
Epoch 76/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  1.87it/s, loss=0.5648, mse=0.5638, lpips=0.0019][A
Epoch 76/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  1.87it/s, loss=0.5241, mse=0.5232, lpips=0.0018][AEpoch 76/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.06s/it, loss=0.5241, mse=0.5232, lpips=0.0018]

Epoch 76/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 75/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.5207]

Epoch 76/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6090][A
Epoch 76/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4819][AEpoch 76 | Avg Train Loss: 0.5724 | Avg Val Loss: 0.5454
New best validation loss: 0.5454. Saving best model...
Epoch 77/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 77/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.5536, mse=0.5527, lpips=0.0018]Epoch 77/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.11s/it, loss=0.5536, mse=0.5527, lpips=0.0018]Epoch 77/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.11s/it, loss=0.5680, mse=0.5670, lpips=0.0019]Epoch 77/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.11s/it, loss=0.5967, mse=0.5957, lpips=0.0019]Epoch 77/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.82it/s, loss=0.5967, mse=0.5957, lpips=0.0019]Epoch 77/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.82it/s, loss=0.5905, mse=0.5896, lpips=0.0019]Epoch 77/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.82it/s, loss=0.5874, mse=0.5864, lpips=0.0019]Epoch 77/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.65it/s, loss=0.5874, mse=0.5864, lpips=0.0019]Epoch 77/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.65it/s, loss=0.5602, mse=0.5592, lpips=0.0018]Epoch 77/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.65it/s, loss=0.5950, mse=0.5940, lpips=0.0019]Epoch 77/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.19it/s, loss=0.5950, mse=0.5940, lpips=0.0019]Epoch 77/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.19it/s, loss=0.6035, mse=0.6025, lpips=0.0019]Epoch 77/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.19it/s, loss=0.5839, mse=0.5830, lpips=0.0019]Epoch 77/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.46it/s, loss=0.5839, mse=0.5830, lpips=0.0019]Epoch 77/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.46it/s, loss=0.5821, mse=0.5811, lpips=0.0019]Epoch 77/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.35it/s, loss=0.5821, mse=0.5811, lpips=0.0019]
Epoch 77/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 76/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4819]
Epoch 77/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5586]Epoch 77/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.8099]Epoch 77 | Avg Train Loss: 0.5821 | Avg Val Loss: 0.6842

Epoch 78/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 78/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.5713, mse=0.5703, lpips=0.0019][A
Epoch 78/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.08s/it, loss=0.5713, mse=0.5703, lpips=0.0019][A
Epoch 78/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.08s/it, loss=0.5930, mse=0.5920, lpips=0.0019][A
Epoch 78/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.08s/it, loss=0.5901, mse=0.5891, lpips=0.0019][A
Epoch 78/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.88it/s, loss=0.5901, mse=0.5891, lpips=0.0019][A
Epoch 78/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.88it/s, loss=0.5785, mse=0.5776, lpips=0.0019][A
Epoch 78/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.88it/s, loss=0.5912, mse=0.5903, lpips=0.0019][A
Epoch 78/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.61it/s, loss=0.5912, mse=0.5903, lpips=0.0019][A
Epoch 78/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.61it/s, loss=0.5549, mse=0.5540, lpips=0.0018][A
Epoch 78/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.61it/s, loss=0.5726, mse=0.5716, lpips=0.0019][A
Epoch 78/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.18it/s, loss=0.5726, mse=0.5716, lpips=0.0019][A
Epoch 78/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.18it/s, loss=0.5519, mse=0.5509, lpips=0.0018][A
Epoch 78/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.18it/s, loss=0.5844, mse=0.5835, lpips=0.0019][A
Epoch 78/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.44it/s, loss=0.5844, mse=0.5835, lpips=0.0019][A
Epoch 78/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.44it/s, loss=0.5684, mse=0.5675, lpips=0.0018][AEpoch 78/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.35it/s, loss=0.5684, mse=0.5675, lpips=0.0018]

Epoch 78/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 77/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.8099]

Epoch 78/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5846][A
Epoch 78/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7306][AEpoch 78 | Avg Train Loss: 0.5756 | Avg Val Loss: 0.6576
Epoch 79/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 79/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.5980, mse=0.5971, lpips=0.0019]Epoch 79/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.19s/it, loss=0.5980, mse=0.5971, lpips=0.0019]Epoch 79/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.19s/it, loss=0.5225, mse=0.5216, lpips=0.0017]Epoch 79/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.67it/s, loss=0.5225, mse=0.5216, lpips=0.0017]Epoch 79/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.67it/s, loss=0.5775, mse=0.5766, lpips=0.0019]Epoch 79/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.51it/s, loss=0.5775, mse=0.5766, lpips=0.0019]Epoch 79/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.51it/s, loss=0.5977, mse=0.5968, lpips=0.0019]Epoch 79/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.38it/s, loss=0.5977, mse=0.5968, lpips=0.0019]Epoch 79/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.38it/s, loss=0.5239, mse=0.5231, lpips=0.0017]Epoch 79/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.03it/s, loss=0.5239, mse=0.5231, lpips=0.0017]Epoch 79/1000 [TRAIN]:  50%|█████     | 5/10 [00:02<00:01,  4.03it/s, loss=0.6032, mse=0.6022, lpips=0.0019]Epoch 79/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.42it/s, loss=0.6032, mse=0.6022, lpips=0.0019]Epoch 79/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.42it/s, loss=0.6100, mse=0.6091, lpips=0.0019]Epoch 79/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.05it/s, loss=0.6100, mse=0.6091, lpips=0.0019]Epoch 79/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.05it/s, loss=0.5627, mse=0.5617, lpips=0.0018]Epoch 79/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.29it/s, loss=0.5627, mse=0.5617, lpips=0.0018]Epoch 79/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.29it/s, loss=0.5965, mse=0.5955, lpips=0.0019]Epoch 79/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.29it/s, loss=0.5488, mse=0.5479, lpips=0.0018]Epoch 79/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  7.43it/s, loss=0.5488, mse=0.5479, lpips=0.0018]Epoch 79/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.03it/s, loss=0.5488, mse=0.5479, lpips=0.0018]
Epoch 79/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 78/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.7306]
Epoch 79/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5549]Epoch 79/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5677]Epoch 79 | Avg Train Loss: 0.5741 | Avg Val Loss: 0.5613

Epoch 80/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 80/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.5547, mse=0.5538, lpips=0.0018][A
Epoch 80/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.25s/it, loss=0.5547, mse=0.5538, lpips=0.0018][A
Epoch 80/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.25s/it, loss=0.5472, mse=0.5463, lpips=0.0018][A
Epoch 80/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.07s/it, loss=0.5472, mse=0.5463, lpips=0.0018][A
Epoch 80/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.07s/it, loss=0.5495, mse=0.5486, lpips=0.0018][A
Epoch 80/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.75s/it, loss=0.5495, mse=0.5486, lpips=0.0018][A
Epoch 80/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.75s/it, loss=0.5676, mse=0.5667, lpips=0.0018][A
Epoch 80/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.12s/it, loss=0.5676, mse=0.5667, lpips=0.0018][A
Epoch 80/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.12s/it, loss=0.5924, mse=0.5915, lpips=0.0019][A
Epoch 80/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.27it/s, loss=0.5924, mse=0.5915, lpips=0.0019][A
Epoch 80/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.27it/s, loss=0.5422, mse=0.5413, lpips=0.0018][A
Epoch 80/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.76it/s, loss=0.5422, mse=0.5413, lpips=0.0018][A
Epoch 80/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.76it/s, loss=0.5621, mse=0.5612, lpips=0.0018][A
Epoch 80/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.28it/s, loss=0.5621, mse=0.5612, lpips=0.0018][A
Epoch 80/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.28it/s, loss=0.5896, mse=0.5887, lpips=0.0019][A
Epoch 80/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.28it/s, loss=0.5897, mse=0.5888, lpips=0.0019][A
Epoch 80/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.49it/s, loss=0.5897, mse=0.5888, lpips=0.0019][A
Epoch 80/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.49it/s, loss=0.5298, mse=0.5289, lpips=0.0018][A
Epoch 80/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  4.09it/s, loss=0.5298, mse=0.5289, lpips=0.0018][AEpoch 80/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.16it/s, loss=0.5298, mse=0.5289, lpips=0.0018]

Epoch 80/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 79/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.5677]

Epoch 80/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5575][A
Epoch 80/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4905][AEpoch 80 | Avg Train Loss: 0.5625 | Avg Val Loss: 0.5240
New best validation loss: 0.5240. Saving best model...
Saving interval checkpoint for epoch 80...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -184.2427, Max: 201.2440
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_80.png
Epoch 81/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 81/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.5789, mse=0.5779, lpips=0.0019]Epoch 81/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.28s/it, loss=0.5789, mse=0.5779, lpips=0.0019]Epoch 81/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.28s/it, loss=0.5484, mse=0.5475, lpips=0.0018]Epoch 81/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.94s/it, loss=0.5484, mse=0.5475, lpips=0.0018]Epoch 81/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.94s/it, loss=0.5851, mse=0.5841, lpips=0.0019]Epoch 81/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.94s/it, loss=0.5810, mse=0.5801, lpips=0.0019]Epoch 81/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.52s/it, loss=0.5810, mse=0.5801, lpips=0.0019]Epoch 81/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.52s/it, loss=0.5557, mse=0.5548, lpips=0.0018]Epoch 81/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.52s/it, loss=0.5678, mse=0.5669, lpips=0.0018]Epoch 81/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.19it/s, loss=0.5678, mse=0.5669, lpips=0.0018]Epoch 81/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.19it/s, loss=0.5653, mse=0.5643, lpips=0.0018]Epoch 81/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.19it/s, loss=0.6157, mse=0.6147, lpips=0.0019]Epoch 81/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.86it/s, loss=0.6157, mse=0.6147, lpips=0.0019]Epoch 81/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:01,  1.86it/s, loss=0.5624, mse=0.5615, lpips=0.0018]Epoch 81/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:01,  1.86it/s, loss=0.5306, mse=0.5297, lpips=0.0018]Epoch 81/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  2.70it/s, loss=0.5306, mse=0.5297, lpips=0.0018]Epoch 81/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.02s/it, loss=0.5306, mse=0.5297, lpips=0.0018]
Epoch 81/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 80/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.4905]
Epoch 81/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5290]Epoch 81/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5061]Epoch 81 | Avg Train Loss: 0.5691 | Avg Val Loss: 0.5175
New best validation loss: 0.5175. Saving best model...

Epoch 82/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 82/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.5612, mse=0.5603, lpips=0.0018][A
Epoch 82/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.5612, mse=0.5603, lpips=0.0018][A
Epoch 82/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.5937, mse=0.5928, lpips=0.0019][A
Epoch 82/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.6089, mse=0.6079, lpips=0.0019][A
Epoch 82/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.6089, mse=0.6079, lpips=0.0019][A
Epoch 82/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.5489, mse=0.5480, lpips=0.0018][A
Epoch 82/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.5434, mse=0.5425, lpips=0.0018][A
Epoch 82/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.61it/s, loss=0.5434, mse=0.5425, lpips=0.0018][A
Epoch 82/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.61it/s, loss=0.5591, mse=0.5582, lpips=0.0018][A
Epoch 82/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.61it/s, loss=0.5562, mse=0.5553, lpips=0.0018][A
Epoch 82/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.23it/s, loss=0.5562, mse=0.5553, lpips=0.0018][A
Epoch 82/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.23it/s, loss=0.5583, mse=0.5574, lpips=0.0018][A
Epoch 82/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.23it/s, loss=0.5715, mse=0.5706, lpips=0.0018][A
Epoch 82/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.47it/s, loss=0.5715, mse=0.5706, lpips=0.0018][A
Epoch 82/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.47it/s, loss=0.5469, mse=0.5460, lpips=0.0018][AEpoch 82/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.37it/s, loss=0.5469, mse=0.5460, lpips=0.0018]

Epoch 82/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 81/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5061]

Epoch 82/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5691][A
Epoch 82/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4654][AEpoch 82 | Avg Train Loss: 0.5648 | Avg Val Loss: 0.5172
New best validation loss: 0.5172. Saving best model...
Epoch 83/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 83/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.5493, mse=0.5484, lpips=0.0018]Epoch 83/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.5493, mse=0.5484, lpips=0.0018]Epoch 83/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.5671, mse=0.5662, lpips=0.0018]Epoch 83/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.5599, mse=0.5590, lpips=0.0018]Epoch 83/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.86it/s, loss=0.5599, mse=0.5590, lpips=0.0018]Epoch 83/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.86it/s, loss=0.5450, mse=0.5442, lpips=0.0018]Epoch 83/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.86it/s, loss=0.5505, mse=0.5496, lpips=0.0018]Epoch 83/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.67it/s, loss=0.5505, mse=0.5496, lpips=0.0018]Epoch 83/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.67it/s, loss=0.5617, mse=0.5608, lpips=0.0018]Epoch 83/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.67it/s, loss=0.5450, mse=0.5441, lpips=0.0018]Epoch 83/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.35it/s, loss=0.5450, mse=0.5441, lpips=0.0018]Epoch 83/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.35it/s, loss=0.5617, mse=0.5608, lpips=0.0018]Epoch 83/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.35it/s, loss=0.5618, mse=0.5609, lpips=0.0018]Epoch 83/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.58it/s, loss=0.5618, mse=0.5609, lpips=0.0018]Epoch 83/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.58it/s, loss=0.5456, mse=0.5448, lpips=0.0018]Epoch 83/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.44it/s, loss=0.5456, mse=0.5448, lpips=0.0018]
Epoch 83/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 82/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4654]
Epoch 83/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5468]Epoch 83/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5241]Epoch 83 | Avg Train Loss: 0.5548 | Avg Val Loss: 0.5355

Epoch 84/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 84/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.5376, mse=0.5367, lpips=0.0018][A
Epoch 84/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.11s/it, loss=0.5376, mse=0.5367, lpips=0.0018][A
Epoch 84/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.11s/it, loss=0.5806, mse=0.5797, lpips=0.0019][A
Epoch 84/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.68it/s, loss=0.5806, mse=0.5797, lpips=0.0019][A
Epoch 84/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.68it/s, loss=0.5583, mse=0.5574, lpips=0.0018][A
Epoch 84/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.44it/s, loss=0.5583, mse=0.5574, lpips=0.0018][A
Epoch 84/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.44it/s, loss=0.5711, mse=0.5702, lpips=0.0018][A
Epoch 84/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.29it/s, loss=0.5711, mse=0.5702, lpips=0.0018][A
Epoch 84/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.29it/s, loss=0.5447, mse=0.5438, lpips=0.0018][A
Epoch 84/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  3.83it/s, loss=0.5447, mse=0.5438, lpips=0.0018][A
Epoch 84/1000 [TRAIN]:  50%|█████     | 5/10 [00:02<00:01,  3.83it/s, loss=0.5791, mse=0.5782, lpips=0.0018][A
Epoch 84/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.49it/s, loss=0.5791, mse=0.5782, lpips=0.0018][A
Epoch 84/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.49it/s, loss=0.5165, mse=0.5156, lpips=0.0017][A
Epoch 84/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.89it/s, loss=0.5165, mse=0.5156, lpips=0.0017][A
Epoch 84/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.89it/s, loss=0.5297, mse=0.5288, lpips=0.0017][A
Epoch 84/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.25it/s, loss=0.5297, mse=0.5288, lpips=0.0017][A
Epoch 84/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.25it/s, loss=0.5534, mse=0.5525, lpips=0.0018][A
Epoch 84/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.30it/s, loss=0.5534, mse=0.5525, lpips=0.0018][A
Epoch 84/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.30it/s, loss=0.5868, mse=0.5858, lpips=0.0019][A
Epoch 84/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.05it/s, loss=0.5868, mse=0.5858, lpips=0.0019][AEpoch 84/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  3.80it/s, loss=0.5868, mse=0.5858, lpips=0.0019]

Epoch 84/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 83/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5241]

Epoch 84/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5151][A
Epoch 84/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4695][AEpoch 84 | Avg Train Loss: 0.5558 | Avg Val Loss: 0.4923
New best validation loss: 0.4923. Saving best model...
Epoch 85/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 85/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.5509, mse=0.5501, lpips=0.0018]Epoch 85/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:10,  7.82s/it, loss=0.5509, mse=0.5501, lpips=0.0018]Epoch 85/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:10,  7.82s/it, loss=0.5806, mse=0.5797, lpips=0.0018]Epoch 85/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:26,  3.32s/it, loss=0.5806, mse=0.5797, lpips=0.0018]Epoch 85/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:26,  3.32s/it, loss=0.5807, mse=0.5797, lpips=0.0018]Epoch 85/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:26,  3.32s/it, loss=0.5242, mse=0.5233, lpips=0.0017]Epoch 85/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.29s/it, loss=0.5242, mse=0.5233, lpips=0.0017]Epoch 85/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.29s/it, loss=0.5329, mse=0.5320, lpips=0.0017]Epoch 85/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.08it/s, loss=0.5329, mse=0.5320, lpips=0.0017]Epoch 85/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.08it/s, loss=0.5475, mse=0.5466, lpips=0.0018]Epoch 85/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.08it/s, loss=0.5484, mse=0.5475, lpips=0.0018]Epoch 85/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.88it/s, loss=0.5484, mse=0.5475, lpips=0.0018]Epoch 85/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.88it/s, loss=0.5953, mse=0.5943, lpips=0.0019]Epoch 85/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.88it/s, loss=0.5368, mse=0.5359, lpips=0.0017]Epoch 85/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.69it/s, loss=0.5368, mse=0.5359, lpips=0.0017]Epoch 85/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.69it/s, loss=0.5223, mse=0.5214, lpips=0.0017]Epoch 85/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  3.16it/s, loss=0.5223, mse=0.5214, lpips=0.0017]Epoch 85/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.13it/s, loss=0.5223, mse=0.5214, lpips=0.0017]
Epoch 85/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 84/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.4695]
Epoch 85/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5411]Epoch 85/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5670]Epoch 85 | Avg Train Loss: 0.5519 | Avg Val Loss: 0.5541
Saving interval checkpoint for epoch 85...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -200.2514, Max: 217.6570
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_85.png

Epoch 86/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 86/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.5317, mse=0.5309, lpips=0.0017][A
Epoch 86/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:22,  9.22s/it, loss=0.5317, mse=0.5309, lpips=0.0017][A
Epoch 86/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:22,  9.22s/it, loss=0.5043, mse=0.5035, lpips=0.0016][A
Epoch 86/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:22,  9.22s/it, loss=0.5567, mse=0.5558, lpips=0.0018][A
Epoch 86/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.46s/it, loss=0.5567, mse=0.5558, lpips=0.0018][A
Epoch 86/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.46s/it, loss=0.5280, mse=0.5271, lpips=0.0017][A
Epoch 86/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.46s/it, loss=0.5333, mse=0.5324, lpips=0.0017][A
Epoch 86/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.5333, mse=0.5324, lpips=0.0017][A
Epoch 86/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.5150, mse=0.5142, lpips=0.0017][A
Epoch 86/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.5256, mse=0.5248, lpips=0.0017][A
Epoch 86/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.32it/s, loss=0.5256, mse=0.5248, lpips=0.0017][A
Epoch 86/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.32it/s, loss=0.5445, mse=0.5437, lpips=0.0018][A
Epoch 86/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.32it/s, loss=0.5589, mse=0.5580, lpips=0.0018][A
Epoch 86/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  1.98it/s, loss=0.5589, mse=0.5580, lpips=0.0018][A
Epoch 86/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  1.98it/s, loss=0.4640, mse=0.4632, lpips=0.0015][AEpoch 86/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.00s/it, loss=0.4640, mse=0.4632, lpips=0.0015]

Epoch 86/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 85/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.5670]

Epoch 86/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5354][A
Epoch 86/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4992][AEpoch 86 | Avg Train Loss: 0.5262 | Avg Val Loss: 0.5173
Epoch 87/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 87/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.5201, mse=0.5193, lpips=0.0017]Epoch 87/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.24s/it, loss=0.5201, mse=0.5193, lpips=0.0017]Epoch 87/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.24s/it, loss=0.5236, mse=0.5228, lpips=0.0017]Epoch 87/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.24s/it, loss=0.5608, mse=0.5599, lpips=0.0018]Epoch 87/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.58it/s, loss=0.5608, mse=0.5599, lpips=0.0018]Epoch 87/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.58it/s, loss=0.5673, mse=0.5664, lpips=0.0018]Epoch 87/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.58it/s, loss=0.5235, mse=0.5227, lpips=0.0017]Epoch 87/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.23it/s, loss=0.5235, mse=0.5227, lpips=0.0017]Epoch 87/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.23it/s, loss=0.5076, mse=0.5068, lpips=0.0017]Epoch 87/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.23it/s, loss=0.5603, mse=0.5595, lpips=0.0018]Epoch 87/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.70it/s, loss=0.5603, mse=0.5595, lpips=0.0018]Epoch 87/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.70it/s, loss=0.5530, mse=0.5521, lpips=0.0018]Epoch 87/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.70it/s, loss=0.5384, mse=0.5375, lpips=0.0017]Epoch 87/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.00it/s, loss=0.5384, mse=0.5375, lpips=0.0017]Epoch 87/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  7.00it/s, loss=0.5478, mse=0.5469, lpips=0.0017]Epoch 87/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.93it/s, loss=0.5478, mse=0.5469, lpips=0.0017]
Epoch 87/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 86/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4992]
Epoch 87/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5492]Epoch 87/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4349]Epoch 87 | Avg Train Loss: 0.5402 | Avg Val Loss: 0.4920
New best validation loss: 0.4920. Saving best model...

Epoch 88/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 88/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.5120, mse=0.5112, lpips=0.0017][A
Epoch 88/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:08,  1.06it/s, loss=0.5120, mse=0.5112, lpips=0.0017][A
Epoch 88/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.06it/s, loss=0.5466, mse=0.5457, lpips=0.0017][A
Epoch 88/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.06it/s, loss=0.5355, mse=0.5346, lpips=0.0017][A
Epoch 88/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.18it/s, loss=0.5355, mse=0.5346, lpips=0.0017][A
Epoch 88/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.18it/s, loss=0.5588, mse=0.5580, lpips=0.0018][A
Epoch 88/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.18it/s, loss=0.5375, mse=0.5367, lpips=0.0017][A
Epoch 88/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  5.00it/s, loss=0.5375, mse=0.5367, lpips=0.0017][A
Epoch 88/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  5.00it/s, loss=0.5369, mse=0.5360, lpips=0.0017][A
Epoch 88/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  5.00it/s, loss=0.5711, mse=0.5702, lpips=0.0018][A
Epoch 88/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.51it/s, loss=0.5711, mse=0.5702, lpips=0.0018][A
Epoch 88/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.51it/s, loss=0.5408, mse=0.5400, lpips=0.0017][A
Epoch 88/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.51it/s, loss=0.5198, mse=0.5189, lpips=0.0017][A
Epoch 88/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.68it/s, loss=0.5198, mse=0.5189, lpips=0.0017][A
Epoch 88/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.68it/s, loss=0.5748, mse=0.5739, lpips=0.0018][AEpoch 88/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.73it/s, loss=0.5748, mse=0.5739, lpips=0.0018]

Epoch 88/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 87/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4349]

Epoch 88/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5518][A
Epoch 88/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4208][AEpoch 88 | Avg Train Loss: 0.5434 | Avg Val Loss: 0.4863
New best validation loss: 0.4863. Saving best model...
Epoch 89/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 89/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.5372, mse=0.5363, lpips=0.0017]Epoch 89/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.20s/it, loss=0.5372, mse=0.5363, lpips=0.0017]Epoch 89/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.20s/it, loss=0.5307, mse=0.5298, lpips=0.0017]Epoch 89/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.69it/s, loss=0.5307, mse=0.5298, lpips=0.0017]Epoch 89/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.69it/s, loss=0.5205, mse=0.5197, lpips=0.0017]Epoch 89/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.46it/s, loss=0.5205, mse=0.5197, lpips=0.0017]Epoch 89/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.46it/s, loss=0.4994, mse=0.4986, lpips=0.0016]Epoch 89/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.18it/s, loss=0.4994, mse=0.4986, lpips=0.0016]Epoch 89/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.18it/s, loss=0.5198, mse=0.5190, lpips=0.0017]Epoch 89/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  3.93it/s, loss=0.5198, mse=0.5190, lpips=0.0017]Epoch 89/1000 [TRAIN]:  50%|█████     | 5/10 [00:02<00:01,  3.93it/s, loss=0.5550, mse=0.5541, lpips=0.0018]Epoch 89/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.42it/s, loss=0.5550, mse=0.5541, lpips=0.0018]Epoch 89/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.42it/s, loss=0.5419, mse=0.5410, lpips=0.0017]Epoch 89/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.85it/s, loss=0.5419, mse=0.5410, lpips=0.0017]Epoch 89/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.85it/s, loss=0.5531, mse=0.5522, lpips=0.0018]Epoch 89/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  4.65it/s, loss=0.5531, mse=0.5522, lpips=0.0018]Epoch 89/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  4.65it/s, loss=0.5554, mse=0.5545, lpips=0.0018]Epoch 89/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  4.24it/s, loss=0.5554, mse=0.5545, lpips=0.0018]Epoch 89/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  4.24it/s, loss=0.5404, mse=0.5396, lpips=0.0017]Epoch 89/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.55it/s, loss=0.5404, mse=0.5396, lpips=0.0017]Epoch 89/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  3.44it/s, loss=0.5404, mse=0.5396, lpips=0.0017]
Epoch 89/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 88/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4208]
Epoch 89/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5319]Epoch 89/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5227]Epoch 89 | Avg Train Loss: 0.5353 | Avg Val Loss: 0.5273

Epoch 90/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 90/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.5668, mse=0.5659, lpips=0.0018][A
Epoch 90/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:04,  7.21s/it, loss=0.5668, mse=0.5659, lpips=0.0018][A
Epoch 90/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:04,  7.21s/it, loss=0.5771, mse=0.5762, lpips=0.0018][A
Epoch 90/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.05s/it, loss=0.5771, mse=0.5762, lpips=0.0018][A
Epoch 90/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.05s/it, loss=0.5306, mse=0.5298, lpips=0.0017][A
Epoch 90/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.72s/it, loss=0.5306, mse=0.5298, lpips=0.0017][A
Epoch 90/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.72s/it, loss=0.5420, mse=0.5411, lpips=0.0017][A
Epoch 90/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.11s/it, loss=0.5420, mse=0.5411, lpips=0.0017][A
Epoch 90/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.11s/it, loss=0.5319, mse=0.5310, lpips=0.0017][A
Epoch 90/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.30it/s, loss=0.5319, mse=0.5310, lpips=0.0017][A
Epoch 90/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.30it/s, loss=0.5268, mse=0.5260, lpips=0.0017][A
Epoch 90/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.30it/s, loss=0.5433, mse=0.5425, lpips=0.0017][A
Epoch 90/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.35it/s, loss=0.5433, mse=0.5425, lpips=0.0017][A
Epoch 90/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.35it/s, loss=0.5002, mse=0.4994, lpips=0.0016][A
Epoch 90/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.77it/s, loss=0.5002, mse=0.4994, lpips=0.0016][A
Epoch 90/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.77it/s, loss=0.5518, mse=0.5509, lpips=0.0018][A
Epoch 90/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.33it/s, loss=0.5518, mse=0.5509, lpips=0.0018][A
Epoch 90/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.33it/s, loss=0.5069, mse=0.5061, lpips=0.0016][A
Epoch 90/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  3.90it/s, loss=0.5069, mse=0.5061, lpips=0.0016][AEpoch 90/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.18it/s, loss=0.5069, mse=0.5061, lpips=0.0016]

Epoch 90/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 89/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.5227]

Epoch 90/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5104][A
Epoch 90/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4386][AEpoch 90 | Avg Train Loss: 0.5377 | Avg Val Loss: 0.4745
New best validation loss: 0.4745. Saving best model...
Saving interval checkpoint for epoch 90...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -197.1893, Max: 183.7098
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_90.png
Epoch 91/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 91/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.5163, mse=0.5155, lpips=0.0017]Epoch 91/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.22s/it, loss=0.5163, mse=0.5155, lpips=0.0017]Epoch 91/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.22s/it, loss=0.5574, mse=0.5566, lpips=0.0017]Epoch 91/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:33,  4.22s/it, loss=0.5574, mse=0.5566, lpips=0.0017]Epoch 91/1000 [TRAIN]:  20%|██        | 2/10 [00:10<00:33,  4.22s/it, loss=0.5338, mse=0.5329, lpips=0.0017]Epoch 91/1000 [TRAIN]:  20%|██        | 2/10 [00:10<00:33,  4.22s/it, loss=0.5321, mse=0.5313, lpips=0.0017]Epoch 91/1000 [TRAIN]:  40%|████      | 4/10 [00:10<00:09,  1.63s/it, loss=0.5321, mse=0.5313, lpips=0.0017]Epoch 91/1000 [TRAIN]:  40%|████      | 4/10 [00:10<00:09,  1.63s/it, loss=0.5532, mse=0.5524, lpips=0.0017]Epoch 91/1000 [TRAIN]:  40%|████      | 4/10 [00:10<00:09,  1.63s/it, loss=0.4926, mse=0.4918, lpips=0.0016]Epoch 91/1000 [TRAIN]:  60%|██████    | 6/10 [00:10<00:03,  1.11it/s, loss=0.4926, mse=0.4918, lpips=0.0016]Epoch 91/1000 [TRAIN]:  60%|██████    | 6/10 [00:10<00:03,  1.11it/s, loss=0.5172, mse=0.5164, lpips=0.0017]Epoch 91/1000 [TRAIN]:  60%|██████    | 6/10 [00:10<00:03,  1.11it/s, loss=0.5326, mse=0.5318, lpips=0.0017]Epoch 91/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:01,  1.74it/s, loss=0.5326, mse=0.5318, lpips=0.0017]Epoch 91/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:01,  1.74it/s, loss=0.5269, mse=0.5261, lpips=0.0017]Epoch 91/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:01,  1.74it/s, loss=0.5088, mse=0.5080, lpips=0.0016]Epoch 91/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  2.55it/s, loss=0.5088, mse=0.5080, lpips=0.0016]Epoch 91/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.06s/it, loss=0.5088, mse=0.5080, lpips=0.0016]
Epoch 91/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 90/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.4386]
Epoch 91/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5596]Epoch 91/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6039]Epoch 91 | Avg Train Loss: 0.5271 | Avg Val Loss: 0.5818

Epoch 92/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 92/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.5175, mse=0.5167, lpips=0.0017][A
Epoch 92/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.04s/it, loss=0.5175, mse=0.5167, lpips=0.0017][A
Epoch 92/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.04s/it, loss=0.5417, mse=0.5409, lpips=0.0017][A
Epoch 92/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.82it/s, loss=0.5417, mse=0.5409, lpips=0.0017][A
Epoch 92/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.82it/s, loss=0.5533, mse=0.5524, lpips=0.0017][A
Epoch 92/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.82it/s, loss=0.5336, mse=0.5328, lpips=0.0017][A
Epoch 92/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.83it/s, loss=0.5336, mse=0.5328, lpips=0.0017][A
Epoch 92/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.83it/s, loss=0.5235, mse=0.5227, lpips=0.0017][A
Epoch 92/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.83it/s, loss=0.5059, mse=0.5051, lpips=0.0016][A
Epoch 92/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.54it/s, loss=0.5059, mse=0.5051, lpips=0.0016][A
Epoch 92/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.54it/s, loss=0.4775, mse=0.4767, lpips=0.0016][A
Epoch 92/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.54it/s, loss=0.5697, mse=0.5688, lpips=0.0018][A
Epoch 92/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.98it/s, loss=0.5697, mse=0.5688, lpips=0.0018][A
Epoch 92/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.98it/s, loss=0.5124, mse=0.5116, lpips=0.0016][A
Epoch 92/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.98it/s, loss=0.4802, mse=0.4795, lpips=0.0016][A
Epoch 92/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  8.49it/s, loss=0.4802, mse=0.4795, lpips=0.0016][AEpoch 92/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.18it/s, loss=0.4802, mse=0.4795, lpips=0.0016]

Epoch 92/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 91/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6039]

Epoch 92/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5039][A
Epoch 92/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4474][AEpoch 92 | Avg Train Loss: 0.5215 | Avg Val Loss: 0.4757
Epoch 93/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 93/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4754, mse=0.4746, lpips=0.0015]Epoch 93/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.02s/it, loss=0.4754, mse=0.4746, lpips=0.0015]Epoch 93/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.02s/it, loss=0.5499, mse=0.5490, lpips=0.0017]Epoch 93/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.02s/it, loss=0.5197, mse=0.5189, lpips=0.0017]Epoch 93/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.04it/s, loss=0.5197, mse=0.5189, lpips=0.0017]Epoch 93/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.04it/s, loss=0.4858, mse=0.4851, lpips=0.0016]Epoch 93/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.04it/s, loss=0.5343, mse=0.5334, lpips=0.0017]Epoch 93/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.88it/s, loss=0.5343, mse=0.5334, lpips=0.0017]Epoch 93/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.88it/s, loss=0.5157, mse=0.5149, lpips=0.0016]Epoch 93/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.88it/s, loss=0.5460, mse=0.5452, lpips=0.0017]Epoch 93/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.36it/s, loss=0.5460, mse=0.5452, lpips=0.0017]Epoch 93/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.36it/s, loss=0.5077, mse=0.5069, lpips=0.0016]Epoch 93/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.36it/s, loss=0.5129, mse=0.5120, lpips=0.0016]Epoch 93/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.55it/s, loss=0.5129, mse=0.5120, lpips=0.0016]Epoch 93/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.55it/s, loss=0.6185, mse=0.6176, lpips=0.0019]Epoch 93/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.58it/s, loss=0.6185, mse=0.6176, lpips=0.0019]
Epoch 93/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 92/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4474]
Epoch 93/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5034]Epoch 93/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6994]Epoch 93 | Avg Train Loss: 0.5266 | Avg Val Loss: 0.6014

Epoch 94/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 94/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4734, mse=0.4726, lpips=0.0015][A
Epoch 94/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.12s/it, loss=0.4734, mse=0.4726, lpips=0.0015][A
Epoch 94/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.12s/it, loss=0.5350, mse=0.5341, lpips=0.0017][A
Epoch 94/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.82it/s, loss=0.5350, mse=0.5341, lpips=0.0017][A
Epoch 94/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.82it/s, loss=0.5248, mse=0.5240, lpips=0.0017][A
Epoch 94/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.65it/s, loss=0.5248, mse=0.5240, lpips=0.0017][A
Epoch 94/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.65it/s, loss=0.4893, mse=0.4885, lpips=0.0016][A
Epoch 94/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.32it/s, loss=0.4893, mse=0.4885, lpips=0.0016][A
Epoch 94/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.32it/s, loss=0.5326, mse=0.5318, lpips=0.0017][A
Epoch 94/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  3.73it/s, loss=0.5326, mse=0.5318, lpips=0.0017][A
Epoch 94/1000 [TRAIN]:  50%|█████     | 5/10 [00:02<00:01,  3.73it/s, loss=0.5245, mse=0.5237, lpips=0.0017][A
Epoch 94/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:01,  3.88it/s, loss=0.5245, mse=0.5237, lpips=0.0017][A
Epoch 94/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:01,  3.88it/s, loss=0.4957, mse=0.4949, lpips=0.0016][A
Epoch 94/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.44it/s, loss=0.4957, mse=0.4949, lpips=0.0016][A
Epoch 94/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.44it/s, loss=0.5022, mse=0.5014, lpips=0.0016][A
Epoch 94/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  4.73it/s, loss=0.5022, mse=0.5014, lpips=0.0016][A
Epoch 94/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  4.73it/s, loss=0.5278, mse=0.5270, lpips=0.0017][A
Epoch 94/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.12it/s, loss=0.5278, mse=0.5270, lpips=0.0017][A
Epoch 94/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.12it/s, loss=0.5321, mse=0.5312, lpips=0.0017][A
Epoch 94/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.03it/s, loss=0.5321, mse=0.5312, lpips=0.0017][AEpoch 94/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  3.74it/s, loss=0.5321, mse=0.5312, lpips=0.0017]

Epoch 94/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 93/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6994]

Epoch 94/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5160][A
Epoch 94/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5815][AEpoch 94 | Avg Train Loss: 0.5137 | Avg Val Loss: 0.5487
Epoch 95/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 95/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.5173, mse=0.5165, lpips=0.0016]Epoch 95/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.25s/it, loss=0.5173, mse=0.5165, lpips=0.0016]Epoch 95/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.25s/it, loss=0.5145, mse=0.5137, lpips=0.0016]Epoch 95/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.13s/it, loss=0.5145, mse=0.5137, lpips=0.0016]Epoch 95/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.13s/it, loss=0.5063, mse=0.5055, lpips=0.0016]Epoch 95/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.78s/it, loss=0.5063, mse=0.5055, lpips=0.0016]Epoch 95/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.78s/it, loss=0.5595, mse=0.5586, lpips=0.0017]Epoch 95/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.13s/it, loss=0.5595, mse=0.5586, lpips=0.0017]Epoch 95/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.13s/it, loss=0.4892, mse=0.4884, lpips=0.0016]Epoch 95/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:03,  1.27it/s, loss=0.4892, mse=0.4884, lpips=0.0016]Epoch 95/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.27it/s, loss=0.4908, mse=0.4900, lpips=0.0016]Epoch 95/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.74it/s, loss=0.4908, mse=0.4900, lpips=0.0016]Epoch 95/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.74it/s, loss=0.4983, mse=0.4975, lpips=0.0016]Epoch 95/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.27it/s, loss=0.4983, mse=0.4975, lpips=0.0016]Epoch 95/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.27it/s, loss=0.5403, mse=0.5395, lpips=0.0017]Epoch 95/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.86it/s, loss=0.5403, mse=0.5395, lpips=0.0017]Epoch 95/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.86it/s, loss=0.5199, mse=0.5191, lpips=0.0016]Epoch 95/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.40it/s, loss=0.5199, mse=0.5191, lpips=0.0016]Epoch 95/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.40it/s, loss=0.5038, mse=0.5030, lpips=0.0016]Epoch 95/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  4.04it/s, loss=0.5038, mse=0.5030, lpips=0.0016]Epoch 95/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.14it/s, loss=0.5038, mse=0.5030, lpips=0.0016]
Epoch 95/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 94/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.5815]
Epoch 95/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4919]Epoch 95/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6431]Epoch 95 | Avg Train Loss: 0.5140 | Avg Val Loss: 0.5675
Saving interval checkpoint for epoch 95...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -205.5989, Max: 182.3091
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_95.png

Epoch 96/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 96/1000 [TRAIN]:   0%|          | 0/10 [00:08<?, ?it/s, loss=0.4769, mse=0.4762, lpips=0.0015][A
Epoch 96/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:15,  8.39s/it, loss=0.4769, mse=0.4762, lpips=0.0015][A
Epoch 96/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:15,  8.39s/it, loss=0.4981, mse=0.4973, lpips=0.0016][A
Epoch 96/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.92s/it, loss=0.4981, mse=0.4973, lpips=0.0016][A
Epoch 96/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.92s/it, loss=0.5232, mse=0.5223, lpips=0.0017][A
Epoch 96/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.92s/it, loss=0.5046, mse=0.5038, lpips=0.0016][A
Epoch 96/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.52s/it, loss=0.5046, mse=0.5038, lpips=0.0016][A
Epoch 96/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.52s/it, loss=0.4877, mse=0.4869, lpips=0.0016][A
Epoch 96/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.52s/it, loss=0.5469, mse=0.5460, lpips=0.0017][A
Epoch 96/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.18it/s, loss=0.5469, mse=0.5460, lpips=0.0017][A
Epoch 96/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.18it/s, loss=0.5238, mse=0.5230, lpips=0.0017][A
Epoch 96/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.18it/s, loss=0.5338, mse=0.5330, lpips=0.0017][A
Epoch 96/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.85it/s, loss=0.5338, mse=0.5330, lpips=0.0017][A
Epoch 96/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.85it/s, loss=0.5195, mse=0.5187, lpips=0.0016][A
Epoch 96/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.85it/s, loss=0.5357, mse=0.5348, lpips=0.0017][A
Epoch 96/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  2.71it/s, loss=0.5357, mse=0.5348, lpips=0.0017][AEpoch 96/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.01it/s, loss=0.5357, mse=0.5348, lpips=0.0017]

Epoch 96/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 95/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.6431]

Epoch 96/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5296][A
Epoch 96/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5516][AEpoch 96 | Avg Train Loss: 0.5150 | Avg Val Loss: 0.5406
Epoch 97/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 97/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.5573, mse=0.5565, lpips=0.0017]Epoch 97/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:07,  1.19it/s, loss=0.5573, mse=0.5565, lpips=0.0017]Epoch 97/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:07,  1.19it/s, loss=0.5014, mse=0.5006, lpips=0.0016]Epoch 97/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.85it/s, loss=0.5014, mse=0.5006, lpips=0.0016]Epoch 97/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.85it/s, loss=0.5552, mse=0.5543, lpips=0.0017]Epoch 97/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.91it/s, loss=0.5552, mse=0.5543, lpips=0.0017]Epoch 97/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.91it/s, loss=0.4886, mse=0.4878, lpips=0.0016]Epoch 97/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.91it/s, loss=0.5295, mse=0.5287, lpips=0.0017]Epoch 97/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  5.00it/s, loss=0.5295, mse=0.5287, lpips=0.0017]Epoch 97/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  5.00it/s, loss=0.5181, mse=0.5173, lpips=0.0016]Epoch 97/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  5.00it/s, loss=0.5180, mse=0.5172, lpips=0.0016]Epoch 97/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.56it/s, loss=0.5180, mse=0.5172, lpips=0.0016]Epoch 97/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.56it/s, loss=0.4551, mse=0.4544, lpips=0.0015]Epoch 97/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.56it/s, loss=0.5647, mse=0.5639, lpips=0.0017]Epoch 97/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.81it/s, loss=0.5647, mse=0.5639, lpips=0.0017]Epoch 97/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.81it/s, loss=0.5223, mse=0.5214, lpips=0.0017]Epoch 97/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.30it/s, loss=0.5223, mse=0.5214, lpips=0.0017]
Epoch 97/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 96/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5516]
Epoch 97/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5265]Epoch 97/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5495]Epoch 97 | Avg Train Loss: 0.5210 | Avg Val Loss: 0.5380

Epoch 98/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 98/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.5147, mse=0.5139, lpips=0.0016][A
Epoch 98/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.14s/it, loss=0.5147, mse=0.5139, lpips=0.0016][A
Epoch 98/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.14s/it, loss=0.5165, mse=0.5156, lpips=0.0016][A
Epoch 98/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.14s/it, loss=0.5208, mse=0.5200, lpips=0.0016][A
Epoch 98/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.79it/s, loss=0.5208, mse=0.5200, lpips=0.0016][A
Epoch 98/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.79it/s, loss=0.5057, mse=0.5049, lpips=0.0016][A
Epoch 98/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.79it/s, loss=0.4987, mse=0.4979, lpips=0.0016][A
Epoch 98/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.52it/s, loss=0.4987, mse=0.4979, lpips=0.0016][A
Epoch 98/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.52it/s, loss=0.5256, mse=0.5248, lpips=0.0016][A
Epoch 98/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.52it/s, loss=0.5378, mse=0.5369, lpips=0.0017][A
Epoch 98/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.12it/s, loss=0.5378, mse=0.5369, lpips=0.0017][A
Epoch 98/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.12it/s, loss=0.4953, mse=0.4945, lpips=0.0016][A
Epoch 98/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.12it/s, loss=0.4881, mse=0.4873, lpips=0.0016][A
Epoch 98/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.34it/s, loss=0.4881, mse=0.4873, lpips=0.0016][A
Epoch 98/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.34it/s, loss=0.5015, mse=0.5007, lpips=0.0016][AEpoch 98/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.24it/s, loss=0.5015, mse=0.5007, lpips=0.0016]

Epoch 98/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 97/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5495]

Epoch 98/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5164][A
Epoch 98/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3650][AEpoch 98 | Avg Train Loss: 0.5105 | Avg Val Loss: 0.4407
New best validation loss: 0.4407. Saving best model...
Epoch 99/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 99/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.5327, mse=0.5319, lpips=0.0016]Epoch 99/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:08,  1.04it/s, loss=0.5327, mse=0.5319, lpips=0.0016]Epoch 99/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.04it/s, loss=0.5134, mse=0.5126, lpips=0.0016]Epoch 99/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.72it/s, loss=0.5134, mse=0.5126, lpips=0.0016]Epoch 99/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.72it/s, loss=0.5122, mse=0.5114, lpips=0.0016]Epoch 99/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.43it/s, loss=0.5122, mse=0.5114, lpips=0.0016]Epoch 99/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.43it/s, loss=0.4843, mse=0.4836, lpips=0.0015]Epoch 99/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:02,  3.00it/s, loss=0.4843, mse=0.4836, lpips=0.0015]Epoch 99/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:02,  3.00it/s, loss=0.4719, mse=0.4711, lpips=0.0015]Epoch 99/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  3.69it/s, loss=0.4719, mse=0.4711, lpips=0.0015]Epoch 99/1000 [TRAIN]:  50%|█████     | 5/10 [00:02<00:01,  3.69it/s, loss=0.5230, mse=0.5222, lpips=0.0016]Epoch 99/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.29it/s, loss=0.5230, mse=0.5222, lpips=0.0016]Epoch 99/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.29it/s, loss=0.5112, mse=0.5104, lpips=0.0016]Epoch 99/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.92it/s, loss=0.5112, mse=0.5104, lpips=0.0016]Epoch 99/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.92it/s, loss=0.5262, mse=0.5253, lpips=0.0016]Epoch 99/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.06it/s, loss=0.5262, mse=0.5253, lpips=0.0016]Epoch 99/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.06it/s, loss=0.4789, mse=0.4781, lpips=0.0015]Epoch 99/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.33it/s, loss=0.4789, mse=0.4781, lpips=0.0015]Epoch 99/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.33it/s, loss=0.5093, mse=0.5085, lpips=0.0016]Epoch 99/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.13it/s, loss=0.5093, mse=0.5085, lpips=0.0016]Epoch 99/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  3.81it/s, loss=0.5093, mse=0.5085, lpips=0.0016]
Epoch 99/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 98/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.3650]
Epoch 99/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5293]Epoch 99/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5878]Epoch 99 | Avg Train Loss: 0.5063 | Avg Val Loss: 0.5586

Epoch 100/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 100/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.4940, mse=0.4932, lpips=0.0016][A
Epoch 100/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.30s/it, loss=0.4940, mse=0.4932, lpips=0.0016][A
Epoch 100/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.30s/it, loss=0.5158, mse=0.5150, lpips=0.0016][A
Epoch 100/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.30s/it, loss=0.4864, mse=0.4856, lpips=0.0015][A
Epoch 100/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:13,  1.96s/it, loss=0.4864, mse=0.4856, lpips=0.0015][A
Epoch 100/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:13,  1.96s/it, loss=0.4604, mse=0.4597, lpips=0.0015][A
Epoch 100/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:08,  1.35s/it, loss=0.4604, mse=0.4597, lpips=0.0015][A
Epoch 100/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:08,  1.35s/it, loss=0.4941, mse=0.4934, lpips=0.0016][A
Epoch 100/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:04,  1.05it/s, loss=0.4941, mse=0.4934, lpips=0.0016][A
Epoch 100/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:04,  1.05it/s, loss=0.4994, mse=0.4986, lpips=0.0016][A
Epoch 100/1000 [TRAIN]:  60%|██████    | 6/10 [00:07<00:02,  1.44it/s, loss=0.4994, mse=0.4986, lpips=0.0016][A
Epoch 100/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.44it/s, loss=0.4982, mse=0.4974, lpips=0.0016][A
Epoch 100/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.89it/s, loss=0.4982, mse=0.4974, lpips=0.0016][A
Epoch 100/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.89it/s, loss=0.5176, mse=0.5168, lpips=0.0016][A
Epoch 100/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.37it/s, loss=0.5176, mse=0.5168, lpips=0.0016][A
Epoch 100/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.37it/s, loss=0.5092, mse=0.5084, lpips=0.0016][A
Epoch 100/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.99it/s, loss=0.5092, mse=0.5084, lpips=0.0016][A
Epoch 100/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.99it/s, loss=0.4544, mse=0.4536, lpips=0.0015][A
Epoch 100/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  3.70it/s, loss=0.4544, mse=0.4536, lpips=0.0015][AEpoch 100/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.16it/s, loss=0.4544, mse=0.4536, lpips=0.0015]

Epoch 100/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 99/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.5878]

Epoch 100/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5314][A
Epoch 100/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4993][AEpoch 100 | Avg Train Loss: 0.4929 | Avg Val Loss: 0.5154
Saving interval checkpoint for epoch 100...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -173.5998, Max: 194.5042
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_100.png
Epoch 101/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 101/1000 [TRAIN]:   0%|          | 0/10 [00:08<?, ?it/s, loss=0.5043, mse=0.5035, lpips=0.0016]Epoch 101/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:12,  8.01s/it, loss=0.5043, mse=0.5035, lpips=0.0016]Epoch 101/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:12,  8.01s/it, loss=0.4971, mse=0.4963, lpips=0.0016]Epoch 101/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.91s/it, loss=0.4971, mse=0.4963, lpips=0.0016]Epoch 101/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.91s/it, loss=0.4983, mse=0.4975, lpips=0.0016]Epoch 101/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:31,  3.91s/it, loss=0.5142, mse=0.5134, lpips=0.0016]Epoch 101/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.52s/it, loss=0.5142, mse=0.5134, lpips=0.0016]Epoch 101/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.52s/it, loss=0.4863, mse=0.4855, lpips=0.0015]Epoch 101/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:09,  1.52s/it, loss=0.4778, mse=0.4770, lpips=0.0015]Epoch 101/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.19it/s, loss=0.4778, mse=0.4770, lpips=0.0015]Epoch 101/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.19it/s, loss=0.5264, mse=0.5255, lpips=0.0016]Epoch 101/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.19it/s, loss=0.5289, mse=0.5281, lpips=0.0016]Epoch 101/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.86it/s, loss=0.5289, mse=0.5281, lpips=0.0016]Epoch 101/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.86it/s, loss=0.4747, mse=0.4739, lpips=0.0015]Epoch 101/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.86it/s, loss=0.4436, mse=0.4429, lpips=0.0014]Epoch 101/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  2.72it/s, loss=0.4436, mse=0.4429, lpips=0.0014]Epoch 101/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.03it/s, loss=0.4436, mse=0.4429, lpips=0.0014]
Epoch 101/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 100/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.4993]
Epoch 101/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4592]Epoch 101/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5748]Epoch 101 | Avg Train Loss: 0.4952 | Avg Val Loss: 0.5170

Epoch 102/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 102/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4934, mse=0.4927, lpips=0.0016][A
Epoch 102/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.02s/it, loss=0.4934, mse=0.4927, lpips=0.0016][A
Epoch 102/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.02s/it, loss=0.4900, mse=0.4893, lpips=0.0016][A
Epoch 102/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.92it/s, loss=0.4900, mse=0.4893, lpips=0.0016][A
Epoch 102/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.92it/s, loss=0.5203, mse=0.5195, lpips=0.0016][A
Epoch 102/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.92it/s, loss=0.4901, mse=0.4894, lpips=0.0015][A
Epoch 102/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.95it/s, loss=0.4901, mse=0.4894, lpips=0.0015][A
Epoch 102/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.95it/s, loss=0.4669, mse=0.4662, lpips=0.0015][A
Epoch 102/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.95it/s, loss=0.5243, mse=0.5235, lpips=0.0016][A
Epoch 102/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.70it/s, loss=0.5243, mse=0.5235, lpips=0.0016][A
Epoch 102/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.70it/s, loss=0.5240, mse=0.5232, lpips=0.0016][A
Epoch 102/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.70it/s, loss=0.5100, mse=0.5092, lpips=0.0016][A
Epoch 102/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.08it/s, loss=0.5100, mse=0.5092, lpips=0.0016][A
Epoch 102/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.08it/s, loss=0.4877, mse=0.4869, lpips=0.0015][A
Epoch 102/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.08it/s, loss=0.4700, mse=0.4692, lpips=0.0015][A
Epoch 102/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  8.58it/s, loss=0.4700, mse=0.4692, lpips=0.0015][AEpoch 102/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.31it/s, loss=0.4700, mse=0.4692, lpips=0.0015]

Epoch 102/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 101/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5748]

Epoch 102/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5021][A
Epoch 102/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5739][AEpoch 102 | Avg Train Loss: 0.4977 | Avg Val Loss: 0.5380
Epoch 103/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 103/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.5496, mse=0.5487, lpips=0.0017]Epoch 103/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:08,  1.03it/s, loss=0.5496, mse=0.5487, lpips=0.0017]Epoch 103/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.03it/s, loss=0.4716, mse=0.4709, lpips=0.0015]Epoch 103/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.03it/s, loss=0.5535, mse=0.5526, lpips=0.0017]Epoch 103/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.12it/s, loss=0.5535, mse=0.5526, lpips=0.0017]Epoch 103/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.12it/s, loss=0.5418, mse=0.5410, lpips=0.0017]Epoch 103/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.12it/s, loss=0.5037, mse=0.5029, lpips=0.0016]Epoch 103/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.95it/s, loss=0.5037, mse=0.5029, lpips=0.0016]Epoch 103/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.95it/s, loss=0.4934, mse=0.4927, lpips=0.0016]Epoch 103/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.95it/s, loss=0.4932, mse=0.4924, lpips=0.0016]Epoch 103/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.47it/s, loss=0.4932, mse=0.4924, lpips=0.0016]Epoch 103/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.47it/s, loss=0.4928, mse=0.4920, lpips=0.0015]Epoch 103/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.47it/s, loss=0.4885, mse=0.4878, lpips=0.0015]Epoch 103/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.70it/s, loss=0.4885, mse=0.4878, lpips=0.0015]Epoch 103/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.70it/s, loss=0.4570, mse=0.4563, lpips=0.0015]Epoch 103/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.70it/s, loss=0.4570, mse=0.4563, lpips=0.0015]
Epoch 103/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 102/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5739]
Epoch 103/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4925]Epoch 103/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5517]Epoch 103 | Avg Train Loss: 0.5045 | Avg Val Loss: 0.5221

Epoch 104/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 104/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4780, mse=0.4772, lpips=0.0015][A
Epoch 104/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.09s/it, loss=0.4780, mse=0.4772, lpips=0.0015][A
Epoch 104/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.09s/it, loss=0.4939, mse=0.4931, lpips=0.0016][A
Epoch 104/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.89it/s, loss=0.4939, mse=0.4931, lpips=0.0016][A
Epoch 104/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.89it/s, loss=0.4472, mse=0.4465, lpips=0.0014][A
Epoch 104/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.70it/s, loss=0.4472, mse=0.4465, lpips=0.0014][A
Epoch 104/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.70it/s, loss=0.5105, mse=0.5097, lpips=0.0016][A
Epoch 104/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.53it/s, loss=0.5105, mse=0.5097, lpips=0.0016][A
Epoch 104/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.53it/s, loss=0.4958, mse=0.4950, lpips=0.0015][A
Epoch 104/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.20it/s, loss=0.4958, mse=0.4950, lpips=0.0015][A
Epoch 104/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.20it/s, loss=0.4954, mse=0.4947, lpips=0.0015][A
Epoch 104/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.62it/s, loss=0.4954, mse=0.4947, lpips=0.0015][A
Epoch 104/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.62it/s, loss=0.5357, mse=0.5348, lpips=0.0016][A
Epoch 104/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.02it/s, loss=0.5357, mse=0.5348, lpips=0.0016][A
Epoch 104/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.02it/s, loss=0.4605, mse=0.4598, lpips=0.0015][A
Epoch 104/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.33it/s, loss=0.4605, mse=0.4598, lpips=0.0015][A
Epoch 104/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.33it/s, loss=0.4777, mse=0.4769, lpips=0.0015][A
Epoch 104/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.57it/s, loss=0.4777, mse=0.4769, lpips=0.0015][A
Epoch 104/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.57it/s, loss=0.4640, mse=0.4633, lpips=0.0015][A
Epoch 104/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.12it/s, loss=0.4640, mse=0.4633, lpips=0.0015][AEpoch 104/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  3.99it/s, loss=0.4640, mse=0.4633, lpips=0.0015]

Epoch 104/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 103/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5517]

Epoch 104/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5491][A
Epoch 104/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.3375][AEpoch 104 | Avg Train Loss: 0.4859 | Avg Val Loss: 0.4433
Epoch 105/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 105/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.5109, mse=0.5101, lpips=0.0016]Epoch 105/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.76s/it, loss=0.5109, mse=0.5101, lpips=0.0016]Epoch 105/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.76s/it, loss=0.5200, mse=0.5192, lpips=0.0016]Epoch 105/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:26,  3.29s/it, loss=0.5200, mse=0.5192, lpips=0.0016]Epoch 105/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:26,  3.29s/it, loss=0.4856, mse=0.4848, lpips=0.0015]Epoch 105/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:13,  1.87s/it, loss=0.4856, mse=0.4848, lpips=0.0015]Epoch 105/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:13,  1.87s/it, loss=0.4698, mse=0.4690, lpips=0.0015]Epoch 105/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.19s/it, loss=0.4698, mse=0.4690, lpips=0.0015]Epoch 105/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.19s/it, loss=0.4624, mse=0.4616, lpips=0.0015]Epoch 105/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.4624, mse=0.4616, lpips=0.0015]Epoch 105/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.4376, mse=0.4369, lpips=0.0014]Epoch 105/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.67it/s, loss=0.4376, mse=0.4369, lpips=0.0014]Epoch 105/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.67it/s, loss=0.4469, mse=0.4462, lpips=0.0014]Epoch 105/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.67it/s, loss=0.4539, mse=0.4531, lpips=0.0014]Epoch 105/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.90it/s, loss=0.4539, mse=0.4531, lpips=0.0014]Epoch 105/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.90it/s, loss=0.4882, mse=0.4874, lpips=0.0015]Epoch 105/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.90it/s, loss=0.4478, mse=0.4471, lpips=0.0014]Epoch 105/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  4.07it/s, loss=0.4478, mse=0.4471, lpips=0.0014]Epoch 105/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.12it/s, loss=0.4478, mse=0.4471, lpips=0.0014]
Epoch 105/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 104/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.3375]
Epoch 105/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4978]Epoch 105/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6180]Epoch 105 | Avg Train Loss: 0.4723 | Avg Val Loss: 0.5579
Saving interval checkpoint for epoch 105...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -188.6456, Max: 175.2633
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_105.png

Epoch 106/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 106/1000 [TRAIN]:   0%|          | 0/10 [00:08<?, ?it/s, loss=0.5326, mse=0.5317, lpips=0.0016][A
Epoch 106/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:18,  8.77s/it, loss=0.5326, mse=0.5317, lpips=0.0016][A
Epoch 106/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:18,  8.77s/it, loss=0.5247, mse=0.5239, lpips=0.0016][A
Epoch 106/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:29,  3.67s/it, loss=0.5247, mse=0.5239, lpips=0.0016][A
Epoch 106/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:29,  3.67s/it, loss=0.5176, mse=0.5168, lpips=0.0016][A
Epoch 106/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:29,  3.67s/it, loss=0.4997, mse=0.4989, lpips=0.0016][A
Epoch 106/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.43s/it, loss=0.4997, mse=0.4989, lpips=0.0016][A
Epoch 106/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.43s/it, loss=0.5136, mse=0.5128, lpips=0.0016][A
Epoch 106/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.43s/it, loss=0.4735, mse=0.4728, lpips=0.0015][A
Epoch 106/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.26it/s, loss=0.4735, mse=0.4728, lpips=0.0015][A
Epoch 106/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.26it/s, loss=0.6026, mse=0.6017, lpips=0.0018][A
Epoch 106/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.26it/s, loss=0.5250, mse=0.5242, lpips=0.0016][A
Epoch 106/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.96it/s, loss=0.5250, mse=0.5242, lpips=0.0016][A
Epoch 106/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.96it/s, loss=0.4999, mse=0.4991, lpips=0.0015][A
Epoch 106/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.96it/s, loss=0.5213, mse=0.5205, lpips=0.0016][A
Epoch 106/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  2.84it/s, loss=0.5213, mse=0.5205, lpips=0.0016][AEpoch 106/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.05it/s, loss=0.5213, mse=0.5205, lpips=0.0016]

Epoch 106/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 105/1000 [VAL]:   0%|          | 0/2 [00:14<?, ?it/s, loss=0.6180]

Epoch 106/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4956][A
Epoch 106/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.7175][AEpoch 106 | Avg Train Loss: 0.5210 | Avg Val Loss: 0.6065
Epoch 107/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 107/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4961, mse=0.4953, lpips=0.0015]Epoch 107/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.31s/it, loss=0.4961, mse=0.4953, lpips=0.0015]Epoch 107/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.31s/it, loss=0.4562, mse=0.4554, lpips=0.0014]Epoch 107/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.31s/it, loss=0.4683, mse=0.4675, lpips=0.0015]Epoch 107/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.51it/s, loss=0.4683, mse=0.4675, lpips=0.0015]Epoch 107/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.51it/s, loss=0.4605, mse=0.4598, lpips=0.0015]Epoch 107/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.51it/s, loss=0.4633, mse=0.4626, lpips=0.0015]Epoch 107/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.17it/s, loss=0.4633, mse=0.4626, lpips=0.0015]Epoch 107/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.17it/s, loss=0.5035, mse=0.5028, lpips=0.0016]Epoch 107/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.17it/s, loss=0.4718, mse=0.4710, lpips=0.0015]Epoch 107/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.62it/s, loss=0.4718, mse=0.4710, lpips=0.0015]Epoch 107/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.62it/s, loss=0.5290, mse=0.5282, lpips=0.0016]Epoch 107/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.62it/s, loss=0.5417, mse=0.5409, lpips=0.0016]Epoch 107/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  6.93it/s, loss=0.5417, mse=0.5409, lpips=0.0016]Epoch 107/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  6.93it/s, loss=0.4250, mse=0.4243, lpips=0.0014]Epoch 107/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.81it/s, loss=0.4250, mse=0.4243, lpips=0.0014]
Epoch 107/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 106/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.7175]
Epoch 107/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5099]Epoch 107/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4315]Epoch 107 | Avg Train Loss: 0.4815 | Avg Val Loss: 0.4707

Epoch 108/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 108/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.5009, mse=0.5001, lpips=0.0015][A
Epoch 108/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:08,  1.11it/s, loss=0.5009, mse=0.5001, lpips=0.0015][A
Epoch 108/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.11it/s, loss=0.4885, mse=0.4877, lpips=0.0015][A
Epoch 108/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.09it/s, loss=0.4885, mse=0.4877, lpips=0.0015][A
Epoch 108/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.09it/s, loss=0.4812, mse=0.4805, lpips=0.0015][A
Epoch 108/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.09it/s, loss=0.5019, mse=0.5011, lpips=0.0016][A
Epoch 108/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.32it/s, loss=0.5019, mse=0.5011, lpips=0.0016][A
Epoch 108/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.32it/s, loss=0.4617, mse=0.4610, lpips=0.0015][A
Epoch 108/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.32it/s, loss=0.4981, mse=0.4973, lpips=0.0015][A
Epoch 108/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  6.04it/s, loss=0.4981, mse=0.4973, lpips=0.0015][A
Epoch 108/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  6.04it/s, loss=0.4681, mse=0.4673, lpips=0.0015][A
Epoch 108/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  6.04it/s, loss=0.5131, mse=0.5124, lpips=0.0016][A
Epoch 108/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.38it/s, loss=0.5131, mse=0.5124, lpips=0.0016][A
Epoch 108/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.38it/s, loss=0.4698, mse=0.4691, lpips=0.0015][A
Epoch 108/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.38it/s, loss=0.5022, mse=0.5015, lpips=0.0016][A
Epoch 108/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  8.68it/s, loss=0.5022, mse=0.5015, lpips=0.0016][AEpoch 108/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.62it/s, loss=0.5022, mse=0.5015, lpips=0.0016]

Epoch 108/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 107/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4315]

Epoch 108/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4513][A
Epoch 108/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3980][AEpoch 108 | Avg Train Loss: 0.4886 | Avg Val Loss: 0.4246
New best validation loss: 0.4246. Saving best model...
Epoch 109/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 109/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4950, mse=0.4943, lpips=0.0015]Epoch 109/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.06s/it, loss=0.4950, mse=0.4943, lpips=0.0015]Epoch 109/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.06s/it, loss=0.5200, mse=0.5192, lpips=0.0016]Epoch 109/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.06s/it, loss=0.4826, mse=0.4819, lpips=0.0015]Epoch 109/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.94it/s, loss=0.4826, mse=0.4819, lpips=0.0015]Epoch 109/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.94it/s, loss=0.4946, mse=0.4938, lpips=0.0015]Epoch 109/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.57it/s, loss=0.4946, mse=0.4938, lpips=0.0015]Epoch 109/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.57it/s, loss=0.4947, mse=0.4939, lpips=0.0015]Epoch 109/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.14it/s, loss=0.4947, mse=0.4939, lpips=0.0015]Epoch 109/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.14it/s, loss=0.4824, mse=0.4817, lpips=0.0015]Epoch 109/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.48it/s, loss=0.4824, mse=0.4817, lpips=0.0015]Epoch 109/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.48it/s, loss=0.4881, mse=0.4873, lpips=0.0015]Epoch 109/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.08it/s, loss=0.4881, mse=0.4873, lpips=0.0015]Epoch 109/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.08it/s, loss=0.4829, mse=0.4822, lpips=0.0015]Epoch 109/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  4.78it/s, loss=0.4829, mse=0.4822, lpips=0.0015]Epoch 109/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  4.78it/s, loss=0.5137, mse=0.5129, lpips=0.0016]Epoch 109/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.05it/s, loss=0.5137, mse=0.5129, lpips=0.0016]Epoch 109/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.05it/s, loss=0.4565, mse=0.4558, lpips=0.0015]Epoch 109/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  5.63it/s, loss=0.4565, mse=0.4558, lpips=0.0015]Epoch 109/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.11it/s, loss=0.4565, mse=0.4558, lpips=0.0015]
Epoch 109/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 108/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.3980]
Epoch 109/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5052]Epoch 109/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.3865]Epoch 109 | Avg Train Loss: 0.4911 | Avg Val Loss: 0.4458

Epoch 110/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 110/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.4794, mse=0.4786, lpips=0.0015][A
Epoch 110/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.55s/it, loss=0.4794, mse=0.4786, lpips=0.0015][A
Epoch 110/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.55s/it, loss=0.4684, mse=0.4677, lpips=0.0015][A
Epoch 110/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.19s/it, loss=0.4684, mse=0.4677, lpips=0.0015][A
Epoch 110/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.19s/it, loss=0.4429, mse=0.4422, lpips=0.0014][A
Epoch 110/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.82s/it, loss=0.4429, mse=0.4422, lpips=0.0014][A
Epoch 110/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.82s/it, loss=0.4923, mse=0.4916, lpips=0.0015][A
Epoch 110/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.19s/it, loss=0.4923, mse=0.4916, lpips=0.0015][A
Epoch 110/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.19s/it, loss=0.4675, mse=0.4668, lpips=0.0015][A
Epoch 110/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.4675, mse=0.4668, lpips=0.0015][A
Epoch 110/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.4678, mse=0.4671, lpips=0.0015][A
Epoch 110/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.68it/s, loss=0.4678, mse=0.4671, lpips=0.0015][A
Epoch 110/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.68it/s, loss=0.5163, mse=0.5155, lpips=0.0016][A
Epoch 110/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.17it/s, loss=0.5163, mse=0.5155, lpips=0.0016][A
Epoch 110/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.17it/s, loss=0.5079, mse=0.5071, lpips=0.0016][A
Epoch 110/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.78it/s, loss=0.5079, mse=0.5071, lpips=0.0016][A
Epoch 110/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.78it/s, loss=0.4848, mse=0.4840, lpips=0.0015][A
Epoch 110/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.34it/s, loss=0.4848, mse=0.4840, lpips=0.0015][A
Epoch 110/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  3.34it/s, loss=0.4977, mse=0.4969, lpips=0.0016][A
Epoch 110/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  4.09it/s, loss=0.4977, mse=0.4969, lpips=0.0016][AEpoch 110/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.11it/s, loss=0.4977, mse=0.4969, lpips=0.0016]

Epoch 110/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 109/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.3865]

Epoch 110/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5045][A
Epoch 110/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4882][AEpoch 110 | Avg Train Loss: 0.4825 | Avg Val Loss: 0.4964
Saving interval checkpoint for epoch 110...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -191.3028, Max: 164.4056
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_110.png
Epoch 111/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 111/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.4897, mse=0.4890, lpips=0.0015]Epoch 111/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:22,  9.15s/it, loss=0.4897, mse=0.4890, lpips=0.0015]Epoch 111/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:22,  9.15s/it, loss=0.4914, mse=0.4907, lpips=0.0015]Epoch 111/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:22,  9.15s/it, loss=0.5058, mse=0.5051, lpips=0.0015]Epoch 111/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.44s/it, loss=0.5058, mse=0.5051, lpips=0.0015]Epoch 111/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.44s/it, loss=0.4783, mse=0.4776, lpips=0.0015]Epoch 111/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.44s/it, loss=0.5107, mse=0.5099, lpips=0.0016]Epoch 111/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.23s/it, loss=0.5107, mse=0.5099, lpips=0.0016]Epoch 111/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.23s/it, loss=0.4248, mse=0.4241, lpips=0.0014]Epoch 111/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.23s/it, loss=0.4885, mse=0.4878, lpips=0.0015]Epoch 111/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.34it/s, loss=0.4885, mse=0.4878, lpips=0.0015]Epoch 111/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.34it/s, loss=0.4498, mse=0.4491, lpips=0.0014]Epoch 111/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.34it/s, loss=0.4717, mse=0.4710, lpips=0.0015]Epoch 111/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.00it/s, loss=0.4717, mse=0.4710, lpips=0.0015]Epoch 111/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.00it/s, loss=0.4133, mse=0.4127, lpips=0.0013]Epoch 111/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.01it/s, loss=0.4133, mse=0.4127, lpips=0.0013]
Epoch 111/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 110/1000 [VAL]:   0%|          | 0/2 [00:14<?, ?it/s, loss=0.4882]
Epoch 111/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5017]Epoch 111/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3786]Epoch 111 | Avg Train Loss: 0.4724 | Avg Val Loss: 0.4401

Epoch 112/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 112/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.4577, mse=0.4570, lpips=0.0014][A
Epoch 112/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:08,  1.04it/s, loss=0.4577, mse=0.4570, lpips=0.0014][A
Epoch 112/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.04it/s, loss=0.4720, mse=0.4713, lpips=0.0015][A
Epoch 112/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.04it/s, loss=0.5171, mse=0.5163, lpips=0.0016][A
Epoch 112/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.16it/s, loss=0.5171, mse=0.5163, lpips=0.0016][A
Epoch 112/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.16it/s, loss=0.4998, mse=0.4991, lpips=0.0015][A
Epoch 112/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.16it/s, loss=0.4505, mse=0.4498, lpips=0.0014][A
Epoch 112/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:00,  5.03it/s, loss=0.4505, mse=0.4498, lpips=0.0014][A
Epoch 112/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:00,  5.03it/s, loss=0.4726, mse=0.4719, lpips=0.0015][A
Epoch 112/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.71it/s, loss=0.4726, mse=0.4719, lpips=0.0015][A
Epoch 112/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.71it/s, loss=0.4727, mse=0.4720, lpips=0.0015][A
Epoch 112/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.71it/s, loss=0.4465, mse=0.4458, lpips=0.0014][A
Epoch 112/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.39it/s, loss=0.4465, mse=0.4458, lpips=0.0014][A
Epoch 112/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.39it/s, loss=0.4739, mse=0.4732, lpips=0.0015][A
Epoch 112/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.39it/s, loss=0.4775, mse=0.4767, lpips=0.0015][A
Epoch 112/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  8.97it/s, loss=0.4775, mse=0.4767, lpips=0.0015][AEpoch 112/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.74it/s, loss=0.4775, mse=0.4767, lpips=0.0015]

Epoch 112/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 111/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.3786]

Epoch 112/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4611][A
Epoch 112/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5177][AEpoch 112 | Avg Train Loss: 0.4740 | Avg Val Loss: 0.4894
Epoch 113/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 113/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4953, mse=0.4945, lpips=0.0015]Epoch 113/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.05s/it, loss=0.4953, mse=0.4945, lpips=0.0015]Epoch 113/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.05s/it, loss=0.4963, mse=0.4955, lpips=0.0015]Epoch 113/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.05s/it, loss=0.4838, mse=0.4830, lpips=0.0015]Epoch 113/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.94it/s, loss=0.4838, mse=0.4830, lpips=0.0015]Epoch 113/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.94it/s, loss=0.4499, mse=0.4492, lpips=0.0014]Epoch 113/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.94it/s, loss=0.4714, mse=0.4706, lpips=0.0015]Epoch 113/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.75it/s, loss=0.4714, mse=0.4706, lpips=0.0015]Epoch 113/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.75it/s, loss=0.4591, mse=0.4584, lpips=0.0014]Epoch 113/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.75it/s, loss=0.4745, mse=0.4738, lpips=0.0015]Epoch 113/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.36it/s, loss=0.4745, mse=0.4738, lpips=0.0015]Epoch 113/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.36it/s, loss=0.4188, mse=0.4181, lpips=0.0013]Epoch 113/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.36it/s, loss=0.4533, mse=0.4525, lpips=0.0014]Epoch 113/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.51it/s, loss=0.4533, mse=0.4525, lpips=0.0014]Epoch 113/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.51it/s, loss=0.4949, mse=0.4941, lpips=0.0015]Epoch 113/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.44it/s, loss=0.4949, mse=0.4941, lpips=0.0015]
Epoch 113/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 112/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5177]
Epoch 113/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4851]Epoch 113/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5115]Epoch 113 | Avg Train Loss: 0.4697 | Avg Val Loss: 0.4983

Epoch 114/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 114/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.5482, mse=0.5473, lpips=0.0016][A
Epoch 114/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.11s/it, loss=0.5482, mse=0.5473, lpips=0.0016][A
Epoch 114/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.11s/it, loss=0.4905, mse=0.4898, lpips=0.0015][A
Epoch 114/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.11s/it, loss=0.4847, mse=0.4839, lpips=0.0015][A
Epoch 114/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.81it/s, loss=0.4847, mse=0.4839, lpips=0.0015][A
Epoch 114/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.81it/s, loss=0.3925, mse=0.3918, lpips=0.0013][A
Epoch 114/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.81it/s, loss=0.4525, mse=0.4518, lpips=0.0014][A
Epoch 114/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.60it/s, loss=0.4525, mse=0.4518, lpips=0.0014][A
Epoch 114/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.60it/s, loss=0.4755, mse=0.4748, lpips=0.0015][A
Epoch 114/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.60it/s, loss=0.5062, mse=0.5055, lpips=0.0016][A
Epoch 114/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.22it/s, loss=0.5062, mse=0.5055, lpips=0.0016][A
Epoch 114/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.22it/s, loss=0.4674, mse=0.4667, lpips=0.0015][A
Epoch 114/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.22it/s, loss=0.4985, mse=0.4977, lpips=0.0015][A
Epoch 114/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  6.19it/s, loss=0.4985, mse=0.4977, lpips=0.0015][A
Epoch 114/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  6.19it/s, loss=0.4445, mse=0.4438, lpips=0.0014][A
Epoch 114/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.50it/s, loss=0.4445, mse=0.4438, lpips=0.0014][AEpoch 114/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.79it/s, loss=0.4445, mse=0.4438, lpips=0.0014]

Epoch 114/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 113/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5115]

Epoch 114/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4403][A
Epoch 114/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.3932][AEpoch 114 | Avg Train Loss: 0.4761 | Avg Val Loss: 0.4167
New best validation loss: 0.4167. Saving best model...
Epoch 115/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 115/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.4530, mse=0.4523, lpips=0.0014]Epoch 115/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.54s/it, loss=0.4530, mse=0.4523, lpips=0.0014]Epoch 115/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.54s/it, loss=0.4574, mse=0.4567, lpips=0.0014]Epoch 115/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.54s/it, loss=0.4274, mse=0.4267, lpips=0.0013]Epoch 115/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:14,  2.02s/it, loss=0.4274, mse=0.4267, lpips=0.0013]Epoch 115/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:14,  2.02s/it, loss=0.4968, mse=0.4961, lpips=0.0015]Epoch 115/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:14,  2.02s/it, loss=0.4490, mse=0.4483, lpips=0.0014]Epoch 115/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:05,  1.03s/it, loss=0.4490, mse=0.4483, lpips=0.0014]Epoch 115/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.03s/it, loss=0.4727, mse=0.4720, lpips=0.0015]Epoch 115/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:03,  1.27it/s, loss=0.4727, mse=0.4720, lpips=0.0015]Epoch 115/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:03,  1.27it/s, loss=0.4466, mse=0.4459, lpips=0.0014]Epoch 115/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.62it/s, loss=0.4466, mse=0.4459, lpips=0.0014]Epoch 115/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.62it/s, loss=0.5231, mse=0.5224, lpips=0.0016]Epoch 115/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:01,  1.97it/s, loss=0.5231, mse=0.5224, lpips=0.0016]Epoch 115/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:01,  1.97it/s, loss=0.4265, mse=0.4259, lpips=0.0014]Epoch 115/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.44it/s, loss=0.4265, mse=0.4259, lpips=0.0014]Epoch 115/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.44it/s, loss=0.4420, mse=0.4413, lpips=0.0014]Epoch 115/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  3.03it/s, loss=0.4420, mse=0.4413, lpips=0.0014]Epoch 115/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.14it/s, loss=0.4420, mse=0.4413, lpips=0.0014]
Epoch 115/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 114/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.3932]
Epoch 115/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5009]Epoch 115/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4520]Epoch 115 | Avg Train Loss: 0.4595 | Avg Val Loss: 0.4765
Saving interval checkpoint for epoch 115...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -165.1656, Max: 188.0647
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_115.png

Epoch 116/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 116/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.4618, mse=0.4611, lpips=0.0014][A
Epoch 116/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.24s/it, loss=0.4618, mse=0.4611, lpips=0.0014][A
Epoch 116/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.24s/it, loss=0.5066, mse=0.5058, lpips=0.0015][A
Epoch 116/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.24s/it, loss=0.4669, mse=0.4661, lpips=0.0014][A
Epoch 116/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.46s/it, loss=0.4669, mse=0.4661, lpips=0.0014][A
Epoch 116/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.46s/it, loss=0.4822, mse=0.4814, lpips=0.0015][A
Epoch 116/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.46s/it, loss=0.4303, mse=0.4296, lpips=0.0014][A
Epoch 116/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.4303, mse=0.4296, lpips=0.0014][A
Epoch 116/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.4753, mse=0.4746, lpips=0.0015][A
Epoch 116/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.4397, mse=0.4390, lpips=0.0014][A
Epoch 116/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.33it/s, loss=0.4397, mse=0.4390, lpips=0.0014][A
Epoch 116/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.33it/s, loss=0.4684, mse=0.4676, lpips=0.0015][A
Epoch 116/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.33it/s, loss=0.4507, mse=0.4499, lpips=0.0014][A
Epoch 116/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  1.99it/s, loss=0.4507, mse=0.4499, lpips=0.0014][A
Epoch 116/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  1.99it/s, loss=0.4820, mse=0.4812, lpips=0.0015][AEpoch 116/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.00it/s, loss=0.4820, mse=0.4812, lpips=0.0015]

Epoch 116/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 115/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.4520]

Epoch 116/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4430][A
Epoch 116/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4719][AEpoch 116 | Avg Train Loss: 0.4664 | Avg Val Loss: 0.4574
Epoch 117/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 117/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4519, mse=0.4512, lpips=0.0014]Epoch 117/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.05s/it, loss=0.4519, mse=0.4512, lpips=0.0014]Epoch 117/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.05s/it, loss=0.4407, mse=0.4400, lpips=0.0014]Epoch 117/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.05s/it, loss=0.5132, mse=0.5125, lpips=0.0016]Epoch 117/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.95it/s, loss=0.5132, mse=0.5125, lpips=0.0016]Epoch 117/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.95it/s, loss=0.5307, mse=0.5299, lpips=0.0016]Epoch 117/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.95it/s, loss=0.4955, mse=0.4948, lpips=0.0015]Epoch 117/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.74it/s, loss=0.4955, mse=0.4948, lpips=0.0015]Epoch 117/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.74it/s, loss=0.4572, mse=0.4565, lpips=0.0014]Epoch 117/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.74it/s, loss=0.4563, mse=0.4556, lpips=0.0014]Epoch 117/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.33it/s, loss=0.4563, mse=0.4556, lpips=0.0014]Epoch 117/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.33it/s, loss=0.4945, mse=0.4937, lpips=0.0015]Epoch 117/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.33it/s, loss=0.4672, mse=0.4665, lpips=0.0014]Epoch 117/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.54it/s, loss=0.4672, mse=0.4665, lpips=0.0014]Epoch 117/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.54it/s, loss=0.4936, mse=0.4929, lpips=0.0015]Epoch 117/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.49it/s, loss=0.4936, mse=0.4929, lpips=0.0015]
Epoch 117/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 116/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4719]
Epoch 117/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4694]Epoch 117/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3571]Epoch 117 | Avg Train Loss: 0.4801 | Avg Val Loss: 0.4132
New best validation loss: 0.4132. Saving best model...

Epoch 118/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 118/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4654, mse=0.4647, lpips=0.0014][A
Epoch 118/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.18s/it, loss=0.4654, mse=0.4647, lpips=0.0014][A
Epoch 118/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.18s/it, loss=0.4320, mse=0.4313, lpips=0.0014][A
Epoch 118/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.18s/it, loss=0.4012, mse=0.4006, lpips=0.0013][A
Epoch 118/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.66it/s, loss=0.4012, mse=0.4006, lpips=0.0013][A
Epoch 118/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.66it/s, loss=0.4742, mse=0.4735, lpips=0.0015][A
Epoch 118/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.66it/s, loss=0.4484, mse=0.4477, lpips=0.0014][A
Epoch 118/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.37it/s, loss=0.4484, mse=0.4477, lpips=0.0014][A
Epoch 118/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.37it/s, loss=0.4831, mse=0.4824, lpips=0.0015][A
Epoch 118/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.37it/s, loss=0.4369, mse=0.4362, lpips=0.0014][A
Epoch 118/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.86it/s, loss=0.4369, mse=0.4362, lpips=0.0014][A
Epoch 118/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.86it/s, loss=0.4499, mse=0.4492, lpips=0.0014][A
Epoch 118/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.86it/s, loss=0.4279, mse=0.4272, lpips=0.0013][A
Epoch 118/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.18it/s, loss=0.4279, mse=0.4272, lpips=0.0013][A
Epoch 118/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.18it/s, loss=0.4665, mse=0.4657, lpips=0.0014][AEpoch 118/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.09it/s, loss=0.4665, mse=0.4657, lpips=0.0014]

Epoch 118/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 117/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.3571]

Epoch 118/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4340][A
Epoch 118/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5910][AEpoch 118 | Avg Train Loss: 0.4486 | Avg Val Loss: 0.5125
Epoch 119/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 119/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.4462, mse=0.4455, lpips=0.0014]Epoch 119/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:08,  1.03it/s, loss=0.4462, mse=0.4455, lpips=0.0014]Epoch 119/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.03it/s, loss=0.4542, mse=0.4535, lpips=0.0014]Epoch 119/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.94it/s, loss=0.4542, mse=0.4535, lpips=0.0014]Epoch 119/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.94it/s, loss=0.4724, mse=0.4717, lpips=0.0015]Epoch 119/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.94it/s, loss=0.4618, mse=0.4611, lpips=0.0014]Epoch 119/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.06it/s, loss=0.4618, mse=0.4611, lpips=0.0014]Epoch 119/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.06it/s, loss=0.4452, mse=0.4445, lpips=0.0014]Epoch 119/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.06it/s, loss=0.4380, mse=0.4373, lpips=0.0014]Epoch 119/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.79it/s, loss=0.4380, mse=0.4373, lpips=0.0014]Epoch 119/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.79it/s, loss=0.4612, mse=0.4604, lpips=0.0014]Epoch 119/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.79it/s, loss=0.4447, mse=0.4440, lpips=0.0014]Epoch 119/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.23it/s, loss=0.4447, mse=0.4440, lpips=0.0014]Epoch 119/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.23it/s, loss=0.4174, mse=0.4168, lpips=0.0013]Epoch 119/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.23it/s, loss=0.4592, mse=0.4585, lpips=0.0014]Epoch 119/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  8.63it/s, loss=0.4592, mse=0.4585, lpips=0.0014]Epoch 119/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.40it/s, loss=0.4592, mse=0.4585, lpips=0.0014]
Epoch 119/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 118/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5910]
Epoch 119/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4743]Epoch 119/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6955]Epoch 119 | Avg Train Loss: 0.4500 | Avg Val Loss: 0.5849

Epoch 120/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 120/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4663, mse=0.4656, lpips=0.0014][A
Epoch 120/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.06s/it, loss=0.4663, mse=0.4656, lpips=0.0014][A
Epoch 120/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.06s/it, loss=0.4804, mse=0.4797, lpips=0.0015][A
Epoch 120/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.92it/s, loss=0.4804, mse=0.4797, lpips=0.0015][A
Epoch 120/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.92it/s, loss=0.4642, mse=0.4634, lpips=0.0014][A
Epoch 120/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.88it/s, loss=0.4642, mse=0.4634, lpips=0.0014][A
Epoch 120/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.88it/s, loss=0.4396, mse=0.4389, lpips=0.0014][A
Epoch 120/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.95it/s, loss=0.4396, mse=0.4389, lpips=0.0014][A
Epoch 120/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.95it/s, loss=0.4460, mse=0.4453, lpips=0.0014][A
Epoch 120/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.52it/s, loss=0.4460, mse=0.4453, lpips=0.0014][A
Epoch 120/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.52it/s, loss=0.4313, mse=0.4306, lpips=0.0014][A
Epoch 120/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.46it/s, loss=0.4313, mse=0.4306, lpips=0.0014][A
Epoch 120/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.46it/s, loss=0.4685, mse=0.4678, lpips=0.0014][A
Epoch 120/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.37it/s, loss=0.4685, mse=0.4678, lpips=0.0014][A
Epoch 120/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.37it/s, loss=0.4993, mse=0.4985, lpips=0.0015][A
Epoch 120/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  4.31it/s, loss=0.4993, mse=0.4985, lpips=0.0015][A
Epoch 120/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  4.31it/s, loss=0.4495, mse=0.4488, lpips=0.0014][A
Epoch 120/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  4.80it/s, loss=0.4495, mse=0.4488, lpips=0.0014][A
Epoch 120/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  4.80it/s, loss=0.4510, mse=0.4503, lpips=0.0014][A
Epoch 120/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  5.51it/s, loss=0.4510, mse=0.4503, lpips=0.0014][AEpoch 120/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  3.84it/s, loss=0.4510, mse=0.4503, lpips=0.0014]

Epoch 120/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 119/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6955]

Epoch 120/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4406][A
Epoch 120/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4209][AEpoch 120 | Avg Train Loss: 0.4596 | Avg Val Loss: 0.4307
Saving interval checkpoint for epoch 120...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -175.0845, Max: 162.7707
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_120.png
Epoch 121/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 121/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.4866, mse=0.4859, lpips=0.0015]Epoch 121/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.25s/it, loss=0.4866, mse=0.4859, lpips=0.0015]Epoch 121/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.25s/it, loss=0.4598, mse=0.4591, lpips=0.0014]Epoch 121/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.25s/it, loss=0.4627, mse=0.4620, lpips=0.0014]Epoch 121/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.46s/it, loss=0.4627, mse=0.4620, lpips=0.0014]Epoch 121/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.46s/it, loss=0.4368, mse=0.4361, lpips=0.0014]Epoch 121/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.46s/it, loss=0.4541, mse=0.4534, lpips=0.0014]Epoch 121/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.4541, mse=0.4534, lpips=0.0014]Epoch 121/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.4687, mse=0.4680, lpips=0.0015]Epoch 121/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.4477, mse=0.4471, lpips=0.0014]Epoch 121/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.32it/s, loss=0.4477, mse=0.4471, lpips=0.0014]Epoch 121/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.32it/s, loss=0.4658, mse=0.4651, lpips=0.0014]Epoch 121/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.32it/s, loss=0.4490, mse=0.4483, lpips=0.0014]Epoch 121/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  1.98it/s, loss=0.4490, mse=0.4483, lpips=0.0014]Epoch 121/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  1.98it/s, loss=0.4389, mse=0.4382, lpips=0.0014]Epoch 121/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.00s/it, loss=0.4389, mse=0.4382, lpips=0.0014]
Epoch 121/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 120/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.4209]
Epoch 121/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4440]Epoch 121/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4110]Epoch 121 | Avg Train Loss: 0.4570 | Avg Val Loss: 0.4275

Epoch 122/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 122/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.5014, mse=0.5006, lpips=0.0015][A
Epoch 122/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.28s/it, loss=0.5014, mse=0.5006, lpips=0.0015][A
Epoch 122/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.28s/it, loss=0.4503, mse=0.4496, lpips=0.0014][A
Epoch 122/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.28s/it, loss=0.4601, mse=0.4594, lpips=0.0014][A
Epoch 122/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.52it/s, loss=0.4601, mse=0.4594, lpips=0.0014][A
Epoch 122/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.52it/s, loss=0.4375, mse=0.4368, lpips=0.0014][A
Epoch 122/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.52it/s, loss=0.4575, mse=0.4567, lpips=0.0014][A
Epoch 122/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.18it/s, loss=0.4575, mse=0.4567, lpips=0.0014][A
Epoch 122/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.18it/s, loss=0.5092, mse=0.5085, lpips=0.0016][A
Epoch 122/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.18it/s, loss=0.4423, mse=0.4416, lpips=0.0014][A
Epoch 122/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.74it/s, loss=0.4423, mse=0.4416, lpips=0.0014][A
Epoch 122/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.74it/s, loss=0.4217, mse=0.4211, lpips=0.0013][A
Epoch 122/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.74it/s, loss=0.4736, mse=0.4728, lpips=0.0014][A
Epoch 122/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  6.97it/s, loss=0.4736, mse=0.4728, lpips=0.0014][A
Epoch 122/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  6.97it/s, loss=0.4595, mse=0.4588, lpips=0.0014][AEpoch 122/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.83it/s, loss=0.4595, mse=0.4588, lpips=0.0014]

Epoch 122/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 121/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4110]

Epoch 122/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4531][A
Epoch 122/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5035][AEpoch 122 | Avg Train Loss: 0.4613 | Avg Val Loss: 0.4783
Epoch 123/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 123/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4492, mse=0.4485, lpips=0.0014]Epoch 123/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.06s/it, loss=0.4492, mse=0.4485, lpips=0.0014]Epoch 123/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.06s/it, loss=0.4397, mse=0.4390, lpips=0.0014]Epoch 123/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.06s/it, loss=0.4753, mse=0.4745, lpips=0.0015]Epoch 123/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.93it/s, loss=0.4753, mse=0.4745, lpips=0.0015]Epoch 123/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.93it/s, loss=0.4571, mse=0.4564, lpips=0.0014]Epoch 123/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.93it/s, loss=0.4455, mse=0.4448, lpips=0.0014]Epoch 123/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.73it/s, loss=0.4455, mse=0.4448, lpips=0.0014]Epoch 123/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.73it/s, loss=0.4216, mse=0.4210, lpips=0.0013]Epoch 123/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.73it/s, loss=0.4095, mse=0.4088, lpips=0.0013]Epoch 123/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.26it/s, loss=0.4095, mse=0.4088, lpips=0.0013]Epoch 123/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.26it/s, loss=0.3984, mse=0.3978, lpips=0.0013]Epoch 123/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.26it/s, loss=0.4417, mse=0.4410, lpips=0.0014]Epoch 123/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  6.26it/s, loss=0.4417, mse=0.4410, lpips=0.0014]Epoch 123/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  6.26it/s, loss=0.5204, mse=0.5196, lpips=0.0016]Epoch 123/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.34it/s, loss=0.5204, mse=0.5196, lpips=0.0016]Epoch 123/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.84it/s, loss=0.5204, mse=0.5196, lpips=0.0016]
Epoch 123/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 122/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5035]
Epoch 123/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4498]Epoch 123/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4651]Epoch 123 | Avg Train Loss: 0.4458 | Avg Val Loss: 0.4575

Epoch 124/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 124/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.4567, mse=0.4560, lpips=0.0014][A
Epoch 124/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:06,  7.37s/it, loss=0.4567, mse=0.4560, lpips=0.0014][A
Epoch 124/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:06,  7.37s/it, loss=0.4126, mse=0.4119, lpips=0.0013][A
Epoch 124/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:06,  7.37s/it, loss=0.4696, mse=0.4689, lpips=0.0014][A
Epoch 124/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:13,  1.98s/it, loss=0.4696, mse=0.4689, lpips=0.0014][A
Epoch 124/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:13,  1.98s/it, loss=0.4126, mse=0.4119, lpips=0.0013][A
Epoch 124/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:13,  1.98s/it, loss=0.4339, mse=0.4332, lpips=0.0014][A
Epoch 124/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:05,  1.01s/it, loss=0.4339, mse=0.4332, lpips=0.0014][A
Epoch 124/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:05,  1.01s/it, loss=0.4775, mse=0.4768, lpips=0.0015][A
Epoch 124/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:05,  1.01s/it, loss=0.4063, mse=0.4056, lpips=0.0013][A
Epoch 124/1000 [TRAIN]:  70%|███████   | 7/10 [00:07<00:01,  1.61it/s, loss=0.4063, mse=0.4056, lpips=0.0013][A
Epoch 124/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.61it/s, loss=0.4281, mse=0.4274, lpips=0.0013][A
Epoch 124/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:01,  1.88it/s, loss=0.4281, mse=0.4274, lpips=0.0013][A
Epoch 124/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:01,  1.88it/s, loss=0.4245, mse=0.4238, lpips=0.0013][A
Epoch 124/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.32it/s, loss=0.4245, mse=0.4238, lpips=0.0013][A
Epoch 124/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.32it/s, loss=0.4661, mse=0.4654, lpips=0.0014][A
Epoch 124/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  2.85it/s, loss=0.4661, mse=0.4654, lpips=0.0014][AEpoch 124/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.19it/s, loss=0.4661, mse=0.4654, lpips=0.0014]

Epoch 124/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 123/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.4651]

Epoch 124/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4722][A
Epoch 124/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.7541][AEpoch 124 | Avg Train Loss: 0.4388 | Avg Val Loss: 0.6132
Epoch 125/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 125/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.4770, mse=0.4763, lpips=0.0015]Epoch 125/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:04,  7.13s/it, loss=0.4770, mse=0.4763, lpips=0.0015]Epoch 125/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:04,  7.13s/it, loss=0.4309, mse=0.4302, lpips=0.0013]Epoch 125/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:04,  7.13s/it, loss=0.4985, mse=0.4977, lpips=0.0015]Epoch 125/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:13,  1.91s/it, loss=0.4985, mse=0.4977, lpips=0.0015]Epoch 125/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:13,  1.91s/it, loss=0.4394, mse=0.4387, lpips=0.0014]Epoch 125/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:13,  1.91s/it, loss=0.4380, mse=0.4373, lpips=0.0014]Epoch 125/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:04,  1.03it/s, loss=0.4380, mse=0.4373, lpips=0.0014]Epoch 125/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:04,  1.03it/s, loss=0.4412, mse=0.4405, lpips=0.0014]Epoch 125/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:04,  1.03it/s, loss=0.4228, mse=0.4222, lpips=0.0013]Epoch 125/1000 [TRAIN]:  70%|███████   | 7/10 [00:07<00:01,  1.67it/s, loss=0.4228, mse=0.4222, lpips=0.0013]Epoch 125/1000 [TRAIN]:  70%|███████   | 7/10 [00:07<00:01,  1.67it/s, loss=0.4283, mse=0.4276, lpips=0.0013]Epoch 125/1000 [TRAIN]:  70%|███████   | 7/10 [00:07<00:01,  1.67it/s, loss=0.4483, mse=0.4476, lpips=0.0014]Epoch 125/1000 [TRAIN]:  90%|█████████ | 9/10 [00:07<00:00,  2.44it/s, loss=0.4483, mse=0.4476, lpips=0.0014]Epoch 125/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.44it/s, loss=0.4839, mse=0.4832, lpips=0.0015]Epoch 125/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  2.76it/s, loss=0.4839, mse=0.4832, lpips=0.0015]Epoch 125/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.24it/s, loss=0.4839, mse=0.4832, lpips=0.0015]
Epoch 125/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 124/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.7541]
Epoch 125/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4877]Epoch 125/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4277]Epoch 125 | Avg Train Loss: 0.4508 | Avg Val Loss: 0.4577
Saving interval checkpoint for epoch 125...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -167.8139, Max: 181.0589
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_125.png

Epoch 126/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 126/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.4423, mse=0.4417, lpips=0.0014][A
Epoch 126/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:27,  9.70s/it, loss=0.4423, mse=0.4417, lpips=0.0014][A
Epoch 126/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:27,  9.70s/it, loss=0.3967, mse=0.3960, lpips=0.0013][A
Epoch 126/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:32,  4.07s/it, loss=0.3967, mse=0.3960, lpips=0.0013][A
Epoch 126/1000 [TRAIN]:  20%|██        | 2/10 [00:09<00:32,  4.07s/it, loss=0.4731, mse=0.4724, lpips=0.0014][A
Epoch 126/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:16,  2.29s/it, loss=0.4731, mse=0.4724, lpips=0.0014][A
Epoch 126/1000 [TRAIN]:  30%|███       | 3/10 [00:10<00:16,  2.29s/it, loss=0.4177, mse=0.4170, lpips=0.0013][A
Epoch 126/1000 [TRAIN]:  40%|████      | 4/10 [00:10<00:08,  1.45s/it, loss=0.4177, mse=0.4170, lpips=0.0013][A
Epoch 126/1000 [TRAIN]:  40%|████      | 4/10 [00:10<00:08,  1.45s/it, loss=0.4465, mse=0.4458, lpips=0.0014][A
Epoch 126/1000 [TRAIN]:  50%|█████     | 5/10 [00:10<00:04,  1.01it/s, loss=0.4465, mse=0.4458, lpips=0.0014][A
Epoch 126/1000 [TRAIN]:  50%|█████     | 5/10 [00:10<00:04,  1.01it/s, loss=0.4320, mse=0.4313, lpips=0.0013][A
Epoch 126/1000 [TRAIN]:  60%|██████    | 6/10 [00:10<00:02,  1.42it/s, loss=0.4320, mse=0.4313, lpips=0.0013][A
Epoch 126/1000 [TRAIN]:  60%|██████    | 6/10 [00:10<00:02,  1.42it/s, loss=0.4758, mse=0.4751, lpips=0.0015][A
Epoch 126/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:01,  1.89it/s, loss=0.4758, mse=0.4751, lpips=0.0015][A
Epoch 126/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:01,  1.89it/s, loss=0.4639, mse=0.4632, lpips=0.0014][A
Epoch 126/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:00,  2.42it/s, loss=0.4639, mse=0.4632, lpips=0.0014][A
Epoch 126/1000 [TRAIN]:  80%|████████  | 8/10 [00:10<00:00,  2.42it/s, loss=0.4539, mse=0.4532, lpips=0.0014][A
Epoch 126/1000 [TRAIN]:  90%|█████████ | 9/10 [00:11<00:00,  2.92it/s, loss=0.4539, mse=0.4532, lpips=0.0014][A
Epoch 126/1000 [TRAIN]:  90%|█████████ | 9/10 [00:11<00:00,  2.92it/s, loss=0.4978, mse=0.4970, lpips=0.0015][A
Epoch 126/1000 [TRAIN]: 100%|██████████| 10/10 [00:11<00:00,  3.63it/s, loss=0.4978, mse=0.4970, lpips=0.0015][AEpoch 126/1000 [TRAIN]: 100%|██████████| 10/10 [00:11<00:00,  1.11s/it, loss=0.4978, mse=0.4970, lpips=0.0015]

Epoch 126/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 125/1000 [VAL]:   0%|          | 0/2 [00:13<?, ?it/s, loss=0.4277]

Epoch 126/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4867][A
Epoch 126/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.2925][AEpoch 126 | Avg Train Loss: 0.4500 | Avg Val Loss: 0.3896
New best validation loss: 0.3896. Saving best model...
Epoch 127/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 127/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.4664, mse=0.4657, lpips=0.0014]Epoch 127/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:03,  7.02s/it, loss=0.4664, mse=0.4657, lpips=0.0014]Epoch 127/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:03,  7.02s/it, loss=0.4968, mse=0.4960, lpips=0.0015]Epoch 127/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.08s/it, loss=0.4968, mse=0.4960, lpips=0.0015]Epoch 127/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.08s/it, loss=0.4403, mse=0.4396, lpips=0.0014]Epoch 127/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.75s/it, loss=0.4403, mse=0.4396, lpips=0.0014]Epoch 127/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.75s/it, loss=0.4750, mse=0.4742, lpips=0.0015]Epoch 127/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.12s/it, loss=0.4750, mse=0.4742, lpips=0.0015]Epoch 127/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.12s/it, loss=0.4101, mse=0.4094, lpips=0.0013]Epoch 127/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.12s/it, loss=0.4524, mse=0.4517, lpips=0.0014]Epoch 127/1000 [TRAIN]:  60%|██████    | 6/10 [00:07<00:02,  1.75it/s, loss=0.4524, mse=0.4517, lpips=0.0014]Epoch 127/1000 [TRAIN]:  60%|██████    | 6/10 [00:07<00:02,  1.75it/s, loss=0.4074, mse=0.4067, lpips=0.0013]Epoch 127/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.16it/s, loss=0.4074, mse=0.4067, lpips=0.0013]Epoch 127/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.16it/s, loss=0.4383, mse=0.4376, lpips=0.0013]Epoch 127/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.63it/s, loss=0.4383, mse=0.4376, lpips=0.0013]Epoch 127/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.63it/s, loss=0.4070, mse=0.4064, lpips=0.0013]Epoch 127/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.97it/s, loss=0.4070, mse=0.4064, lpips=0.0013]Epoch 127/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.97it/s, loss=0.5129, mse=0.5122, lpips=0.0016]Epoch 127/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  3.38it/s, loss=0.5129, mse=0.5122, lpips=0.0016]Epoch 127/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.16it/s, loss=0.5129, mse=0.5122, lpips=0.0016]
Epoch 127/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 126/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.2925]
Epoch 127/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4455]Epoch 127/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5022]Epoch 127 | Avg Train Loss: 0.4507 | Avg Val Loss: 0.4739

Epoch 128/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 128/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.3850, mse=0.3844, lpips=0.0012][A
Epoch 128/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.31s/it, loss=0.3850, mse=0.3844, lpips=0.0012][A
Epoch 128/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.31s/it, loss=0.4533, mse=0.4526, lpips=0.0014][A
Epoch 128/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.11s/it, loss=0.4533, mse=0.4526, lpips=0.0014][A
Epoch 128/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.11s/it, loss=0.4269, mse=0.4263, lpips=0.0013][A
Epoch 128/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:24,  3.11s/it, loss=0.4470, mse=0.4463, lpips=0.0014][A
Epoch 128/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:07,  1.21s/it, loss=0.4470, mse=0.4463, lpips=0.0014][A
Epoch 128/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:07,  1.21s/it, loss=0.4450, mse=0.4443, lpips=0.0014][A
Epoch 128/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:07,  1.21s/it, loss=0.4428, mse=0.4421, lpips=0.0014][A
Epoch 128/1000 [TRAIN]:  60%|██████    | 6/10 [00:07<00:02,  1.42it/s, loss=0.4428, mse=0.4421, lpips=0.0014][A
Epoch 128/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.42it/s, loss=0.4869, mse=0.4861, lpips=0.0015][A
Epoch 128/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.73it/s, loss=0.4869, mse=0.4861, lpips=0.0015][A
Epoch 128/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.73it/s, loss=0.4180, mse=0.4174, lpips=0.0013][A
Epoch 128/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.00it/s, loss=0.4180, mse=0.4174, lpips=0.0013][A
Epoch 128/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.00it/s, loss=0.4465, mse=0.4459, lpips=0.0014][A
Epoch 128/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.34it/s, loss=0.4465, mse=0.4459, lpips=0.0014][A
Epoch 128/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.34it/s, loss=0.4195, mse=0.4188, lpips=0.0013][A
Epoch 128/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  2.81it/s, loss=0.4195, mse=0.4188, lpips=0.0013][AEpoch 128/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.13it/s, loss=0.4195, mse=0.4188, lpips=0.0013]

Epoch 128/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 127/1000 [VAL]:   0%|          | 0/2 [00:11<?, ?it/s, loss=0.5022]

Epoch 128/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4680][A
Epoch 128/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.2976][AEpoch 128 | Avg Train Loss: 0.4371 | Avg Val Loss: 0.3828
New best validation loss: 0.3828. Saving best model...
Epoch 129/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 129/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.4547, mse=0.4540, lpips=0.0014]Epoch 129/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.23s/it, loss=0.4547, mse=0.4540, lpips=0.0014]Epoch 129/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.23s/it, loss=0.4334, mse=0.4328, lpips=0.0013]Epoch 129/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.19s/it, loss=0.4334, mse=0.4328, lpips=0.0013]Epoch 129/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.19s/it, loss=0.4622, mse=0.4615, lpips=0.0014]Epoch 129/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.19s/it, loss=0.4261, mse=0.4254, lpips=0.0013]Epoch 129/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:07,  1.25s/it, loss=0.4261, mse=0.4254, lpips=0.0013]Epoch 129/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:07,  1.25s/it, loss=0.4435, mse=0.4428, lpips=0.0014]Epoch 129/1000 [TRAIN]:  50%|█████     | 5/10 [00:07<00:04,  1.10it/s, loss=0.4435, mse=0.4428, lpips=0.0014]Epoch 129/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.10it/s, loss=0.4450, mse=0.4443, lpips=0.0014]Epoch 129/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.47it/s, loss=0.4450, mse=0.4443, lpips=0.0014]Epoch 129/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.47it/s, loss=0.4152, mse=0.4145, lpips=0.0013]Epoch 129/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.84it/s, loss=0.4152, mse=0.4145, lpips=0.0013]Epoch 129/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.84it/s, loss=0.4796, mse=0.4788, lpips=0.0015]Epoch 129/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.22it/s, loss=0.4796, mse=0.4788, lpips=0.0015]Epoch 129/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.22it/s, loss=0.4906, mse=0.4898, lpips=0.0015]Epoch 129/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.50it/s, loss=0.4906, mse=0.4898, lpips=0.0015]Epoch 129/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.50it/s, loss=0.4474, mse=0.4467, lpips=0.0014]Epoch 129/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  3.00it/s, loss=0.4474, mse=0.4467, lpips=0.0014]Epoch 129/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.11it/s, loss=0.4474, mse=0.4467, lpips=0.0014]
Epoch 129/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 128/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.2976]
Epoch 129/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.3914]Epoch 129/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4900]Epoch 129 | Avg Train Loss: 0.4498 | Avg Val Loss: 0.4407

Epoch 130/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 130/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.4475, mse=0.4468, lpips=0.0014][A
Epoch 130/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.32s/it, loss=0.4475, mse=0.4468, lpips=0.0014][A
Epoch 130/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:05,  7.32s/it, loss=0.4327, mse=0.4320, lpips=0.0013][A
Epoch 130/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.14s/it, loss=0.4327, mse=0.4320, lpips=0.0013][A
Epoch 130/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.14s/it, loss=0.4489, mse=0.4482, lpips=0.0014][A
Epoch 130/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.81s/it, loss=0.4489, mse=0.4482, lpips=0.0014][A
Epoch 130/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.81s/it, loss=0.4794, mse=0.4787, lpips=0.0015][A
Epoch 130/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:07,  1.17s/it, loss=0.4794, mse=0.4787, lpips=0.0015][A
Epoch 130/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.17s/it, loss=0.4288, mse=0.4281, lpips=0.0013][A
Epoch 130/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.20it/s, loss=0.4288, mse=0.4281, lpips=0.0013][A
Epoch 130/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.20it/s, loss=0.4228, mse=0.4222, lpips=0.0013][A
Epoch 130/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.59it/s, loss=0.4228, mse=0.4222, lpips=0.0013][A
Epoch 130/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.59it/s, loss=0.4936, mse=0.4929, lpips=0.0015][A
Epoch 130/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.09it/s, loss=0.4936, mse=0.4929, lpips=0.0015][A
Epoch 130/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.09it/s, loss=0.4859, mse=0.4852, lpips=0.0015][A
Epoch 130/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.49it/s, loss=0.4859, mse=0.4852, lpips=0.0015][A
Epoch 130/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.49it/s, loss=0.4572, mse=0.4565, lpips=0.0014][A
Epoch 130/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.05it/s, loss=0.4572, mse=0.4565, lpips=0.0014][A
Epoch 130/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  3.05it/s, loss=0.4208, mse=0.4201, lpips=0.0013][A
Epoch 130/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  3.67it/s, loss=0.4208, mse=0.4201, lpips=0.0013][AEpoch 130/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.09it/s, loss=0.4208, mse=0.4201, lpips=0.0013]

Epoch 130/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 129/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.4900]

Epoch 130/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4483][A
Epoch 130/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.3521][AEpoch 130 | Avg Train Loss: 0.4518 | Avg Val Loss: 0.4002
Saving interval checkpoint for epoch 130...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -189.1059, Max: 159.8486
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_130.png
Epoch 131/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 131/1000 [TRAIN]:   0%|          | 0/10 [00:08<?, ?it/s, loss=0.4986, mse=0.4979, lpips=0.0015]Epoch 131/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:18,  8.77s/it, loss=0.4986, mse=0.4979, lpips=0.0015]Epoch 131/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:18,  8.77s/it, loss=0.4377, mse=0.4370, lpips=0.0014]Epoch 131/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:18,  8.77s/it, loss=0.4395, mse=0.4389, lpips=0.0014]Epoch 131/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:16,  2.38s/it, loss=0.4395, mse=0.4389, lpips=0.0014]Epoch 131/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:16,  2.38s/it, loss=0.4498, mse=0.4491, lpips=0.0014]Epoch 131/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:16,  2.38s/it, loss=0.4409, mse=0.4402, lpips=0.0014]Epoch 131/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.20s/it, loss=0.4409, mse=0.4402, lpips=0.0014]Epoch 131/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.20s/it, loss=0.4151, mse=0.4144, lpips=0.0013]Epoch 131/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.20s/it, loss=0.3823, mse=0.3817, lpips=0.0012]Epoch 131/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.37it/s, loss=0.3823, mse=0.3817, lpips=0.0012]Epoch 131/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.37it/s, loss=0.4321, mse=0.4315, lpips=0.0013]Epoch 131/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.37it/s, loss=0.4570, mse=0.4563, lpips=0.0014]Epoch 131/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.06it/s, loss=0.4570, mse=0.4563, lpips=0.0014]Epoch 131/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.06it/s, loss=0.4918, mse=0.4911, lpips=0.0015]Epoch 131/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.04it/s, loss=0.4918, mse=0.4911, lpips=0.0015]
Epoch 131/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 130/1000 [VAL]:   0%|          | 0/2 [00:14<?, ?it/s, loss=0.3521]
Epoch 131/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4778]Epoch 131/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3372]Epoch 131 | Avg Train Loss: 0.4445 | Avg Val Loss: 0.4075

Epoch 132/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 132/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.3923, mse=0.3917, lpips=0.0012][A
Epoch 132/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.3923, mse=0.3917, lpips=0.0012][A
Epoch 132/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.4576, mse=0.4569, lpips=0.0014][A
Epoch 132/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.4245, mse=0.4239, lpips=0.0013][A
Epoch 132/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.4245, mse=0.4239, lpips=0.0013][A
Epoch 132/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.4624, mse=0.4617, lpips=0.0014][A
Epoch 132/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.4138, mse=0.4131, lpips=0.0013][A
Epoch 132/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.67it/s, loss=0.4138, mse=0.4131, lpips=0.0013][A
Epoch 132/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.67it/s, loss=0.4439, mse=0.4432, lpips=0.0014][A
Epoch 132/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.67it/s, loss=0.4495, mse=0.4488, lpips=0.0014][A
Epoch 132/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.31it/s, loss=0.4495, mse=0.4488, lpips=0.0014][A
Epoch 132/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.31it/s, loss=0.4556, mse=0.4549, lpips=0.0014][A
Epoch 132/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.31it/s, loss=0.4718, mse=0.4711, lpips=0.0014][A
Epoch 132/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.60it/s, loss=0.4718, mse=0.4711, lpips=0.0014][A
Epoch 132/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.60it/s, loss=0.4464, mse=0.4457, lpips=0.0014][AEpoch 132/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.39it/s, loss=0.4464, mse=0.4457, lpips=0.0014]

Epoch 132/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 131/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.3372]

Epoch 132/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4032][A
Epoch 132/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6195][AEpoch 132 | Avg Train Loss: 0.4418 | Avg Val Loss: 0.5114
Epoch 133/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 133/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.4578, mse=0.4571, lpips=0.0014]Epoch 133/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:08,  1.05it/s, loss=0.4578, mse=0.4571, lpips=0.0014]Epoch 133/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.05it/s, loss=0.4522, mse=0.4515, lpips=0.0014]Epoch 133/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.04it/s, loss=0.4522, mse=0.4515, lpips=0.0014]Epoch 133/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.04it/s, loss=0.4285, mse=0.4278, lpips=0.0013]Epoch 133/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.04it/s, loss=0.4266, mse=0.4259, lpips=0.0013]Epoch 133/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.28it/s, loss=0.4266, mse=0.4259, lpips=0.0013]Epoch 133/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.28it/s, loss=0.4017, mse=0.4011, lpips=0.0013]Epoch 133/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.28it/s, loss=0.4390, mse=0.4383, lpips=0.0014]Epoch 133/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  6.17it/s, loss=0.4390, mse=0.4383, lpips=0.0014]Epoch 133/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  6.17it/s, loss=0.4291, mse=0.4285, lpips=0.0013]Epoch 133/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  6.17it/s, loss=0.3952, mse=0.3946, lpips=0.0012]Epoch 133/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.84it/s, loss=0.3952, mse=0.3946, lpips=0.0012]Epoch 133/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.84it/s, loss=0.4350, mse=0.4343, lpips=0.0014]Epoch 133/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  6.60it/s, loss=0.4350, mse=0.4343, lpips=0.0014]Epoch 133/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  6.60it/s, loss=0.4081, mse=0.4075, lpips=0.0013]Epoch 133/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  6.84it/s, loss=0.4081, mse=0.4075, lpips=0.0013]Epoch 133/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.02it/s, loss=0.4081, mse=0.4075, lpips=0.0013]
Epoch 133/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 132/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6195]
Epoch 133/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4177]Epoch 133/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5526]Epoch 133 | Avg Train Loss: 0.4273 | Avg Val Loss: 0.4852

Epoch 134/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 134/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.4686, mse=0.4678, lpips=0.0014][A
Epoch 134/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:08,  1.12it/s, loss=0.4686, mse=0.4678, lpips=0.0014][A
Epoch 134/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.12it/s, loss=0.4624, mse=0.4617, lpips=0.0014][A
Epoch 134/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.19it/s, loss=0.4624, mse=0.4617, lpips=0.0014][A
Epoch 134/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.19it/s, loss=0.3958, mse=0.3952, lpips=0.0012][A
Epoch 134/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.19it/s, loss=0.4293, mse=0.4287, lpips=0.0013][A
Epoch 134/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.45it/s, loss=0.4293, mse=0.4287, lpips=0.0013][A
Epoch 134/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.45it/s, loss=0.4475, mse=0.4468, lpips=0.0014][A
Epoch 134/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.81it/s, loss=0.4475, mse=0.4468, lpips=0.0014][A
Epoch 134/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.81it/s, loss=0.4862, mse=0.4854, lpips=0.0015][A
Epoch 134/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.11it/s, loss=0.4862, mse=0.4854, lpips=0.0015][A
Epoch 134/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.11it/s, loss=0.3942, mse=0.3936, lpips=0.0012][A
Epoch 134/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.35it/s, loss=0.3942, mse=0.3936, lpips=0.0012][A
Epoch 134/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.35it/s, loss=0.3790, mse=0.3784, lpips=0.0012][A
Epoch 134/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  5.61it/s, loss=0.3790, mse=0.3784, lpips=0.0012][A
Epoch 134/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.61it/s, loss=0.4552, mse=0.4545, lpips=0.0014][A
Epoch 134/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  4.96it/s, loss=0.4552, mse=0.4545, lpips=0.0014][A
Epoch 134/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  4.96it/s, loss=0.4439, mse=0.4432, lpips=0.0014][A
Epoch 134/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  5.14it/s, loss=0.4439, mse=0.4432, lpips=0.0014][AEpoch 134/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.32it/s, loss=0.4439, mse=0.4432, lpips=0.0014]

Epoch 134/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 133/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5526]

Epoch 134/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4072][A
Epoch 134/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5323][AEpoch 134 | Avg Train Loss: 0.4362 | Avg Val Loss: 0.4697
Epoch 135/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 135/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.4900, mse=0.4893, lpips=0.0015]Epoch 135/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:10,  7.87s/it, loss=0.4900, mse=0.4893, lpips=0.0015]Epoch 135/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:10,  7.87s/it, loss=0.3922, mse=0.3916, lpips=0.0012]Epoch 135/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:26,  3.34s/it, loss=0.3922, mse=0.3916, lpips=0.0012]Epoch 135/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:26,  3.34s/it, loss=0.4522, mse=0.4515, lpips=0.0014]Epoch 135/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:13,  1.89s/it, loss=0.4522, mse=0.4515, lpips=0.0014]Epoch 135/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:13,  1.89s/it, loss=0.4523, mse=0.4516, lpips=0.0014]Epoch 135/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.24s/it, loss=0.4523, mse=0.4516, lpips=0.0014]Epoch 135/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.24s/it, loss=0.4257, mse=0.4250, lpips=0.0013]Epoch 135/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.13it/s, loss=0.4257, mse=0.4250, lpips=0.0013]Epoch 135/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.13it/s, loss=0.4003, mse=0.3997, lpips=0.0013]Epoch 135/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.52it/s, loss=0.4003, mse=0.3997, lpips=0.0013]Epoch 135/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:02,  1.52it/s, loss=0.4913, mse=0.4906, lpips=0.0015]Epoch 135/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:01,  2.02it/s, loss=0.4913, mse=0.4906, lpips=0.0015]Epoch 135/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:01,  2.02it/s, loss=0.4656, mse=0.4649, lpips=0.0014]Epoch 135/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:00,  2.58it/s, loss=0.4656, mse=0.4649, lpips=0.0014]Epoch 135/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:00,  2.58it/s, loss=0.4391, mse=0.4384, lpips=0.0014]Epoch 135/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  3.09it/s, loss=0.4391, mse=0.4384, lpips=0.0014]Epoch 135/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  3.09it/s, loss=0.4561, mse=0.4554, lpips=0.0014]Epoch 135/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  3.81it/s, loss=0.4561, mse=0.4554, lpips=0.0014]Epoch 135/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.05it/s, loss=0.4561, mse=0.4554, lpips=0.0014]
Epoch 135/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 134/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.5323]
Epoch 135/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4705]Epoch 135/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6113]Epoch 135 | Avg Train Loss: 0.4465 | Avg Val Loss: 0.5409
Saving interval checkpoint for epoch 135...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -168.5514, Max: 214.4349
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_135.png

Epoch 136/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 136/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.3968, mse=0.3962, lpips=0.0012][A
Epoch 136/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:22,  9.18s/it, loss=0.3968, mse=0.3962, lpips=0.0012][A
Epoch 136/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:22,  9.18s/it, loss=0.4130, mse=0.4123, lpips=0.0013][A
Epoch 136/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:22,  9.18s/it, loss=0.4328, mse=0.4321, lpips=0.0013][A
Epoch 136/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.45s/it, loss=0.4328, mse=0.4321, lpips=0.0013][A
Epoch 136/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.45s/it, loss=0.4335, mse=0.4328, lpips=0.0013][A
Epoch 136/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.45s/it, loss=0.4397, mse=0.4390, lpips=0.0014][A
Epoch 136/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.4397, mse=0.4390, lpips=0.0014][A
Epoch 136/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.3859, mse=0.3853, lpips=0.0012][A
Epoch 136/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.24s/it, loss=0.4489, mse=0.4482, lpips=0.0014][A
Epoch 136/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.33it/s, loss=0.4489, mse=0.4482, lpips=0.0014][A
Epoch 136/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.33it/s, loss=0.4133, mse=0.4126, lpips=0.0013][A
Epoch 136/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.33it/s, loss=0.4163, mse=0.4157, lpips=0.0013][A
Epoch 136/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  1.99it/s, loss=0.4163, mse=0.4157, lpips=0.0013][A
Epoch 136/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  1.99it/s, loss=0.4068, mse=0.4062, lpips=0.0013][AEpoch 136/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.00it/s, loss=0.4068, mse=0.4062, lpips=0.0013]

Epoch 136/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 135/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.6113]

Epoch 136/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4341][A
Epoch 136/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4627][AEpoch 136 | Avg Train Loss: 0.4187 | Avg Val Loss: 0.4484
Epoch 137/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 137/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4287, mse=0.4280, lpips=0.0013]Epoch 137/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.11s/it, loss=0.4287, mse=0.4280, lpips=0.0013]Epoch 137/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.11s/it, loss=0.4034, mse=0.4027, lpips=0.0013]Epoch 137/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.11s/it, loss=0.3768, mse=0.3762, lpips=0.0012]Epoch 137/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.3768, mse=0.3762, lpips=0.0012]Epoch 137/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.4210, mse=0.4204, lpips=0.0013]Epoch 137/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.84it/s, loss=0.4006, mse=0.4000, lpips=0.0012]Epoch 137/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.66it/s, loss=0.4006, mse=0.4000, lpips=0.0012]Epoch 137/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.66it/s, loss=0.4061, mse=0.4055, lpips=0.0013]Epoch 137/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.66it/s, loss=0.4482, mse=0.4475, lpips=0.0014]Epoch 137/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.16it/s, loss=0.4482, mse=0.4475, lpips=0.0014]Epoch 137/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.16it/s, loss=0.4290, mse=0.4284, lpips=0.0013]Epoch 137/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.16it/s, loss=0.4397, mse=0.4390, lpips=0.0014]Epoch 137/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.43it/s, loss=0.4397, mse=0.4390, lpips=0.0014]Epoch 137/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.43it/s, loss=0.4060, mse=0.4054, lpips=0.0013]Epoch 137/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.36it/s, loss=0.4060, mse=0.4054, lpips=0.0013]
Epoch 137/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 136/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4627]
Epoch 137/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4276]Epoch 137/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3865]Epoch 137 | Avg Train Loss: 0.4159 | Avg Val Loss: 0.4071

Epoch 138/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 138/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4558, mse=0.4551, lpips=0.0014][A
Epoch 138/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.12s/it, loss=0.4558, mse=0.4551, lpips=0.0014][A
Epoch 138/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.12s/it, loss=0.4313, mse=0.4307, lpips=0.0013][A
Epoch 138/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.80it/s, loss=0.4313, mse=0.4307, lpips=0.0013][A
Epoch 138/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.80it/s, loss=0.4049, mse=0.4043, lpips=0.0013][A
Epoch 138/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.61it/s, loss=0.4049, mse=0.4043, lpips=0.0013][A
Epoch 138/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.61it/s, loss=0.4439, mse=0.4432, lpips=0.0014][A
Epoch 138/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.27it/s, loss=0.4439, mse=0.4432, lpips=0.0014][A
Epoch 138/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.27it/s, loss=0.4824, mse=0.4817, lpips=0.0015][A
Epoch 138/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.07it/s, loss=0.4824, mse=0.4817, lpips=0.0015][A
Epoch 138/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.07it/s, loss=0.4303, mse=0.4297, lpips=0.0013][A
Epoch 138/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.43it/s, loss=0.4303, mse=0.4297, lpips=0.0013][A
Epoch 138/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.43it/s, loss=0.4450, mse=0.4444, lpips=0.0014][A
Epoch 138/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.04it/s, loss=0.4450, mse=0.4444, lpips=0.0014][A
Epoch 138/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.04it/s, loss=0.4695, mse=0.4688, lpips=0.0014][A
Epoch 138/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.36it/s, loss=0.4695, mse=0.4688, lpips=0.0014][A
Epoch 138/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.36it/s, loss=0.3811, mse=0.3805, lpips=0.0012][A
Epoch 138/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.48it/s, loss=0.3811, mse=0.3805, lpips=0.0012][A
Epoch 138/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.48it/s, loss=0.4470, mse=0.4463, lpips=0.0014][AEpoch 138/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  3.98it/s, loss=0.4470, mse=0.4463, lpips=0.0014]

Epoch 138/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 137/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.3865]

Epoch 138/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4067][A
Epoch 138/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.3724][AEpoch 138 | Avg Train Loss: 0.4391 | Avg Val Loss: 0.3896
Epoch 139/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 139/1000 [TRAIN]:   0%|          | 0/10 [00:08<?, ?it/s, loss=0.4454, mse=0.4447, lpips=0.0014]Epoch 139/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:12,  8.05s/it, loss=0.4454, mse=0.4447, lpips=0.0014]Epoch 139/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:12,  8.05s/it, loss=0.4163, mse=0.4156, lpips=0.0013]Epoch 139/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:12,  8.05s/it, loss=0.4216, mse=0.4210, lpips=0.0013]Epoch 139/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:15,  2.15s/it, loss=0.4216, mse=0.4210, lpips=0.0013]Epoch 139/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:15,  2.15s/it, loss=0.3941, mse=0.3935, lpips=0.0012]Epoch 139/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:15,  2.15s/it, loss=0.4192, mse=0.4186, lpips=0.0013]Epoch 139/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.09s/it, loss=0.4192, mse=0.4186, lpips=0.0013]Epoch 139/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.09s/it, loss=0.4093, mse=0.4087, lpips=0.0013]Epoch 139/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:05,  1.09s/it, loss=0.4496, mse=0.4489, lpips=0.0014]Epoch 139/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:02,  1.50it/s, loss=0.4496, mse=0.4489, lpips=0.0014]Epoch 139/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:02,  1.50it/s, loss=0.4440, mse=0.4433, lpips=0.0014]Epoch 139/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:01,  1.86it/s, loss=0.4440, mse=0.4433, lpips=0.0014]Epoch 139/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:01,  1.86it/s, loss=0.3825, mse=0.3818, lpips=0.0012]Epoch 139/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.27it/s, loss=0.3825, mse=0.3818, lpips=0.0012]Epoch 139/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.27it/s, loss=0.4630, mse=0.4623, lpips=0.0014]Epoch 139/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  2.75it/s, loss=0.4630, mse=0.4623, lpips=0.0014]Epoch 139/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.11it/s, loss=0.4630, mse=0.4623, lpips=0.0014]
Epoch 139/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 138/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.3724]
Epoch 139/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4713]Epoch 139/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3489]Epoch 139 | Avg Train Loss: 0.4245 | Avg Val Loss: 0.4101

Epoch 140/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 140/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4078, mse=0.4072, lpips=0.0013][A
Epoch 140/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.17s/it, loss=0.4078, mse=0.4072, lpips=0.0013][A
Epoch 140/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.17s/it, loss=0.4130, mse=0.4123, lpips=0.0013][A
Epoch 140/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.77it/s, loss=0.4130, mse=0.4123, lpips=0.0013][A
Epoch 140/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.77it/s, loss=0.4206, mse=0.4199, lpips=0.0013][A
Epoch 140/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.60it/s, loss=0.4206, mse=0.4199, lpips=0.0013][A
Epoch 140/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.60it/s, loss=0.4062, mse=0.4056, lpips=0.0013][A
Epoch 140/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.60it/s, loss=0.4126, mse=0.4119, lpips=0.0013][A
Epoch 140/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.60it/s, loss=0.4126, mse=0.4119, lpips=0.0013][A
Epoch 140/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.60it/s, loss=0.4726, mse=0.4718, lpips=0.0015][A
Epoch 140/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.60it/s, loss=0.4439, mse=0.4432, lpips=0.0014][A
Epoch 140/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.26it/s, loss=0.4439, mse=0.4432, lpips=0.0014][A
Epoch 140/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.26it/s, loss=0.4125, mse=0.4119, lpips=0.0013][A
Epoch 140/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  6.26it/s, loss=0.4085, mse=0.4079, lpips=0.0013][A
Epoch 140/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  7.55it/s, loss=0.4085, mse=0.4079, lpips=0.0013][A
Epoch 140/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  7.55it/s, loss=0.4399, mse=0.4392, lpips=0.0014][AEpoch 140/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.82it/s, loss=0.4399, mse=0.4392, lpips=0.0014]

Epoch 140/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 139/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.3489]

Epoch 140/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4469][A
Epoch 140/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3309][AEpoch 140 | Avg Train Loss: 0.4238 | Avg Val Loss: 0.3889
Saving interval checkpoint for epoch 140...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -172.8505, Max: 167.4884
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_140.png
Epoch 141/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 141/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.3908, mse=0.3902, lpips=0.0012]Epoch 141/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:28,  9.81s/it, loss=0.3908, mse=0.3902, lpips=0.0012]Epoch 141/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:28,  9.81s/it, loss=0.3898, mse=0.3892, lpips=0.0012]Epoch 141/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:28,  9.81s/it, loss=0.4773, mse=0.4765, lpips=0.0015]Epoch 141/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:18,  2.61s/it, loss=0.4773, mse=0.4765, lpips=0.0015]Epoch 141/1000 [TRAIN]:  30%|███       | 3/10 [00:10<00:18,  2.61s/it, loss=0.4523, mse=0.4516, lpips=0.0014]Epoch 141/1000 [TRAIN]:  30%|███       | 3/10 [00:10<00:18,  2.61s/it, loss=0.4223, mse=0.4216, lpips=0.0013]Epoch 141/1000 [TRAIN]:  50%|█████     | 5/10 [00:10<00:06,  1.32s/it, loss=0.4223, mse=0.4216, lpips=0.0013]Epoch 141/1000 [TRAIN]:  50%|█████     | 5/10 [00:10<00:06,  1.32s/it, loss=0.4544, mse=0.4537, lpips=0.0014]Epoch 141/1000 [TRAIN]:  50%|█████     | 5/10 [00:10<00:06,  1.32s/it, loss=0.4291, mse=0.4285, lpips=0.0013]Epoch 141/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:02,  1.26it/s, loss=0.4291, mse=0.4285, lpips=0.0013]Epoch 141/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:02,  1.26it/s, loss=0.4585, mse=0.4578, lpips=0.0014]Epoch 141/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:02,  1.26it/s, loss=0.4307, mse=0.4300, lpips=0.0013]Epoch 141/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  1.89it/s, loss=0.4307, mse=0.4300, lpips=0.0013]Epoch 141/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  1.89it/s, loss=0.4328, mse=0.4321, lpips=0.0013]Epoch 141/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.06s/it, loss=0.4328, mse=0.4321, lpips=0.0013]
Epoch 141/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 140/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.3309]
Epoch 141/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3955]Epoch 141/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5153]Epoch 141 | Avg Train Loss: 0.4338 | Avg Val Loss: 0.4554

Epoch 142/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 142/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.3878, mse=0.3871, lpips=0.0012][A
Epoch 142/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.05s/it, loss=0.3878, mse=0.3871, lpips=0.0012][A
Epoch 142/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.05s/it, loss=0.4785, mse=0.4778, lpips=0.0015][A
Epoch 142/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.05s/it, loss=0.4301, mse=0.4294, lpips=0.0013][A
Epoch 142/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.94it/s, loss=0.4301, mse=0.4294, lpips=0.0013][A
Epoch 142/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.94it/s, loss=0.4318, mse=0.4311, lpips=0.0013][A
Epoch 142/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.94it/s, loss=0.3845, mse=0.3839, lpips=0.0012][A
Epoch 142/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.74it/s, loss=0.3845, mse=0.3839, lpips=0.0012][A
Epoch 142/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.74it/s, loss=0.4163, mse=0.4156, lpips=0.0013][A
Epoch 142/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.74it/s, loss=0.4008, mse=0.4002, lpips=0.0012][A
Epoch 142/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.41it/s, loss=0.4008, mse=0.4002, lpips=0.0012][A
Epoch 142/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.41it/s, loss=0.3731, mse=0.3725, lpips=0.0012][A
Epoch 142/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.41it/s, loss=0.4353, mse=0.4347, lpips=0.0013][A
Epoch 142/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.66it/s, loss=0.4353, mse=0.4347, lpips=0.0013][A
Epoch 142/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.66it/s, loss=0.4548, mse=0.4541, lpips=0.0014][AEpoch 142/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.53it/s, loss=0.4548, mse=0.4541, lpips=0.0014]

Epoch 142/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 141/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5153]

Epoch 142/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4489][A
Epoch 142/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.2437][AEpoch 142 | Avg Train Loss: 0.4193 | Avg Val Loss: 0.3463
New best validation loss: 0.3463. Saving best model...
Epoch 143/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 143/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.4518, mse=0.4511, lpips=0.0014]Epoch 143/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:07,  1.19it/s, loss=0.4518, mse=0.4511, lpips=0.0014]Epoch 143/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:07,  1.19it/s, loss=0.4739, mse=0.4732, lpips=0.0014]Epoch 143/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.00it/s, loss=0.4739, mse=0.4732, lpips=0.0014]Epoch 143/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.00it/s, loss=0.4061, mse=0.4055, lpips=0.0013]Epoch 143/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.00it/s, loss=0.4446, mse=0.4439, lpips=0.0014]Epoch 143/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.19it/s, loss=0.4446, mse=0.4439, lpips=0.0014]Epoch 143/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.19it/s, loss=0.4304, mse=0.4297, lpips=0.0013]Epoch 143/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.19it/s, loss=0.4615, mse=0.4608, lpips=0.0014]Epoch 143/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.95it/s, loss=0.4615, mse=0.4608, lpips=0.0014]Epoch 143/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.95it/s, loss=0.4452, mse=0.4445, lpips=0.0014]Epoch 143/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.95it/s, loss=0.4297, mse=0.4291, lpips=0.0013]Epoch 143/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.33it/s, loss=0.4297, mse=0.4291, lpips=0.0013]Epoch 143/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.33it/s, loss=0.4235, mse=0.4228, lpips=0.0013]Epoch 143/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.33it/s, loss=0.4083, mse=0.4077, lpips=0.0013]Epoch 143/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  8.75it/s, loss=0.4083, mse=0.4077, lpips=0.0013]Epoch 143/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.63it/s, loss=0.4083, mse=0.4077, lpips=0.0013]
Epoch 143/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 142/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.2437]
Epoch 143/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4252]Epoch 143/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3100]Epoch 143 | Avg Train Loss: 0.4375 | Avg Val Loss: 0.3676

Epoch 144/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 144/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4840, mse=0.4833, lpips=0.0015][A
Epoch 144/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.15s/it, loss=0.4840, mse=0.4833, lpips=0.0015][A
Epoch 144/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.15s/it, loss=0.4447, mse=0.4440, lpips=0.0014][A
Epoch 144/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.74it/s, loss=0.4447, mse=0.4440, lpips=0.0014][A
Epoch 144/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.74it/s, loss=0.4078, mse=0.4071, lpips=0.0013][A
Epoch 144/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.59it/s, loss=0.4078, mse=0.4071, lpips=0.0013][A
Epoch 144/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.59it/s, loss=0.4044, mse=0.4037, lpips=0.0013][A
Epoch 144/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.36it/s, loss=0.4044, mse=0.4037, lpips=0.0013][A
Epoch 144/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.36it/s, loss=0.4124, mse=0.4118, lpips=0.0013][A
Epoch 144/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  3.96it/s, loss=0.4124, mse=0.4118, lpips=0.0013][A
Epoch 144/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  3.96it/s, loss=0.4536, mse=0.4529, lpips=0.0014][A
Epoch 144/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.47it/s, loss=0.4536, mse=0.4529, lpips=0.0014][A
Epoch 144/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.47it/s, loss=0.4212, mse=0.4205, lpips=0.0013][A
Epoch 144/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.73it/s, loss=0.4212, mse=0.4205, lpips=0.0013][A
Epoch 144/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.73it/s, loss=0.4377, mse=0.4370, lpips=0.0013][A
Epoch 144/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.28it/s, loss=0.4377, mse=0.4370, lpips=0.0013][A
Epoch 144/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.28it/s, loss=0.4267, mse=0.4260, lpips=0.0013][A
Epoch 144/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.60it/s, loss=0.4267, mse=0.4260, lpips=0.0013][A
Epoch 144/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.60it/s, loss=0.3811, mse=0.3805, lpips=0.0012][A
Epoch 144/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.24it/s, loss=0.3811, mse=0.3805, lpips=0.0012][AEpoch 144/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  3.86it/s, loss=0.3811, mse=0.3805, lpips=0.0012]

Epoch 144/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 143/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.3100]

Epoch 144/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4183][A
Epoch 144/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4296][AEpoch 144 | Avg Train Loss: 0.4273 | Avg Val Loss: 0.4240
Epoch 145/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 145/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.4116, mse=0.4109, lpips=0.0013]Epoch 145/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.51s/it, loss=0.4116, mse=0.4109, lpips=0.0013]Epoch 145/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:07,  7.51s/it, loss=0.4039, mse=0.4033, lpips=0.0013]Epoch 145/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.19s/it, loss=0.4039, mse=0.4033, lpips=0.0013]Epoch 145/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.19s/it, loss=0.4612, mse=0.4605, lpips=0.0014]Epoch 145/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.81s/it, loss=0.4612, mse=0.4605, lpips=0.0014]Epoch 145/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.81s/it, loss=0.4105, mse=0.4098, lpips=0.0013]Epoch 145/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:06,  1.16s/it, loss=0.4105, mse=0.4098, lpips=0.0013]Epoch 145/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:06,  1.16s/it, loss=0.4185, mse=0.4178, lpips=0.0013]Epoch 145/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.25it/s, loss=0.4185, mse=0.4178, lpips=0.0013]Epoch 145/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.25it/s, loss=0.4359, mse=0.4352, lpips=0.0014]Epoch 145/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.71it/s, loss=0.4359, mse=0.4352, lpips=0.0014]Epoch 145/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.71it/s, loss=0.4169, mse=0.4163, lpips=0.0013]Epoch 145/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.22it/s, loss=0.4169, mse=0.4163, lpips=0.0013]Epoch 145/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.22it/s, loss=0.3879, mse=0.3873, lpips=0.0012]Epoch 145/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.22it/s, loss=0.4087, mse=0.4080, lpips=0.0013]Epoch 145/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.40it/s, loss=0.4087, mse=0.4080, lpips=0.0013]Epoch 145/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.40it/s, loss=0.3918, mse=0.3912, lpips=0.0012]Epoch 145/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  3.99it/s, loss=0.3918, mse=0.3912, lpips=0.0012]Epoch 145/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.12it/s, loss=0.3918, mse=0.3912, lpips=0.0012]
Epoch 145/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 144/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.4296]
Epoch 145/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4692]Epoch 145/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.3195]Epoch 145 | Avg Train Loss: 0.4147 | Avg Val Loss: 0.3944
Saving interval checkpoint for epoch 145...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -190.4600, Max: 164.1616
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_145.png

Epoch 146/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 146/1000 [TRAIN]:   0%|          | 0/10 [00:08<?, ?it/s, loss=0.4732, mse=0.4725, lpips=0.0015][A
Epoch 146/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:14,  8.24s/it, loss=0.4732, mse=0.4725, lpips=0.0015][A
Epoch 146/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:14,  8.24s/it, loss=0.4032, mse=0.4025, lpips=0.0013][A
Epoch 146/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:14,  8.24s/it, loss=0.4514, mse=0.4507, lpips=0.0014][A
Epoch 146/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.48s/it, loss=0.4514, mse=0.4507, lpips=0.0014][A
Epoch 146/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.48s/it, loss=0.5011, mse=0.5003, lpips=0.0015][A
Epoch 146/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.48s/it, loss=0.4526, mse=0.4519, lpips=0.0014][A
Epoch 146/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.25s/it, loss=0.4526, mse=0.4519, lpips=0.0014][A
Epoch 146/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.25s/it, loss=0.4056, mse=0.4050, lpips=0.0013][A
Epoch 146/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.25s/it, loss=0.4308, mse=0.4301, lpips=0.0013][A
Epoch 146/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.32it/s, loss=0.4308, mse=0.4301, lpips=0.0013][A
Epoch 146/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.32it/s, loss=0.4351, mse=0.4344, lpips=0.0014][A
Epoch 146/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.65it/s, loss=0.4351, mse=0.4344, lpips=0.0014][A
Epoch 146/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.65it/s, loss=0.4443, mse=0.4436, lpips=0.0014][A
Epoch 146/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:01,  1.65it/s, loss=0.3912, mse=0.3906, lpips=0.0012][A
Epoch 146/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  2.54it/s, loss=0.3912, mse=0.3906, lpips=0.0012][AEpoch 146/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.02it/s, loss=0.3912, mse=0.3906, lpips=0.0012]

Epoch 146/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 145/1000 [VAL]:   0%|          | 0/2 [00:14<?, ?it/s, loss=0.3195]

Epoch 146/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4092][A
Epoch 146/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.5294][AEpoch 146 | Avg Train Loss: 0.4388 | Avg Val Loss: 0.4693
Epoch 147/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 147/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4433, mse=0.4426, lpips=0.0014]Epoch 147/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.14s/it, loss=0.4433, mse=0.4426, lpips=0.0014]Epoch 147/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.14s/it, loss=0.4132, mse=0.4125, lpips=0.0013]Epoch 147/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.14s/it, loss=0.4107, mse=0.4101, lpips=0.0013]Epoch 147/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.74it/s, loss=0.4107, mse=0.4101, lpips=0.0013]Epoch 147/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.74it/s, loss=0.4612, mse=0.4605, lpips=0.0014]Epoch 147/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.74it/s, loss=0.4432, mse=0.4425, lpips=0.0014]Epoch 147/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.54it/s, loss=0.4432, mse=0.4425, lpips=0.0014]Epoch 147/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.54it/s, loss=0.4150, mse=0.4144, lpips=0.0013]Epoch 147/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.54it/s, loss=0.4573, mse=0.4566, lpips=0.0014]Epoch 147/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.08it/s, loss=0.4573, mse=0.4566, lpips=0.0014]Epoch 147/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.08it/s, loss=0.3664, mse=0.3658, lpips=0.0011]Epoch 147/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.08it/s, loss=0.4191, mse=0.4184, lpips=0.0013]Epoch 147/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.33it/s, loss=0.4191, mse=0.4184, lpips=0.0013]Epoch 147/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.33it/s, loss=0.5164, mse=0.5156, lpips=0.0016]Epoch 147/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.23it/s, loss=0.5164, mse=0.5156, lpips=0.0016]
Epoch 147/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 146/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.5294]
Epoch 147/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4615]Epoch 147/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4167]Epoch 147 | Avg Train Loss: 0.4346 | Avg Val Loss: 0.4391

Epoch 148/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 148/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4351, mse=0.4344, lpips=0.0013][A
Epoch 148/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.01s/it, loss=0.4351, mse=0.4344, lpips=0.0013][A
Epoch 148/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.01s/it, loss=0.4101, mse=0.4094, lpips=0.0013][A
Epoch 148/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.01s/it, loss=0.4300, mse=0.4293, lpips=0.0013][A
Epoch 148/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.99it/s, loss=0.4300, mse=0.4293, lpips=0.0013][A
Epoch 148/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.99it/s, loss=0.4865, mse=0.4858, lpips=0.0015][A
Epoch 148/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.99it/s, loss=0.4039, mse=0.4033, lpips=0.0013][A
Epoch 148/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.78it/s, loss=0.4039, mse=0.4033, lpips=0.0013][A
Epoch 148/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.78it/s, loss=0.4323, mse=0.4316, lpips=0.0013][A
Epoch 148/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.78it/s, loss=0.4055, mse=0.4049, lpips=0.0012][A
Epoch 148/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.32it/s, loss=0.4055, mse=0.4049, lpips=0.0012][A
Epoch 148/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.32it/s, loss=0.3498, mse=0.3492, lpips=0.0011][A
Epoch 148/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.32it/s, loss=0.4162, mse=0.4155, lpips=0.0013][A
Epoch 148/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.50it/s, loss=0.4162, mse=0.4155, lpips=0.0013][A
Epoch 148/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.50it/s, loss=0.4558, mse=0.4551, lpips=0.0014][AEpoch 148/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.51it/s, loss=0.4558, mse=0.4551, lpips=0.0014]

Epoch 148/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 147/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4167]

Epoch 148/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4232][A
Epoch 148/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4423][AEpoch 148 | Avg Train Loss: 0.4225 | Avg Val Loss: 0.4327
Epoch 149/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 149/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.4692, mse=0.4685, lpips=0.0014]Epoch 149/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:08,  1.07it/s, loss=0.4692, mse=0.4685, lpips=0.0014]Epoch 149/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.07it/s, loss=0.4348, mse=0.4342, lpips=0.0013]Epoch 149/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.98it/s, loss=0.4348, mse=0.4342, lpips=0.0013]Epoch 149/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.98it/s, loss=0.4309, mse=0.4303, lpips=0.0013]Epoch 149/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.98it/s, loss=0.4321, mse=0.4315, lpips=0.0014]Epoch 149/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.05it/s, loss=0.4321, mse=0.4315, lpips=0.0014]Epoch 149/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.05it/s, loss=0.4416, mse=0.4409, lpips=0.0014]Epoch 149/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.44it/s, loss=0.4416, mse=0.4409, lpips=0.0014]Epoch 149/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.44it/s, loss=0.4008, mse=0.4002, lpips=0.0012]Epoch 149/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.85it/s, loss=0.4008, mse=0.4002, lpips=0.0012]Epoch 149/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.85it/s, loss=0.4450, mse=0.4443, lpips=0.0014]Epoch 149/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.02it/s, loss=0.4450, mse=0.4443, lpips=0.0014]Epoch 149/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.02it/s, loss=0.4233, mse=0.4226, lpips=0.0013]Epoch 149/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  5.51it/s, loss=0.4233, mse=0.4226, lpips=0.0013]Epoch 149/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.51it/s, loss=0.4250, mse=0.4244, lpips=0.0013]Epoch 149/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.73it/s, loss=0.4250, mse=0.4244, lpips=0.0013]Epoch 149/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.73it/s, loss=0.3553, mse=0.3548, lpips=0.0011]Epoch 149/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.32it/s, loss=0.3553, mse=0.3548, lpips=0.0011]Epoch 149/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.41it/s, loss=0.3553, mse=0.3548, lpips=0.0011]
Epoch 149/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 148/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4423]
Epoch 149/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4408]Epoch 149/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.2411]Epoch 149 | Avg Train Loss: 0.4258 | Avg Val Loss: 0.3409
New best validation loss: 0.3409. Saving best model...

Epoch 150/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 150/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.3912, mse=0.3906, lpips=0.0012][A
Epoch 150/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:06,  7.43s/it, loss=0.3912, mse=0.3906, lpips=0.0012][A
Epoch 150/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:06,  7.43s/it, loss=0.4414, mse=0.4407, lpips=0.0014][A
Epoch 150/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.16s/it, loss=0.4414, mse=0.4407, lpips=0.0014][A
Epoch 150/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.16s/it, loss=0.3625, mse=0.3619, lpips=0.0011][A
Epoch 150/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.80s/it, loss=0.3625, mse=0.3619, lpips=0.0011][A
Epoch 150/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.80s/it, loss=0.4326, mse=0.4320, lpips=0.0013][A
Epoch 150/1000 [TRAIN]:  40%|████      | 4/10 [00:07<00:06,  1.15s/it, loss=0.4326, mse=0.4320, lpips=0.0013][A
Epoch 150/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:06,  1.15s/it, loss=0.3953, mse=0.3947, lpips=0.0012][A
Epoch 150/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.26it/s, loss=0.3953, mse=0.3947, lpips=0.0012][A
Epoch 150/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:03,  1.26it/s, loss=0.4122, mse=0.4115, lpips=0.0013][A
Epoch 150/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.71it/s, loss=0.4122, mse=0.4115, lpips=0.0013][A
Epoch 150/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.71it/s, loss=0.4195, mse=0.4188, lpips=0.0013][A
Epoch 150/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.23it/s, loss=0.4195, mse=0.4188, lpips=0.0013][A
Epoch 150/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.23it/s, loss=0.4288, mse=0.4281, lpips=0.0013][A
Epoch 150/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.80it/s, loss=0.4288, mse=0.4281, lpips=0.0013][A
Epoch 150/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.80it/s, loss=0.3790, mse=0.3784, lpips=0.0012][A
Epoch 150/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.35it/s, loss=0.3790, mse=0.3784, lpips=0.0012][A
Epoch 150/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.35it/s, loss=0.3854, mse=0.3848, lpips=0.0012][A
Epoch 150/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  4.08it/s, loss=0.3854, mse=0.3848, lpips=0.0012][AEpoch 150/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.12it/s, loss=0.3854, mse=0.3848, lpips=0.0012]

Epoch 150/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 149/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.2411]

Epoch 150/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4057][A
Epoch 150/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.6207][AEpoch 150 | Avg Train Loss: 0.4048 | Avg Val Loss: 0.5132
Saving interval checkpoint for epoch 150...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -158.3678, Max: 171.9863
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_150.png
Epoch 151/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 151/1000 [TRAIN]:   0%|          | 0/10 [00:08<?, ?it/s, loss=0.4165, mse=0.4158, lpips=0.0013]Epoch 151/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:17,  8.61s/it, loss=0.4165, mse=0.4158, lpips=0.0013]Epoch 151/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:17,  8.61s/it, loss=0.3902, mse=0.3896, lpips=0.0012]Epoch 151/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:29,  3.67s/it, loss=0.3902, mse=0.3896, lpips=0.0012]Epoch 151/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:29,  3.67s/it, loss=0.4344, mse=0.4338, lpips=0.0014]Epoch 151/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:29,  3.67s/it, loss=0.4430, mse=0.4424, lpips=0.0014]Epoch 151/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:08,  1.43s/it, loss=0.4430, mse=0.4424, lpips=0.0014]Epoch 151/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.43s/it, loss=0.3830, mse=0.3824, lpips=0.0012]Epoch 151/1000 [TRAIN]:  40%|████      | 4/10 [00:09<00:08,  1.43s/it, loss=0.4144, mse=0.4138, lpips=0.0013]Epoch 151/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.26it/s, loss=0.4144, mse=0.4138, lpips=0.0013]Epoch 151/1000 [TRAIN]:  60%|██████    | 6/10 [00:09<00:03,  1.26it/s, loss=0.4341, mse=0.4335, lpips=0.0013]Epoch 151/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:01,  1.61it/s, loss=0.4341, mse=0.4335, lpips=0.0013]Epoch 151/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:01,  1.61it/s, loss=0.4068, mse=0.4061, lpips=0.0013]Epoch 151/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:01,  1.61it/s, loss=0.4394, mse=0.4387, lpips=0.0014]Epoch 151/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.51it/s, loss=0.4394, mse=0.4387, lpips=0.0014]Epoch 151/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.51it/s, loss=0.3656, mse=0.3650, lpips=0.0011]Epoch 151/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.05it/s, loss=0.3656, mse=0.3650, lpips=0.0011]
Epoch 151/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 150/1000 [VAL]:   0%|          | 0/2 [00:14<?, ?it/s, loss=0.6207]
Epoch 151/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4490]Epoch 151/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4006]Epoch 151 | Avg Train Loss: 0.4127 | Avg Val Loss: 0.4248

Epoch 152/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 152/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.3840, mse=0.3834, lpips=0.0012][A
Epoch 152/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.3840, mse=0.3834, lpips=0.0012][A
Epoch 152/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.10s/it, loss=0.4409, mse=0.4403, lpips=0.0014][A
Epoch 152/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.71it/s, loss=0.4409, mse=0.4403, lpips=0.0014][A
Epoch 152/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.71it/s, loss=0.3963, mse=0.3957, lpips=0.0012][A
Epoch 152/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.71it/s, loss=0.3761, mse=0.3755, lpips=0.0012][A
Epoch 152/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.68it/s, loss=0.3761, mse=0.3755, lpips=0.0012][A
Epoch 152/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.68it/s, loss=0.4459, mse=0.4452, lpips=0.0014][A
Epoch 152/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.68it/s, loss=0.4336, mse=0.4329, lpips=0.0013][A
Epoch 152/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.42it/s, loss=0.4336, mse=0.4329, lpips=0.0013][A
Epoch 152/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.42it/s, loss=0.4038, mse=0.4032, lpips=0.0013][A
Epoch 152/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.42it/s, loss=0.4064, mse=0.4057, lpips=0.0013][A
Epoch 152/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.75it/s, loss=0.4064, mse=0.4057, lpips=0.0013][A
Epoch 152/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.75it/s, loss=0.4054, mse=0.4047, lpips=0.0013][A
Epoch 152/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  6.75it/s, loss=0.4330, mse=0.4323, lpips=0.0013][A
Epoch 152/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  8.18it/s, loss=0.4330, mse=0.4323, lpips=0.0013][AEpoch 152/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.97it/s, loss=0.4330, mse=0.4323, lpips=0.0013]

Epoch 152/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 151/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4006]

Epoch 152/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4234][A
Epoch 152/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3855][AEpoch 152 | Avg Train Loss: 0.4125 | Avg Val Loss: 0.4044
Epoch 153/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 153/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.3959, mse=0.3953, lpips=0.0012]Epoch 153/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:08,  1.09it/s, loss=0.3959, mse=0.3953, lpips=0.0012]Epoch 153/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.09it/s, loss=0.4267, mse=0.4260, lpips=0.0013]Epoch 153/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.11it/s, loss=0.4267, mse=0.4260, lpips=0.0013]Epoch 153/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.11it/s, loss=0.4396, mse=0.4389, lpips=0.0013]Epoch 153/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.11it/s, loss=0.4516, mse=0.4509, lpips=0.0014]Epoch 153/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.27it/s, loss=0.4516, mse=0.4509, lpips=0.0014]Epoch 153/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.27it/s, loss=0.3983, mse=0.3977, lpips=0.0012]Epoch 153/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.27it/s, loss=0.4451, mse=0.4444, lpips=0.0014]Epoch 153/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.98it/s, loss=0.4451, mse=0.4444, lpips=0.0014]Epoch 153/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.98it/s, loss=0.3671, mse=0.3665, lpips=0.0012]Epoch 153/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.98it/s, loss=0.3908, mse=0.3902, lpips=0.0012]Epoch 153/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.41it/s, loss=0.3908, mse=0.3902, lpips=0.0012]Epoch 153/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.41it/s, loss=0.4525, mse=0.4518, lpips=0.0014]Epoch 153/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.41it/s, loss=0.4608, mse=0.4601, lpips=0.0014]Epoch 153/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  8.84it/s, loss=0.4608, mse=0.4601, lpips=0.0014]Epoch 153/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.63it/s, loss=0.4608, mse=0.4601, lpips=0.0014]
Epoch 153/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 152/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.3855]
Epoch 153/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4287]Epoch 153/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.2959]Epoch 153 | Avg Train Loss: 0.4228 | Avg Val Loss: 0.3623

Epoch 154/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 154/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.3970, mse=0.3964, lpips=0.0012][A
Epoch 154/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.07s/it, loss=0.3970, mse=0.3964, lpips=0.0012][A
Epoch 154/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.07s/it, loss=0.4263, mse=0.4256, lpips=0.0013][A
Epoch 154/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.07s/it, loss=0.3878, mse=0.3872, lpips=0.0012][A
Epoch 154/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.90it/s, loss=0.3878, mse=0.3872, lpips=0.0012][A
Epoch 154/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.90it/s, loss=0.4442, mse=0.4435, lpips=0.0014][A
Epoch 154/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.90it/s, loss=0.4112, mse=0.4106, lpips=0.0013][A
Epoch 154/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.71it/s, loss=0.4112, mse=0.4106, lpips=0.0013][A
Epoch 154/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.71it/s, loss=0.4340, mse=0.4334, lpips=0.0013][A
Epoch 154/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.71it/s, loss=0.4000, mse=0.3994, lpips=0.0012][A
Epoch 154/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.28it/s, loss=0.4000, mse=0.3994, lpips=0.0012][A
Epoch 154/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.28it/s, loss=0.4367, mse=0.4361, lpips=0.0014][A
Epoch 154/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.87it/s, loss=0.4367, mse=0.4361, lpips=0.0014][A
Epoch 154/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.87it/s, loss=0.3875, mse=0.3869, lpips=0.0012][A
Epoch 154/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  6.63it/s, loss=0.3875, mse=0.3869, lpips=0.0012][A
Epoch 154/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  6.63it/s, loss=0.4230, mse=0.4224, lpips=0.0013][AEpoch 154/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.22it/s, loss=0.4230, mse=0.4224, lpips=0.0013]

Epoch 154/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 153/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.2959]

Epoch 154/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4442][A
Epoch 154/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.1786][AEpoch 154 | Avg Train Loss: 0.4148 | Avg Val Loss: 0.3114
New best validation loss: 0.3114. Saving best model...
Epoch 155/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 155/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4191, mse=0.4185, lpips=0.0013]Epoch 155/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.18s/it, loss=0.4191, mse=0.4185, lpips=0.0013]Epoch 155/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.18s/it, loss=0.4283, mse=0.4276, lpips=0.0013]Epoch 155/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.18s/it, loss=0.4407, mse=0.4400, lpips=0.0014]Epoch 155/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.68it/s, loss=0.4407, mse=0.4400, lpips=0.0014]Epoch 155/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.68it/s, loss=0.3981, mse=0.3975, lpips=0.0012]Epoch 155/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.57it/s, loss=0.3981, mse=0.3975, lpips=0.0012]Epoch 155/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.57it/s, loss=0.4251, mse=0.4244, lpips=0.0013]Epoch 155/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.27it/s, loss=0.4251, mse=0.4244, lpips=0.0013]Epoch 155/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.27it/s, loss=0.3975, mse=0.3969, lpips=0.0012]Epoch 155/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.72it/s, loss=0.3975, mse=0.3969, lpips=0.0012]Epoch 155/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.72it/s, loss=0.4031, mse=0.4025, lpips=0.0013]Epoch 155/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.06it/s, loss=0.4031, mse=0.4025, lpips=0.0013]Epoch 155/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  5.06it/s, loss=0.4414, mse=0.4408, lpips=0.0014]Epoch 155/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.32it/s, loss=0.4414, mse=0.4408, lpips=0.0014]Epoch 155/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.32it/s, loss=0.3871, mse=0.3865, lpips=0.0012]Epoch 155/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  4.96it/s, loss=0.3871, mse=0.3865, lpips=0.0012]Epoch 155/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  4.96it/s, loss=0.4257, mse=0.4251, lpips=0.0013]Epoch 155/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.99it/s, loss=0.4257, mse=0.4251, lpips=0.0013]Epoch 155/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  3.94it/s, loss=0.4257, mse=0.4251, lpips=0.0013]
Epoch 155/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 154/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.1786]
Epoch 155/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4136]Epoch 155/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5559]Epoch 155 | Avg Train Loss: 0.4166 | Avg Val Loss: 0.4847
Saving interval checkpoint for epoch 155...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -165.5480, Max: 157.1703
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_155.png

Epoch 156/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 156/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.3888, mse=0.3882, lpips=0.0012][A
Epoch 156/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.33s/it, loss=0.3888, mse=0.3882, lpips=0.0012][A
Epoch 156/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.33s/it, loss=0.3921, mse=0.3915, lpips=0.0012][A
Epoch 156/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:23,  9.33s/it, loss=0.4235, mse=0.4228, lpips=0.0013][A
Epoch 156/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.49s/it, loss=0.4235, mse=0.4228, lpips=0.0013][A
Epoch 156/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.49s/it, loss=0.3970, mse=0.3964, lpips=0.0012][A
Epoch 156/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.49s/it, loss=0.3689, mse=0.3683, lpips=0.0012][A
Epoch 156/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.25s/it, loss=0.3689, mse=0.3683, lpips=0.0012][A
Epoch 156/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.25s/it, loss=0.3706, mse=0.3700, lpips=0.0012][A
Epoch 156/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.25s/it, loss=0.4224, mse=0.4218, lpips=0.0013][A
Epoch 156/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.32it/s, loss=0.4224, mse=0.4218, lpips=0.0013][A
Epoch 156/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.32it/s, loss=0.4527, mse=0.4520, lpips=0.0014][A
Epoch 156/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:02,  1.32it/s, loss=0.4611, mse=0.4604, lpips=0.0014][A
Epoch 156/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  1.97it/s, loss=0.4611, mse=0.4604, lpips=0.0014][A
Epoch 156/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  1.97it/s, loss=0.4156, mse=0.4149, lpips=0.0013][AEpoch 156/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.01s/it, loss=0.4156, mse=0.4149, lpips=0.0013]

Epoch 156/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 155/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.5559]

Epoch 156/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4422][A
Epoch 156/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.1808][AEpoch 156 | Avg Train Loss: 0.4093 | Avg Val Loss: 0.3115
Epoch 157/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 157/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.3900, mse=0.3894, lpips=0.0012]Epoch 157/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.24s/it, loss=0.3900, mse=0.3894, lpips=0.0012]Epoch 157/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.24s/it, loss=0.4103, mse=0.4097, lpips=0.0013]Epoch 157/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:11,  1.24s/it, loss=0.3707, mse=0.3701, lpips=0.0012]Epoch 157/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.61it/s, loss=0.3707, mse=0.3701, lpips=0.0012]Epoch 157/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.61it/s, loss=0.4201, mse=0.4194, lpips=0.0013]Epoch 157/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.61it/s, loss=0.4334, mse=0.4327, lpips=0.0013]Epoch 157/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.29it/s, loss=0.4334, mse=0.4327, lpips=0.0013]Epoch 157/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.29it/s, loss=0.4301, mse=0.4294, lpips=0.0013]Epoch 157/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.29it/s, loss=0.4178, mse=0.4172, lpips=0.0013]Epoch 157/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.83it/s, loss=0.4178, mse=0.4172, lpips=0.0013]Epoch 157/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.83it/s, loss=0.3801, mse=0.3795, lpips=0.0012]Epoch 157/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.83it/s, loss=0.3916, mse=0.3910, lpips=0.0012]Epoch 157/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.13it/s, loss=0.3916, mse=0.3910, lpips=0.0012]Epoch 157/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  7.13it/s, loss=0.4707, mse=0.4700, lpips=0.0014]Epoch 157/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  5.00it/s, loss=0.4707, mse=0.4700, lpips=0.0014]
Epoch 157/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 156/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.1808]
Epoch 157/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4127]Epoch 157/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.2429]Epoch 157 | Avg Train Loss: 0.4115 | Avg Val Loss: 0.3278

Epoch 158/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 158/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4055, mse=0.4049, lpips=0.0013][A
Epoch 158/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.03s/it, loss=0.4055, mse=0.4049, lpips=0.0013][A
Epoch 158/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.03s/it, loss=0.4089, mse=0.4083, lpips=0.0013][A
Epoch 158/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.03s/it, loss=0.4225, mse=0.4219, lpips=0.0013][A
Epoch 158/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.03it/s, loss=0.4225, mse=0.4219, lpips=0.0013][A
Epoch 158/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.03it/s, loss=0.4325, mse=0.4319, lpips=0.0013][A
Epoch 158/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  3.03it/s, loss=0.3716, mse=0.3710, lpips=0.0012][A
Epoch 158/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.87it/s, loss=0.3716, mse=0.3710, lpips=0.0012][A
Epoch 158/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.87it/s, loss=0.3879, mse=0.3873, lpips=0.0012][A
Epoch 158/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.87it/s, loss=0.4166, mse=0.4160, lpips=0.0013][A
Epoch 158/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.45it/s, loss=0.4166, mse=0.4160, lpips=0.0013][A
Epoch 158/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.45it/s, loss=0.3823, mse=0.3817, lpips=0.0012][A
Epoch 158/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.45it/s, loss=0.4321, mse=0.4314, lpips=0.0013][A
Epoch 158/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.65it/s, loss=0.4321, mse=0.4314, lpips=0.0013][A
Epoch 158/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.65it/s, loss=0.3356, mse=0.3350, lpips=0.0011][AEpoch 158/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.54it/s, loss=0.3356, mse=0.3350, lpips=0.0011]

Epoch 158/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 157/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.2429]

Epoch 158/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4348][A
Epoch 158/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.2525][AEpoch 158 | Avg Train Loss: 0.3996 | Avg Val Loss: 0.3437
Epoch 159/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 159/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4779, mse=0.4772, lpips=0.0015]Epoch 159/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.06s/it, loss=0.4779, mse=0.4772, lpips=0.0015]Epoch 159/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.06s/it, loss=0.4170, mse=0.4164, lpips=0.0013]Epoch 159/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.90it/s, loss=0.4170, mse=0.4164, lpips=0.0013]Epoch 159/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:04,  1.90it/s, loss=0.4323, mse=0.4317, lpips=0.0013]Epoch 159/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.68it/s, loss=0.4323, mse=0.4317, lpips=0.0013]Epoch 159/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.68it/s, loss=0.4159, mse=0.4153, lpips=0.0013]Epoch 159/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.41it/s, loss=0.4159, mse=0.4153, lpips=0.0013]Epoch 159/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.41it/s, loss=0.3832, mse=0.3826, lpips=0.0012]Epoch 159/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.09it/s, loss=0.3832, mse=0.3826, lpips=0.0012]Epoch 159/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.09it/s, loss=0.3724, mse=0.3718, lpips=0.0012]Epoch 159/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.68it/s, loss=0.3724, mse=0.3718, lpips=0.0012]Epoch 159/1000 [TRAIN]:  60%|██████    | 6/10 [00:02<00:00,  4.68it/s, loss=0.4710, mse=0.4703, lpips=0.0014]Epoch 159/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.99it/s, loss=0.4710, mse=0.4703, lpips=0.0014]Epoch 159/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.99it/s, loss=0.3931, mse=0.3925, lpips=0.0012]Epoch 159/1000 [TRAIN]:  70%|███████   | 7/10 [00:02<00:00,  4.99it/s, loss=0.4455, mse=0.4449, lpips=0.0014]Epoch 159/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  6.89it/s, loss=0.4455, mse=0.4449, lpips=0.0014]Epoch 159/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  6.89it/s, loss=0.4630, mse=0.4623, lpips=0.0014]Epoch 159/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  7.03it/s, loss=0.4630, mse=0.4623, lpips=0.0014]Epoch 159/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.22it/s, loss=0.4630, mse=0.4623, lpips=0.0014]
Epoch 159/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 158/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.2525]
Epoch 159/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4235]Epoch 159/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.3941]Epoch 159 | Avg Train Loss: 0.4271 | Avg Val Loss: 0.4088

Epoch 160/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 160/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.3691, mse=0.3686, lpips=0.0012][A
Epoch 160/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:08,  7.67s/it, loss=0.3691, mse=0.3686, lpips=0.0012][A
Epoch 160/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:08,  7.67s/it, loss=0.3990, mse=0.3984, lpips=0.0012][A
Epoch 160/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.25s/it, loss=0.3990, mse=0.3984, lpips=0.0012][A
Epoch 160/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.25s/it, loss=0.3998, mse=0.3992, lpips=0.0012][A
Epoch 160/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.84s/it, loss=0.3998, mse=0.3992, lpips=0.0012][A
Epoch 160/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.84s/it, loss=0.3995, mse=0.3989, lpips=0.0012][A
Epoch 160/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.84s/it, loss=0.3749, mse=0.3743, lpips=0.0012][A
Epoch 160/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.18it/s, loss=0.3749, mse=0.3743, lpips=0.0012][A
Epoch 160/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.18it/s, loss=0.3598, mse=0.3592, lpips=0.0011][A
Epoch 160/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.18it/s, loss=0.4267, mse=0.4261, lpips=0.0013][A
Epoch 160/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.97it/s, loss=0.4267, mse=0.4261, lpips=0.0013][A
Epoch 160/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.97it/s, loss=0.3917, mse=0.3911, lpips=0.0012][A
Epoch 160/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  1.97it/s, loss=0.3715, mse=0.3709, lpips=0.0012][A
Epoch 160/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.74it/s, loss=0.3715, mse=0.3709, lpips=0.0012][A
Epoch 160/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  2.74it/s, loss=0.3841, mse=0.3835, lpips=0.0012][A
Epoch 160/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  3.25it/s, loss=0.3841, mse=0.3835, lpips=0.0012][AEpoch 160/1000 [TRAIN]: 100%|██████████| 10/10 [00:08<00:00,  1.15it/s, loss=0.3841, mse=0.3835, lpips=0.0012]

Epoch 160/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 159/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.3941]

Epoch 160/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.3536][A
Epoch 160/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5421][AEpoch 160 | Avg Train Loss: 0.3876 | Avg Val Loss: 0.4478
Saving interval checkpoint for epoch 160...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -187.5827, Max: 147.2793
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_160.png
Epoch 161/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 161/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.3918, mse=0.3911, lpips=0.0012]Epoch 161/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:24,  9.34s/it, loss=0.3918, mse=0.3911, lpips=0.0012]Epoch 161/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:24,  9.34s/it, loss=0.4346, mse=0.4339, lpips=0.0013]Epoch 161/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:24,  9.34s/it, loss=0.4244, mse=0.4238, lpips=0.0013]Epoch 161/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.49s/it, loss=0.4244, mse=0.4238, lpips=0.0013]Epoch 161/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.49s/it, loss=0.4343, mse=0.4336, lpips=0.0013]Epoch 161/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.49s/it, loss=0.4470, mse=0.4463, lpips=0.0014]Epoch 161/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.26s/it, loss=0.4470, mse=0.4463, lpips=0.0014]Epoch 161/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.26s/it, loss=0.4324, mse=0.4317, lpips=0.0013]Epoch 161/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.26s/it, loss=0.3610, mse=0.3605, lpips=0.0011]Epoch 161/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.31it/s, loss=0.3610, mse=0.3605, lpips=0.0011]Epoch 161/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.31it/s, loss=0.4083, mse=0.4077, lpips=0.0013]Epoch 161/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:02,  1.31it/s, loss=0.4265, mse=0.4258, lpips=0.0013]Epoch 161/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  1.96it/s, loss=0.4265, mse=0.4258, lpips=0.0013]Epoch 161/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  1.96it/s, loss=0.3930, mse=0.3924, lpips=0.0012]Epoch 161/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.01s/it, loss=0.3930, mse=0.3924, lpips=0.0012]
Epoch 161/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 160/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.5421]
Epoch 161/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3892]Epoch 161/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4391]Epoch 161 | Avg Train Loss: 0.4153 | Avg Val Loss: 0.4142

Epoch 162/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 162/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4118, mse=0.4112, lpips=0.0013][A
Epoch 162/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.22s/it, loss=0.4118, mse=0.4112, lpips=0.0013][A
Epoch 162/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.22s/it, loss=0.4357, mse=0.4351, lpips=0.0013][A
Epoch 162/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.22s/it, loss=0.4449, mse=0.4442, lpips=0.0014][A
Epoch 162/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.64it/s, loss=0.4449, mse=0.4442, lpips=0.0014][A
Epoch 162/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.64it/s, loss=0.4676, mse=0.4669, lpips=0.0014][A
Epoch 162/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.64it/s, loss=0.4166, mse=0.4160, lpips=0.0013][A
Epoch 162/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.35it/s, loss=0.4166, mse=0.4160, lpips=0.0013][A
Epoch 162/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.35it/s, loss=0.4366, mse=0.4360, lpips=0.0014][A
Epoch 162/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.35it/s, loss=0.4312, mse=0.4306, lpips=0.0013][A
Epoch 162/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.86it/s, loss=0.4312, mse=0.4306, lpips=0.0013][A
Epoch 162/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.86it/s, loss=0.3914, mse=0.3908, lpips=0.0012][A
Epoch 162/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.86it/s, loss=0.3901, mse=0.3895, lpips=0.0012][A
Epoch 162/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.20it/s, loss=0.3901, mse=0.3895, lpips=0.0012][A
Epoch 162/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.20it/s, loss=0.4926, mse=0.4919, lpips=0.0015][AEpoch 162/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.05it/s, loss=0.4926, mse=0.4919, lpips=0.0015]

Epoch 162/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 161/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4391]

Epoch 162/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4383][A
Epoch 162/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6144][AEpoch 162 | Avg Train Loss: 0.4319 | Avg Val Loss: 0.5263
Epoch 163/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 163/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.3707, mse=0.3702, lpips=0.0012]Epoch 163/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.05s/it, loss=0.3707, mse=0.3702, lpips=0.0012]Epoch 163/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.05s/it, loss=0.4594, mse=0.4586, lpips=0.0014]Epoch 163/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:09,  1.05s/it, loss=0.3970, mse=0.3963, lpips=0.0012]Epoch 163/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.96it/s, loss=0.3970, mse=0.3963, lpips=0.0012]Epoch 163/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.96it/s, loss=0.3908, mse=0.3902, lpips=0.0012]Epoch 163/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.96it/s, loss=0.3686, mse=0.3680, lpips=0.0012]Epoch 163/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.76it/s, loss=0.3686, mse=0.3680, lpips=0.0012]Epoch 163/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.76it/s, loss=0.4079, mse=0.4072, lpips=0.0013]Epoch 163/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.76it/s, loss=0.3998, mse=0.3992, lpips=0.0012]Epoch 163/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.21it/s, loss=0.3998, mse=0.3992, lpips=0.0012]Epoch 163/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.21it/s, loss=0.4275, mse=0.4268, lpips=0.0013]Epoch 163/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.21it/s, loss=0.4702, mse=0.4695, lpips=0.0014]Epoch 163/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.40it/s, loss=0.4702, mse=0.4695, lpips=0.0014]Epoch 163/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.40it/s, loss=0.4456, mse=0.4449, lpips=0.0014]Epoch 163/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.43it/s, loss=0.4456, mse=0.4449, lpips=0.0014]
Epoch 163/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 162/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6144]
Epoch 163/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3993]Epoch 163/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4599]Epoch 163 | Avg Train Loss: 0.4137 | Avg Val Loss: 0.4296

Epoch 164/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 164/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.4043, mse=0.4037, lpips=0.0013][A
Epoch 164/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:05,  1.61it/s, loss=0.4043, mse=0.4037, lpips=0.0013][A
Epoch 164/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:05,  1.61it/s, loss=0.4601, mse=0.4594, lpips=0.0014][A
Epoch 164/1000 [TRAIN]:  20%|██        | 2/10 [00:00<00:03,  2.10it/s, loss=0.4601, mse=0.4594, lpips=0.0014][A
Epoch 164/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.10it/s, loss=0.4178, mse=0.4171, lpips=0.0013][A
Epoch 164/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.10it/s, loss=0.4007, mse=0.4000, lpips=0.0013][A
Epoch 164/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.78it/s, loss=0.4007, mse=0.4000, lpips=0.0013][A
Epoch 164/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  3.78it/s, loss=0.4314, mse=0.4307, lpips=0.0013][A
Epoch 164/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.43it/s, loss=0.4314, mse=0.4307, lpips=0.0013][A
Epoch 164/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.43it/s, loss=0.4240, mse=0.4233, lpips=0.0013][A
Epoch 164/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.78it/s, loss=0.4240, mse=0.4233, lpips=0.0013][A
Epoch 164/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  4.78it/s, loss=0.4363, mse=0.4356, lpips=0.0014][A
Epoch 164/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.14it/s, loss=0.4363, mse=0.4356, lpips=0.0014][A
Epoch 164/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.14it/s, loss=0.4000, mse=0.3993, lpips=0.0012][A
Epoch 164/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  5.41it/s, loss=0.4000, mse=0.3993, lpips=0.0012][A
Epoch 164/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.41it/s, loss=0.3917, mse=0.3911, lpips=0.0012][A
Epoch 164/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.39it/s, loss=0.3917, mse=0.3911, lpips=0.0012][A
Epoch 164/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.39it/s, loss=0.3581, mse=0.3576, lpips=0.0011][A
Epoch 164/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.20it/s, loss=0.3581, mse=0.3576, lpips=0.0011][AEpoch 164/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.54it/s, loss=0.3581, mse=0.3576, lpips=0.0011]

Epoch 164/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 163/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4599]

Epoch 164/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.3947][A
Epoch 164/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.2924][AEpoch 164 | Avg Train Loss: 0.4124 | Avg Val Loss: 0.3436
Epoch 165/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 165/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.3790, mse=0.3784, lpips=0.0012]Epoch 165/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.68s/it, loss=0.3790, mse=0.3784, lpips=0.0012]Epoch 165/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:09,  7.68s/it, loss=0.3636, mse=0.3631, lpips=0.0011]Epoch 165/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:26,  3.26s/it, loss=0.3636, mse=0.3631, lpips=0.0011]Epoch 165/1000 [TRAIN]:  20%|██        | 2/10 [00:08<00:26,  3.26s/it, loss=0.4038, mse=0.4031, lpips=0.0012]Epoch 165/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.85s/it, loss=0.4038, mse=0.4031, lpips=0.0012]Epoch 165/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.85s/it, loss=0.3936, mse=0.3930, lpips=0.0012]Epoch 165/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.18s/it, loss=0.3936, mse=0.3930, lpips=0.0012]Epoch 165/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.18s/it, loss=0.3904, mse=0.3898, lpips=0.0012]Epoch 165/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.3904, mse=0.3898, lpips=0.0012]Epoch 165/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.22it/s, loss=0.3735, mse=0.3729, lpips=0.0012]Epoch 165/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.68it/s, loss=0.3735, mse=0.3729, lpips=0.0012]Epoch 165/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.68it/s, loss=0.3761, mse=0.3755, lpips=0.0012]Epoch 165/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.19it/s, loss=0.3761, mse=0.3755, lpips=0.0012]Epoch 165/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.19it/s, loss=0.4088, mse=0.4082, lpips=0.0013]Epoch 165/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.75it/s, loss=0.4088, mse=0.4082, lpips=0.0013]Epoch 165/1000 [TRAIN]:  80%|████████  | 8/10 [00:09<00:00,  2.75it/s, loss=0.4468, mse=0.4461, lpips=0.0014]Epoch 165/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  3.25it/s, loss=0.4468, mse=0.4461, lpips=0.0014]Epoch 165/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  3.25it/s, loss=0.4146, mse=0.4140, lpips=0.0013]Epoch 165/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  4.07it/s, loss=0.4146, mse=0.4140, lpips=0.0013]Epoch 165/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.09it/s, loss=0.4146, mse=0.4140, lpips=0.0013]
Epoch 165/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 164/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.2924]
Epoch 165/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4278]Epoch 165/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.3983]Epoch 165 | Avg Train Loss: 0.3950 | Avg Val Loss: 0.4131
Saving interval checkpoint for epoch 165...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -178.9710, Max: 168.9715
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_165.png

Epoch 166/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 166/1000 [TRAIN]:   0%|          | 0/10 [00:09<?, ?it/s, loss=0.3784, mse=0.3778, lpips=0.0012][A
Epoch 166/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:24,  9.37s/it, loss=0.3784, mse=0.3778, lpips=0.0012][A
Epoch 166/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:24,  9.37s/it, loss=0.4352, mse=0.4346, lpips=0.0013][A
Epoch 166/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:24,  9.37s/it, loss=0.3581, mse=0.3575, lpips=0.0011][A
Epoch 166/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.50s/it, loss=0.3581, mse=0.3575, lpips=0.0011][A
Epoch 166/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.50s/it, loss=0.3858, mse=0.3852, lpips=0.0012][A
Epoch 166/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:17,  2.50s/it, loss=0.4103, mse=0.4096, lpips=0.0013][A
Epoch 166/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.26s/it, loss=0.4103, mse=0.4096, lpips=0.0013][A
Epoch 166/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.26s/it, loss=0.4147, mse=0.4141, lpips=0.0013][A
Epoch 166/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:06,  1.26s/it, loss=0.3741, mse=0.3735, lpips=0.0012][A
Epoch 166/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.31it/s, loss=0.3741, mse=0.3735, lpips=0.0012][A
Epoch 166/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:02,  1.31it/s, loss=0.4368, mse=0.4361, lpips=0.0014][A
Epoch 166/1000 [TRAIN]:  70%|███████   | 7/10 [00:10<00:02,  1.31it/s, loss=0.3600, mse=0.3594, lpips=0.0011][A
Epoch 166/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  1.95it/s, loss=0.3600, mse=0.3594, lpips=0.0011][A
Epoch 166/1000 [TRAIN]:  90%|█████████ | 9/10 [00:10<00:00,  1.95it/s, loss=0.3696, mse=0.3691, lpips=0.0012][AEpoch 166/1000 [TRAIN]: 100%|██████████| 10/10 [00:10<00:00,  1.02s/it, loss=0.3696, mse=0.3691, lpips=0.0012]

Epoch 166/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 165/1000 [VAL]:   0%|          | 0/2 [00:15<?, ?it/s, loss=0.3983]

Epoch 166/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4111][A
Epoch 166/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.2763][AEpoch 166 | Avg Train Loss: 0.3923 | Avg Val Loss: 0.3437
Epoch 167/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 167/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.3714, mse=0.3708, lpips=0.0012]Epoch 167/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.16s/it, loss=0.3714, mse=0.3708, lpips=0.0012]Epoch 167/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.16s/it, loss=0.4205, mse=0.4199, lpips=0.0013]Epoch 167/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.16s/it, loss=0.4335, mse=0.4328, lpips=0.0013]Epoch 167/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.73it/s, loss=0.4335, mse=0.4328, lpips=0.0013]Epoch 167/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.73it/s, loss=0.3797, mse=0.3791, lpips=0.0012]Epoch 167/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.73it/s, loss=0.3915, mse=0.3909, lpips=0.0012]Epoch 167/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.46it/s, loss=0.3915, mse=0.3909, lpips=0.0012]Epoch 167/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.46it/s, loss=0.4371, mse=0.4364, lpips=0.0013]Epoch 167/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.46it/s, loss=0.4207, mse=0.4200, lpips=0.0013]Epoch 167/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.00it/s, loss=0.4207, mse=0.4200, lpips=0.0013]Epoch 167/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.00it/s, loss=0.4226, mse=0.4219, lpips=0.0013]Epoch 167/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.00it/s, loss=0.4040, mse=0.4034, lpips=0.0013]Epoch 167/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.26it/s, loss=0.4040, mse=0.4034, lpips=0.0013]Epoch 167/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.26it/s, loss=0.3679, mse=0.3673, lpips=0.0012]Epoch 167/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.16it/s, loss=0.3679, mse=0.3673, lpips=0.0012]
Epoch 167/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 166/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.2763]
Epoch 167/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3951]Epoch 167/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3258]Epoch 167 | Avg Train Loss: 0.4049 | Avg Val Loss: 0.3604

Epoch 168/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 168/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.4303, mse=0.4296, lpips=0.0013][A
Epoch 168/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.14s/it, loss=0.4303, mse=0.4296, lpips=0.0013][A
Epoch 168/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.14s/it, loss=0.3814, mse=0.3808, lpips=0.0012][A
Epoch 168/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.14s/it, loss=0.4320, mse=0.4314, lpips=0.0013][A
Epoch 168/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.76it/s, loss=0.4320, mse=0.4314, lpips=0.0013][A
Epoch 168/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.76it/s, loss=0.3639, mse=0.3633, lpips=0.0011][A
Epoch 168/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.76it/s, loss=0.4047, mse=0.4041, lpips=0.0013][A
Epoch 168/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.53it/s, loss=0.4047, mse=0.4041, lpips=0.0013][A
Epoch 168/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.53it/s, loss=0.4118, mse=0.4111, lpips=0.0013][A
Epoch 168/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.53it/s, loss=0.4227, mse=0.4220, lpips=0.0013][A
Epoch 168/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.17it/s, loss=0.4227, mse=0.4220, lpips=0.0013][A
Epoch 168/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.17it/s, loss=0.3887, mse=0.3881, lpips=0.0012][A
Epoch 168/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.17it/s, loss=0.4116, mse=0.4109, lpips=0.0013][A
Epoch 168/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.46it/s, loss=0.4116, mse=0.4109, lpips=0.0013][A
Epoch 168/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.46it/s, loss=0.3491, mse=0.3485, lpips=0.0011][AEpoch 168/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.28it/s, loss=0.3491, mse=0.3485, lpips=0.0011]

Epoch 168/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 167/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.3258]

Epoch 168/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3891][A
Epoch 168/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4944][AEpoch 168 | Avg Train Loss: 0.3996 | Avg Val Loss: 0.4418
Epoch 169/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 169/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.4036, mse=0.4030, lpips=0.0013]Epoch 169/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:08,  1.09it/s, loss=0.4036, mse=0.4030, lpips=0.0013]Epoch 169/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.09it/s, loss=0.4262, mse=0.4255, lpips=0.0013]Epoch 169/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.16it/s, loss=0.4262, mse=0.4255, lpips=0.0013]Epoch 169/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.16it/s, loss=0.3959, mse=0.3953, lpips=0.0012]Epoch 169/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.16it/s, loss=0.3850, mse=0.3844, lpips=0.0012]Epoch 169/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.45it/s, loss=0.3850, mse=0.3844, lpips=0.0012]Epoch 169/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.45it/s, loss=0.4027, mse=0.4021, lpips=0.0013]Epoch 169/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.97it/s, loss=0.4027, mse=0.4021, lpips=0.0013]Epoch 169/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.97it/s, loss=0.4031, mse=0.4025, lpips=0.0012]Epoch 169/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.29it/s, loss=0.4031, mse=0.4025, lpips=0.0012]Epoch 169/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.29it/s, loss=0.4155, mse=0.4149, lpips=0.0013]Epoch 169/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.45it/s, loss=0.4155, mse=0.4149, lpips=0.0013]Epoch 169/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.45it/s, loss=0.4015, mse=0.4009, lpips=0.0012]Epoch 169/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  5.58it/s, loss=0.4015, mse=0.4009, lpips=0.0012]Epoch 169/1000 [TRAIN]:  80%|████████  | 8/10 [00:02<00:00,  5.58it/s, loss=0.4271, mse=0.4264, lpips=0.0013]Epoch 169/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.67it/s, loss=0.4271, mse=0.4264, lpips=0.0013]Epoch 169/1000 [TRAIN]:  90%|█████████ | 9/10 [00:02<00:00,  5.67it/s, loss=0.4116, mse=0.4109, lpips=0.0013]Epoch 169/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  6.17it/s, loss=0.4116, mse=0.4109, lpips=0.0013]Epoch 169/1000 [TRAIN]: 100%|██████████| 10/10 [00:02<00:00,  4.59it/s, loss=0.4116, mse=0.4109, lpips=0.0013]
Epoch 169/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 168/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4944]
Epoch 169/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4114]Epoch 169/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.5602]Epoch 169 | Avg Train Loss: 0.4072 | Avg Val Loss: 0.4858

Epoch 170/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 170/1000 [TRAIN]:   0%|          | 0/10 [00:07<?, ?it/s, loss=0.4053, mse=0.4047, lpips=0.0013][A
Epoch 170/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:08,  7.57s/it, loss=0.4053, mse=0.4047, lpips=0.0013][A
Epoch 170/1000 [TRAIN]:  10%|█         | 1/10 [00:07<01:08,  7.57s/it, loss=0.4088, mse=0.4082, lpips=0.0013][A
Epoch 170/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.21s/it, loss=0.4088, mse=0.4082, lpips=0.0013][A
Epoch 170/1000 [TRAIN]:  20%|██        | 2/10 [00:07<00:25,  3.21s/it, loss=0.4082, mse=0.4075, lpips=0.0013][A
Epoch 170/1000 [TRAIN]:  30%|███       | 3/10 [00:07<00:12,  1.82s/it, loss=0.4082, mse=0.4075, lpips=0.0013][A
Epoch 170/1000 [TRAIN]:  30%|███       | 3/10 [00:08<00:12,  1.82s/it, loss=0.3700, mse=0.3694, lpips=0.0012][A
Epoch 170/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.17s/it, loss=0.3700, mse=0.3694, lpips=0.0012][A
Epoch 170/1000 [TRAIN]:  40%|████      | 4/10 [00:08<00:07,  1.17s/it, loss=0.3934, mse=0.3928, lpips=0.0012][A
Epoch 170/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.23it/s, loss=0.3934, mse=0.3928, lpips=0.0012][A
Epoch 170/1000 [TRAIN]:  50%|█████     | 5/10 [00:08<00:04,  1.23it/s, loss=0.3801, mse=0.3795, lpips=0.0012][A
Epoch 170/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.69it/s, loss=0.3801, mse=0.3795, lpips=0.0012][A
Epoch 170/1000 [TRAIN]:  60%|██████    | 6/10 [00:08<00:02,  1.69it/s, loss=0.3848, mse=0.3842, lpips=0.0012][A
Epoch 170/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.24it/s, loss=0.3848, mse=0.3842, lpips=0.0012][A
Epoch 170/1000 [TRAIN]:  70%|███████   | 7/10 [00:08<00:01,  2.24it/s, loss=0.4537, mse=0.4530, lpips=0.0014][A
Epoch 170/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.73it/s, loss=0.4537, mse=0.4530, lpips=0.0014][A
Epoch 170/1000 [TRAIN]:  80%|████████  | 8/10 [00:08<00:00,  2.73it/s, loss=0.3712, mse=0.3706, lpips=0.0012][A
Epoch 170/1000 [TRAIN]:  90%|█████████ | 9/10 [00:08<00:00,  3.40it/s, loss=0.3712, mse=0.3706, lpips=0.0012][A
Epoch 170/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  3.40it/s, loss=0.4274, mse=0.4267, lpips=0.0013][A
Epoch 170/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  4.11it/s, loss=0.4274, mse=0.4267, lpips=0.0013][AEpoch 170/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.11it/s, loss=0.4274, mse=0.4267, lpips=0.0013]

Epoch 170/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 169/1000 [VAL]:   0%|          | 0/2 [00:12<?, ?it/s, loss=0.5602]

Epoch 170/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4542][A
Epoch 170/1000 [VAL]:   0%|          | 0/2 [00:03<?, ?it/s, loss=0.4310][AEpoch 170 | Avg Train Loss: 0.4003 | Avg Val Loss: 0.4426
Saving interval checkpoint for epoch 170...
Generating debug samples...
Diffusion.sample called - n: 16, is_latent: True, img_size: 32, latent_dim: 4, condition provided: False
Diffusion.sample - Initial noisy x shape: torch.Size([16, 4, 32, 32])
  Denoising t=999: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 999.0
  Denoising t=988: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 988.0
  Denoising t=978: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 978.0
  Denoising t=968: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 968.0
  Denoising t=958: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 958.0
  Denoising t=948: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 948.0
  Denoising t=938: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 938.0
  Denoising t=928: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 928.0
  Denoising t=918: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 918.0
  Denoising t=908: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 908.0
  Denoising t=898: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 898.0
  Denoising t=888: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 888.0
  Denoising t=877: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 877.0
  Denoising t=867: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 867.0
  Denoising t=857: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 857.0
  Denoising t=847: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 847.0
  Denoising t=837: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 837.0
  Denoising t=827: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 827.0
  Denoising t=817: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 817.0
  Denoising t=807: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 807.0
  Denoising t=797: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 797.0
  Denoising t=787: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 787.0
  Denoising t=777: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 777.0
  Denoising t=766: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 766.0
  Denoising t=756: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 756.0
  Denoising t=746: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 746.0
  Denoising t=736: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 736.0
  Denoising t=726: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 726.0
  Denoising t=716: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 716.0
  Denoising t=706: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 706.0
  Denoising t=696: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 696.0
  Denoising t=686: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 686.0
  Denoising t=676: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 676.0
  Denoising t=666: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 666.0
  Denoising t=655: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 655.0
  Denoising t=645: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 645.0
  Denoising t=635: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 635.0
  Denoising t=625: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 625.0
  Denoising t=615: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 615.0
  Denoising t=605: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 605.0
  Denoising t=595: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 595.0
  Denoising t=585: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 585.0
  Denoising t=575: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 575.0
  Denoising t=565: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 565.0
  Denoising t=555: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 555.0
  Denoising t=544: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 544.0
  Denoising t=534: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 534.0
  Denoising t=524: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 524.0
  Denoising t=514: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 514.0
  Denoising t=504: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 504.0
  Denoising t=494: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 494.0
  Denoising t=484: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 484.0
  Denoising t=474: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 474.0
  Denoising t=464: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 464.0
  Denoising t=454: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 454.0
  Denoising t=444: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 444.0
  Denoising t=433: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 433.0
  Denoising t=423: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 423.0
  Denoising t=413: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 413.0
  Denoising t=403: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 403.0
  Denoising t=393: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 393.0
  Denoising t=383: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 383.0
  Denoising t=373: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 373.0
  Denoising t=363: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 363.0
  Denoising t=353: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 353.0
  Denoising t=343: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 343.0
  Denoising t=333: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 333.0
  Denoising t=322: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 322.0
  Denoising t=312: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 312.0
  Denoising t=302: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 302.0
  Denoising t=292: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 292.0
  Denoising t=282: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 282.0
  Denoising t=272: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 272.0
  Denoising t=262: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 262.0
  Denoising t=252: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 252.0
  Denoising t=242: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 242.0
  Denoising t=232: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 232.0
  Denoising t=222: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 222.0
  Denoising t=211: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 211.0
  Denoising t=201: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 201.0
  Denoising t=191: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 191.0
  Denoising t=181: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 181.0
  Denoising t=171: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 171.0
  Denoising t=161: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 161.0
  Denoising t=151: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 151.0
  Denoising t=141: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 141.0
  Denoising t=131: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 131.0
  Denoising t=121: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 121.0
  Denoising t=111: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 111.0
  Denoising t=100: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 100.0
  Denoising t=90: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 90.0
  Denoising t=80: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 80.0
  Denoising t=70: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 70.0
  Denoising t=60: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 60.0
  Denoising t=50: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 50.0
  Denoising t=40: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 40.0
  Denoising t=30: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 30.0
  Denoising t=20: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 20.0
  Denoising t=10: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 10.0
  Denoising t=0: x_in shape: torch.Size([16, 4, 32, 32]), t_batch: 0.0
Diffusion.sample - Final generated x shape: torch.Size([16, 4, 32, 32]), Min: -165.6412, Max: 147.9408
Saved debug samples to ../model_runs/sd_run_3/sample_epoch_170.png
Epoch 171/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 171/1000 [TRAIN]:   0%|          | 0/10 [00:08<?, ?it/s, loss=0.3823, mse=0.3817, lpips=0.0012]Epoch 171/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:19,  8.84s/it, loss=0.3823, mse=0.3817, lpips=0.0012]Epoch 171/1000 [TRAIN]:  10%|█         | 1/10 [00:08<01:19,  8.84s/it, loss=0.3798, mse=0.3792, lpips=0.0012]Epoch 171/1000 [TRAIN]:  10%|█         | 1/10 [00:09<01:19,  8.84s/it, loss=0.3442, mse=0.3437, lpips=0.0011]Epoch 171/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:16,  2.36s/it, loss=0.3442, mse=0.3437, lpips=0.0011]Epoch 171/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:16,  2.36s/it, loss=0.4227, mse=0.4221, lpips=0.0013]Epoch 171/1000 [TRAIN]:  30%|███       | 3/10 [00:09<00:16,  2.36s/it, loss=0.4427, mse=0.4420, lpips=0.0014]Epoch 171/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:05,  1.19s/it, loss=0.4427, mse=0.4420, lpips=0.0014]Epoch 171/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:05,  1.19s/it, loss=0.4345, mse=0.4339, lpips=0.0013]Epoch 171/1000 [TRAIN]:  50%|█████     | 5/10 [00:09<00:05,  1.19s/it, loss=0.4054, mse=0.4048, lpips=0.0013]Epoch 171/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.38it/s, loss=0.4054, mse=0.4048, lpips=0.0013]Epoch 171/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.38it/s, loss=0.3815, mse=0.3809, lpips=0.0012]Epoch 171/1000 [TRAIN]:  70%|███████   | 7/10 [00:09<00:02,  1.38it/s, loss=0.4437, mse=0.4430, lpips=0.0014]Epoch 171/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.06it/s, loss=0.4437, mse=0.4430, lpips=0.0014]Epoch 171/1000 [TRAIN]:  90%|█████████ | 9/10 [00:09<00:00,  2.06it/s, loss=0.4607, mse=0.4600, lpips=0.0014]Epoch 171/1000 [TRAIN]: 100%|██████████| 10/10 [00:09<00:00,  1.04it/s, loss=0.4607, mse=0.4600, lpips=0.0014]
Epoch 171/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 170/1000 [VAL]:   0%|          | 0/2 [00:14<?, ?it/s, loss=0.4310]
Epoch 171/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4418]Epoch 171/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.2874]Epoch 171 | Avg Train Loss: 0.4098 | Avg Val Loss: 0.3646

Epoch 172/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 172/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.3828, mse=0.3822, lpips=0.0012][A
Epoch 172/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.20s/it, loss=0.3828, mse=0.3822, lpips=0.0012][A
Epoch 172/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.20s/it, loss=0.4313, mse=0.4306, lpips=0.0013][A
Epoch 172/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.20s/it, loss=0.3813, mse=0.3807, lpips=0.0012][A
Epoch 172/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.65it/s, loss=0.3813, mse=0.3807, lpips=0.0012][A
Epoch 172/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.65it/s, loss=0.4152, mse=0.4145, lpips=0.0013][A
Epoch 172/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.65it/s, loss=0.3970, mse=0.3964, lpips=0.0012][A
Epoch 172/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.39it/s, loss=0.3970, mse=0.3964, lpips=0.0012][A
Epoch 172/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.39it/s, loss=0.4296, mse=0.4289, lpips=0.0013][A
Epoch 172/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.39it/s, loss=0.3759, mse=0.3753, lpips=0.0012][A
Epoch 172/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.91it/s, loss=0.3759, mse=0.3753, lpips=0.0012][A
Epoch 172/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.91it/s, loss=0.3312, mse=0.3307, lpips=0.0010][A
Epoch 172/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  5.91it/s, loss=0.4033, mse=0.4026, lpips=0.0013][A
Epoch 172/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.26it/s, loss=0.4033, mse=0.4026, lpips=0.0013][A
Epoch 172/1000 [TRAIN]:  90%|█████████ | 9/10 [00:01<00:00,  7.26it/s, loss=0.4350, mse=0.4344, lpips=0.0013][AEpoch 172/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.11it/s, loss=0.4350, mse=0.4344, lpips=0.0013]

Epoch 172/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 171/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.2874]

Epoch 172/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3804][A
Epoch 172/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.6570][AEpoch 172 | Avg Train Loss: 0.3983 | Avg Val Loss: 0.5187
Epoch 173/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s]Epoch 173/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s, loss=0.3566, mse=0.3560, lpips=0.0011]Epoch 173/1000 [TRAIN]:  10%|█         | 1/10 [00:00<00:08,  1.06it/s, loss=0.3566, mse=0.3560, lpips=0.0011]Epoch 173/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:08,  1.06it/s, loss=0.4195, mse=0.4188, lpips=0.0013]Epoch 173/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.05it/s, loss=0.4195, mse=0.4188, lpips=0.0013]Epoch 173/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.05it/s, loss=0.4161, mse=0.4155, lpips=0.0013]Epoch 173/1000 [TRAIN]:  20%|██        | 2/10 [00:01<00:03,  2.05it/s, loss=0.4249, mse=0.4243, lpips=0.0013]Epoch 173/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.24it/s, loss=0.4249, mse=0.4243, lpips=0.0013]Epoch 173/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.24it/s, loss=0.3906, mse=0.3900, lpips=0.0012]Epoch 173/1000 [TRAIN]:  40%|████      | 4/10 [00:01<00:01,  4.24it/s, loss=0.4055, mse=0.4049, lpips=0.0013]Epoch 173/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.94it/s, loss=0.4055, mse=0.4049, lpips=0.0013]Epoch 173/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.94it/s, loss=0.3892, mse=0.3886, lpips=0.0012]Epoch 173/1000 [TRAIN]:  60%|██████    | 6/10 [00:01<00:00,  5.94it/s, loss=0.3816, mse=0.3810, lpips=0.0012]Epoch 173/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.41it/s, loss=0.3816, mse=0.3810, lpips=0.0012]Epoch 173/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.41it/s, loss=0.3760, mse=0.3754, lpips=0.0012]Epoch 173/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  7.41it/s, loss=0.3186, mse=0.3181, lpips=0.0010]Epoch 173/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  8.77it/s, loss=0.3186, mse=0.3181, lpips=0.0010]Epoch 173/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.56it/s, loss=0.3186, mse=0.3181, lpips=0.0010]
Epoch 173/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s]Epoch 172/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.6570]
Epoch 173/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4286]Epoch 173/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.4653]Epoch 173 | Avg Train Loss: 0.3879 | Avg Val Loss: 0.4469

Epoch 174/1000 [TRAIN]:   0%|          | 0/10 [00:00<?, ?it/s][A
Epoch 174/1000 [TRAIN]:   0%|          | 0/10 [00:01<?, ?it/s, loss=0.3738, mse=0.3732, lpips=0.0012][A
Epoch 174/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.13s/it, loss=0.3738, mse=0.3732, lpips=0.0012][A
Epoch 174/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.13s/it, loss=0.4471, mse=0.4464, lpips=0.0014][A
Epoch 174/1000 [TRAIN]:  10%|█         | 1/10 [00:01<00:10,  1.13s/it, loss=0.4259, mse=0.4253, lpips=0.0013][A
Epoch 174/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.82it/s, loss=0.4259, mse=0.4253, lpips=0.0013][A
Epoch 174/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.82it/s, loss=0.3906, mse=0.3900, lpips=0.0012][A
Epoch 174/1000 [TRAIN]:  30%|███       | 3/10 [00:01<00:02,  2.82it/s, loss=0.4469, mse=0.4462, lpips=0.0014][A
Epoch 174/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.62it/s, loss=0.4469, mse=0.4462, lpips=0.0014][A
Epoch 174/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.62it/s, loss=0.3673, mse=0.3667, lpips=0.0012][A
Epoch 174/1000 [TRAIN]:  50%|█████     | 5/10 [00:01<00:01,  4.62it/s, loss=0.4002, mse=0.3995, lpips=0.0012][A
Epoch 174/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.06it/s, loss=0.4002, mse=0.3995, lpips=0.0012][A
Epoch 174/1000 [TRAIN]:  70%|███████   | 7/10 [00:01<00:00,  6.06it/s, loss=0.3673, mse=0.3667, lpips=0.0012][A
Epoch 174/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.26it/s, loss=0.3673, mse=0.3667, lpips=0.0012][A
Epoch 174/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.26it/s, loss=0.3563, mse=0.3558, lpips=0.0011][A
Epoch 174/1000 [TRAIN]:  80%|████████  | 8/10 [00:01<00:00,  6.26it/s, loss=0.5185, mse=0.5177, lpips=0.0016][A
Epoch 174/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  7.90it/s, loss=0.5185, mse=0.5177, lpips=0.0016][AEpoch 174/1000 [TRAIN]: 100%|██████████| 10/10 [00:01<00:00,  5.12it/s, loss=0.5185, mse=0.5177, lpips=0.0016]

Epoch 174/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s][AEpoch 173/1000 [VAL]:   0%|          | 0/2 [00:02<?, ?it/s, loss=0.4653]

Epoch 174/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3932][A
Epoch 174/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3770][AEpoch 174/1000 [VAL]:   0%|          | 0/2 [00:00<?, ?it/s, loss=0.3770]
Epoch 174 | Avg Train Loss: 0.4094 | Avg Val Loss: 0.3851
Early stopping triggered.
